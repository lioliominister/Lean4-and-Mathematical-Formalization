[
  {
    "label": "Definition 7.1",
    "env": "def",
    "number_components": [
      7,
      1
    ],
    "extracted_labels": [
      "def:7.1",
      "eq:7.u1"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.1}\nLet $n\\in\\mathbb{Z}_{\\ge 1}$, $N:=\\{1,\\ldots,n\\}$, and let $a_j>0$ for $j\\in N$ and $b>0$. The \\emph{$0$--$1$ knapsack set} is\n\\[\n\\label{eq:7.u1}\nK:=\\left\\{x\\in\\{0,1\\}^n:\\sum_{j=1}^n a_j x_j\\le b\\right\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 1
  },
  {
    "label": "Definition 7.2.1",
    "env": "def",
    "number_components": [
      7,
      2,
      1
    ],
    "extracted_labels": [
      "def:7.2.1"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.2.1}\nA subset $C\\subseteq N$ is a \\emph{cover} for $K$ if $\\sum_{j\\in C} a_j>b$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 2
  },
  {
    "label": "Definition 7.2.2",
    "env": "def",
    "number_components": [
      7,
      2,
      2
    ],
    "extracted_labels": [
      "def:7.2.2"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "",
      "chapter_number": 7,
      "section_number": "1",
      "subsection_number": "0"
    },
    "content": "\\begin{definition}\n\\label{def:7.2.2}\nA cover $C$ is \\emph{minimal} if $\\sum_{j\\in C\\setminus\\{k\\}} a_j\\le b$ for all $k\\in C$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 3
  },
  {
    "label": "Definition 7.2.3",
    "env": "def",
    "number_components": [
      7,
      2,
      3
    ],
    "extracted_labels": [
      "def:7.2.3"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "",
      "chapter_number": 7,
      "section_number": "1",
      "subsection_number": "0"
    },
    "content": "\\begin{definition}\n\\label{def:7.2.3}\nFor any cover $C$, the associated \\emph{cover inequality} is\n\\[\n\\label{eq:7.u2}\n\\sum_{j\\in C} x_j\\le |C|-1.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 4
  },
  {
    "label": "Proposition 7.0.1",
    "env": "prop",
    "number_components": [
      7,
      0,
      1
    ],
    "extracted_labels": [],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "",
      "chapter_number": 7,
      "section_number": "1",
      "subsection_number": "0"
    },
    "content": "\\begin{proposition}\n\\label{prop:7.0.1}\nFor any cover $C$, the associated \\emph{cover inequality} is valid for $\\operatorname{conv}(K)$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "",
    "index": 5
  },
  {
    "label": "Proposition 7.1",
    "env": "prop",
    "number_components": [
      7,
      1
    ],
    "extracted_labels": [
      "prop:7.1",
      "eq:7.u3",
      "eq:7.u4",
      "prf:prop:7.1",
      "eq:7.u5",
      "eq:7.u6",
      "eq:7.u7",
      "eq:7.u8",
      "eq:7.u9",
      "eq:7.u10",
      "eq:7.u11"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.1}\nLet $K\\subseteq\\{0,1\\}^n$ and let $C\\subseteq N:=\\{1,\\dots,n\\}$ be a cover for $K$, meaning that every $x\\in K$ violates the inequality $\\sum_{j\\in C} x_j\\le |C|-1$ (equivalently, $\\sum_{j\\in C} x_j\\ge |C|$ for all $x\\in K$). Define\n\\[\n\\label{eq:7.u3}\nP_C:=\\operatorname{conv}(K)\\cap\\bigl\\{x\\in\\mathbb{R}^n: x_j=0\\ \\text{for all } j\\in N\\setminus C\\bigr\\}.\n\\]\nThen the inequality\n\\[\n\\label{eq:7.u4}\n\\sum_{j\\in C} x_j\\le |C|-1\n\\]\ndefines a facet of the polytope $P_C$ if and only if $C$ is a minimal cover for $K$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.1}\nFirst note that $P_C$ is contained in the affine subspace $\\{x\\in\\mathbb{R}^n: x_j=0\\text{ for all }j\\in N\\setminus C\\}$, hence $\\dim(P_C)\\le |C|$. Moreover, $P_C$ is the convex hull of the $0$--$1$ points in $K$ projected onto the coordinates in $C$ and embedded by setting all other coordinates to $0$.\n\n($\\Rightarrow$) Assume that $\\sum_{j\\in C} x_j\\le |C|-1$ is facet-defining for $P_C$. Suppose for contradiction that $C$ is not minimal. Then there exists $i\\in C$ such that $C':=C\\setminus\\{i\\}$ is also a cover for $K$. For every $x\\in K$ one has $\\sum_{j\\in C'} x_j\\ge |C'|=|C|-1$, and since $x_i\\in\\{0,1\\}$ this implies\n\\[\n\\label{eq:7.u5}\n\\sum_{j\\in C} x_j = x_i+\\sum_{j\\in C'} x_j \\ge 1+(|C|-1)=|C|.\n\\]\nThus every $x\\in K$ satisfies $x_i=1$ and $\\sum_{j\\in C'} x_j=|C|-1$, so in particular the equalities\n\\[\n\\label{eq:7.u6}\nx_i=1,\\qquad \\sum_{j\\in C} x_j=|C|\n\\]\nhold for all $x\\in K$. By convexity, these equalities also hold for all $x\\in \\operatorname{conv}(K)$, and hence for all $x\\in P_C$. Therefore $P_C\\subseteq\\{x\\in\\mathbb{R}^n: x_i=1\\}$, which implies $\\dim(P_C)\\le |C|-1$. On the other hand, on $P_C$ the inequality $\\sum_{j\\in C} x_j\\le |C|-1$ is never tight because $\\sum_{j\\in C} x_j\\equiv |C|$ on $P_C$, so it cannot define a facet of $P_C$, a contradiction. Hence $C$ must be minimal.\n\n($\\Leftarrow$) Assume that $C$ is a minimal cover for $K$. For each $i\\in C$, the set $C\\setminus\\{i\\}$ is not a cover, so there exists $x^{(i)}\\in K$ such that\n\\[\n\\label{eq:7.u7}\n\\sum_{j\\in C\\setminus\\{i\\}} x^{(i)}_j\\le |C|-2.\n\\]\nSince $x^{(i)}\\in\\{0,1\\}^n$, this implies $\\sum_{j\\in C} x^{(i)}_j\\le |C|-1$. Because $C$ is a cover, every point of $K$ satisfies $\\sum_{j\\in C} x_j\\ge |C|$, so necessarily\n\\[\n\\label{eq:7.u8}\n\\sum_{j\\in C} x^{(i)}_j=|C|-1.\n\\]\nDefine $y^{(i)}\\in P_C$ by setting $y^{(i)}_C:=x^{(i)}_C$ and $y^{(i)}_j:=0$ for $j\\in N\\setminus C$. Then each $y^{(i)}\\in P_C$ satisfies the equality\n\\[\n\\label{eq:7.u9}\n\\sum_{j\\in C} y^{(i)}_j = |C|-1.\n\\]\nAlso, for each $i\\in C$, the inequality above together with $\\sum_{j\\in C\\setminus\\{i\\}} y^{(i)}_j\\le |C|-2$ forces $y^{(i)}_i=1$.\n\nConsider the face\n\\[\n\\label{eq:7.u10}\nF:=\\bigl\\{x\\in P_C: \\sum_{j\\in C} x_j=|C|-1\\bigr\\}.\n\\]\nThe points $\\{y^{(i)}: i\\in C\\}$ lie in $F$. For distinct $i,k\\in C$, the difference $y^{(i)}-y^{(k)}$ has support contained in $C$ and satisfies\n\\[\n\\label{eq:7.u11}\n\\sum_{j\\in C} (y^{(i)}_j-y^{(k)}_j)=0,\n\\]\nso these differences lie in the linear subspace $\\{d\\in\\mathbb{R}^n: d_j=0\\text{ for }j\\notin C,\\ \\sum_{j\\in C} d_j=0\\}$, which has dimension $|C|-1$. Moreover, since $y^{(i)}_i=1$ and $y^{(k)}_i\\in\\{0,1\\}$, at least one coordinate distinguishes $y^{(i)}$ from $y^{(k)}$, and the set $\\{y^{(i)}: i\\in C\\}$ affinely spans a subset of $F$ of dimension $|C|-1$ inside the ambient subspace determined by $x_j=0$ for $j\\notin C$. Hence $\\dim(F)=\\dim(P_C)-1$, so the inequality $\\sum_{j\\in C} x_j\\le |C|-1$ defines a facet of $P_C$.\n\\end{proof}",
    "index": 5
  },
  {
    "label": "Definition 7.3",
    "env": "def",
    "number_components": [
      7,
      3
    ],
    "extracted_labels": [
      "def:7.3",
      "eq:7.u12"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.3}\n[Facet-defining lifting problem for a minimal cover]\nLet \\(K\\subseteq \\mathbb{R}^n\\) be a set, let \\(N:=\\{1,\\dots,n\\}\\), and let \\(C\\subseteq N\\) be a minimal cover. The facet-defining lifting problem is to determine coefficients \\(\\alpha_j\\) for \\(j\\in N\\setminus C\\) such that the inequality\n\\[\n\\label{eq:7.u12}\n\\sum_{j\\in C} x_j + \\sum_{j\\in N\\setminus C} \\alpha_j x_j \\le |C|-1\n\\]\nis facet-defining for \\(\\operatorname{conv}(K)\\) (cf. Proposition~\\ref{prop:7.1}).\n\\end{definition}",
    "dependencies": [
      "Proposition 7.1"
    ],
    "proof": "",
    "index": 6
  },
  {
    "label": "Definition 7.4",
    "env": "def",
    "number_components": [
      7,
      4
    ],
    "extracted_labels": [
      "def:7.4",
      "eq:7.u13"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "Separation",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.4}\n[Separation problem for cover inequalities] Let $K:=\\{x\\in\\{0,1\\}^n: \\sum_{j=1}^n a_j x_j\\le b\\}$, and let $\\bar x\\in[0,1]^n$. The separation problem for cover inequalities for $K$ is\n\\[\n\\label{eq:7.u13}\n\\zeta \\,=\\, \\min\\left\\{\\sum_{j\\in C}(1-\\bar x_j):\\; C\\subseteq\\{1,\\dots,n\\}\\text{ is a cover for }K\\right\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 7
  },
  {
    "label": "Proposition 7.2",
    "env": "prop",
    "number_components": [
      7,
      2
    ],
    "extracted_labels": [
      "prop:7.2",
      "eq:7.u14",
      "eq:7.u15",
      "eq:7.u16",
      "prf:prop:7.2",
      "eq:7.u17"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "Separation",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.2}\n[Characterization via the separation value]\nLet $a\\in\\mathbb{R}_+^n$ and $b\\in\\mathbb{R}$. Define\n\\[\n\\label{eq:7.u14}\nK:=\\Bigl\\{x\\in\\{0,1\\}^n:\\; \\sum_{j=1}^n a_j x_j\\le b\\Bigr\\}\n\\]\nand let $\\bar x\\in[0,1]^n$. A subset $C\\subseteq\\{1,\\dots,n\\}$ is called a \\emph{cover for $K$} if $\\sum_{j\\in C} a_j>b$; its associated \\emph{cover inequality} is\n\\[\n\\label{eq:7.u15}\n\\sum_{j\\in C} x_j\\le |C|-1.\n\\]\nDefine the separation value\n\\[\n\\label{eq:7.u16}\n\\zeta \\,=\\, \\min\\left\\{\\sum_{j\\in C}(1-\\bar x_j):\\; C\\subseteq\\{1,\\dots,n\\}\\text{ is a cover for }K\\right\\},\n\\]\nwith the convention that $\\zeta=+\\infty$ if no cover exists.\nThen $\\bar x$ satisfies all cover inequalities for $K$ if and only if $\\zeta\\ge 1$. Moreover, if $\\zeta<1$ and $C^*$ is an optimal cover attaining $\\zeta$, then the cover inequality associated with $C^*$ is violated by $\\bar x$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.2}\nFix a cover $C\\subseteq\\{1,\\dots,n\\}$. The cover inequality for $C$ is\n\\(\\sum_{j\\in C} x_j\\le |C|-1\\). Evaluated at $\\bar x$, this inequality is satisfied if and only if\n\\[\n\\label{eq:7.u17}\n\\sum_{j\\in C} \\bar x_j\\le |C|-1\n\\quad\\Longleftrightarrow\\quad\n|C|-\\sum_{j\\in C} \\bar x_j\\ge 1\n\\quad\\Longleftrightarrow\\quad\n\\sum_{j\\in C}(1-\\bar x_j)\\ge 1.\n\\]\nTherefore $\\bar x$ satisfies all cover inequalities for $K$ if and only if $\\sum_{j\\in C}(1-\\bar x_j)\\ge 1$ for every cover $C$, which holds if and only if the minimum over all covers satisfies $\\zeta\\ge 1$ (including the case of no covers, where $\\zeta=+\\infty$).\n\nIf $\\zeta<1$ and $C^*$ attains the minimum, then\n\\(\\sum_{j\\in C^*}(1-\\bar x_j)=\\zeta<1\\), hence by the equivalence above,\n\\(\\sum_{j\\in C^*} \\bar x_j>|C^*|-1\\), so the cover inequality associated with $C^*$ is violated by $\\bar x$.\n\\end{proof}",
    "index": 8
  },
  {
    "label": "Definition 7.5",
    "env": "def",
    "number_components": [
      7,
      5
    ],
    "extracted_labels": [
      "def:7.5",
      "eq:7.u18"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "Separation",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.5}\n[0--1 integer programming formulation of cover separation] Assume $a_1,\\dots,a_n$ and $b$ are integers, and let $\\bar x\\in[0,1]^n$. The separation problem for cover inequalities can be formulated as the integer program\n\\begin{align*}\n\\label{eq:7.u18}\n\\zeta = \\min &\\sum_{j=1}^n (1-\\bar x_j) z_j\\\\\\text{s.t. } &\\sum_{j=1}^n a_j z_j \\ge b+1,\\\\& z\\in\\{0,1\\}^n.\n\\end{align*}\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 9
  },
  {
    "label": "Algorithm 7.1",
    "env": "alg",
    "number_components": [
      7,
      1
    ],
    "extracted_labels": [
      "alg:7.1",
      "eq:7.u19"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Cover Inequalities for the 0,1 Knapsack Problem",
      "subsection": "Separation",
      "chapter_number": 7,
      "section_number": 1,
      "subsection_number": 0
    },
    "content": "\\begin{algorithm}\n\\label{alg:7.1}\n[Heuristic for detecting a violated cover inequality] \\textbf{Input:} Integers $a_1,\\dots,a_n$, $b$, and a point $\\bar x\\in[0,1]^n$. \\\\\n\\textbf{Step 1.} Solve the linear programming relaxation of\n\\begin{align*}\n\\label{eq:7.u19}\n\\min\\; &\\sum_{j=1}^n (1-\\bar x_j) z_j\\\\\n\\text{s.t. }\\; &\\sum_{j=1}^n a_j z_j \\ge b+1,\\\\\n& 0\\le z\\le 1,\n\\end{align*}\nand obtain a basic optimal solution $z^*$.\\\\\n\\textbf{Step 2.} If the optimal objective value is $\\ge 1$, return \\emph{No violated cover inequality detected}.\\\\\n\\textbf{Step 3.} Otherwise, output the set $C:=\\{j\\in\\{1,\\dots,n\\}: z_j^*>0\\}$.\n\\end{algorithm}",
    "dependencies": [],
    "proof": "",
    "index": 10
  },
  {
    "label": "Definition 7.6",
    "env": "def",
    "number_components": [
      7,
      6
    ],
    "extracted_labels": [
      "def:7.6",
      "eq:7.u20"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.6}\n[Lifting inequality]\nLet $S := \\{x \\in \\mathbb{Z}_+^n \\times \\mathbb{R}_+^p : Ax \\leq b\\}$, and let $N := \\{1,\\ldots,n+p\\}$. Let $C \\subseteq N$, and let $\\sum_{j \\in C} \\alpha_j x_j \\leq \\beta$ be a valid inequality for\n\\[\n\\label{eq:7.u20}\n\\operatorname{conv}(S) \\cap \\{x \\in \\mathbb{R}^{n+p} : x_j = 0,\\ j \\in N \\setminus C\\}.\n\\]\nAn inequality $\\sum_{j=1}^{n+p} \\alpha_j x_j \\leq \\beta$ is called a \\emph{lifting} of $\\sum_{j \\in C} \\alpha_j x_j \\leq \\beta$ if it is valid for $\\operatorname{conv}(S)$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 11
  },
  {
    "label": "Proposition 7.3",
    "env": "prop",
    "number_components": [
      7,
      3
    ],
    "extracted_labels": [
      "prop:7.3",
      "eq:7.u21",
      "eq:7.u22",
      "eq:7.u23",
      "eq:7.u24",
      "prf:prop:7.3",
      "eq:7.u25",
      "eq:7.u26",
      "eq:7.u27",
      "eq:7.u28",
      "eq:7.u29"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.3}\nLet $n\\in\\mathbb{Z}_{>0}$ and let $S\\subseteq\\{0,1\\}^n$ satisfy $S\\cap\\{x\\in\\{0,1\\}^n\\mid x_n=1\\}\\neq\\emptyset$. Let $\\alpha_1,\\dots,\\alpha_{n-1},\\beta\\in\\mathbb{R}$ be such that\n\\[\n\\label{eq:7.u21}\n\\forall x\\in S: x_n=0\\implies \\sum_{i=1}^{n-1}\\alpha_i x_i\\le \\beta.\n\\]\nDefine\n\\[\n\\label{eq:7.u22}\nM:=\\max\\Bigl\\{\\sum_{i=1}^{n-1}\\alpha_i x_i\\ \\Bigm|\\ x\\in S,\\ x_n=1\\Bigr\\}\n\\]\nand set $\\alpha_n:=\\beta-M$. Then\n\\[\n\\label{eq:7.u23}\n\\forall x\\in S\\implies \\sum_{i=1}^{n-1}\\alpha_i x_i+\\alpha_n x_n\\le \\beta.\n\\]\nMoreover, for every $\\gamma\\in\\mathbb{R}$, if\n\\[\n\\label{eq:7.u24}\n\\forall x\\in S, \\sum_{i=1}^{n-1}\\alpha_i x_i+\\gamma x_n\\le \\beta,\n\\]\nthen $\\gamma\\le \\alpha_n$ (cf. Proposition~\\ref{prop:7.2}).\n\\end{proposition}",
    "dependencies": [
      "Proposition 7.2"
    ],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.3}\nThe set $\\{\\sum_{i=1}^{n-1}\\alpha_i x_i\\mid x\\in S,\\ x_n=1\\}$ is finite and nonempty because $S\\subseteq\\{0,1\\}^n$ is finite and $S\\cap\\{x\\mid x_n=1\\}\\neq\\emptyset$, hence $M$ is well-defined.\n\nFix $x\\in S$. If $x_n=0$, then\n\\[\n\\label{eq:7.u25}\n\\sum_{i=1}^{n-1}\\alpha_i x_i+\\alpha_n x_n=\\sum_{i=1}^{n-1}\\alpha_i x_i\\le \\beta\n\\]\nby the assumed inequality valid on $\\{x\\in S\\mid x_n=0\\}$. If $x_n=1$, then by definition of $M$,\n\\[\n\\label{eq:7.u26}\n\\sum_{i=1}^{n-1}\\alpha_i x_i\\le M,\n\\]\nso using $\\alpha_n=\\beta-M$,\n\\[\n\\label{eq:7.u27}\n\\sum_{i=1}^{n-1}\\alpha_i x_i+\\alpha_n x_n=\\sum_{i=1}^{n-1}\\alpha_i x_i+(\\beta-M)\\le M+(\\beta-M)=\\beta.\n\\]\nTherefore $\\sum_{i=1}^{n-1}\\alpha_i x_i+\\alpha_n x_n\\le\\beta$ holds for all $x\\in S$.\n\nFor the maximality statement (as in Proposition~\\ref{prop:7.2}), let $\\gamma\\in\\mathbb{R}$ satisfy $\\sum_{i=1}^{n-1}\\alpha_i x_i+\\gamma x_n\\le\\beta$ for all $x\\in S$. For any $x\\in S$ with $x_n=1$ this gives\n\\[\n\\label{eq:7.u28}\n\\gamma\\le \\beta-\\sum_{i=1}^{n-1}\\alpha_i x_i.\n\\]\nTaking the minimum over all such $x$ (equivalently, using finiteness),\n\\[\n\\label{eq:7.u29}\n\\gamma\\le \\min_{\\substack{x\\in S\\\\ x_n=1}}\\Bigl(\\beta-\\sum_{i=1}^{n-1}\\alpha_i x_i\\Bigr)=\\beta-\\max_{\\substack{x\\in S\\\\ x_n=1}}\\sum_{i=1}^{n-1}\\alpha_i x_i=\\beta-M=\\alpha_n.\n\\]\nHence every valid coefficient $\\gamma$ satisfies $\\gamma\\le \\alpha_n$.\n\\end{proof}",
    "index": 12
  },
  {
    "label": "Algorithm 7.2",
    "env": "alg",
    "number_components": [
      7,
      2
    ],
    "extracted_labels": [
      "alg:7.2",
      "eq:7.u30"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 0
    },
    "content": "\\begin{algorithm}\n\\label{alg:7.2}\n[Sequential lifting (cf. Proposition~\\ref{prop:7.2})]\n\n\\textbf{Input:} A set $S:=\\{x\\in\\{0,1\\}^n:Ax\\le b\\}$ with $A\\ge 0$ and $\\dim(S)=n$; an index set $C\\subseteq N:=\\{1,\\dots,n\\}$; a facet-defining inequality $\\sum_{j\\in C}\\alpha_j x_j\\le \\beta$ for $\\operatorname{conv}(S)\\cap\\{x:x_j=0,\\ j\\in N\\setminus C\\}$; an ordering $(j_1,\\dots,j_\\ell)$ of $N\\setminus C$.\n\n\\textbf{Initialize:} Set $C_0:=C$ and $C_h:=C_{h-1}\\cup\\{j_h\\}$ for $h=1,\\dots,\\ell$.\n\n\\textbf{For} $h=1,\\dots,\\ell$ \\textbf{do} compute\n\\[\n\\label{eq:7.u30}\n\\alpha_{j_h}:=\\beta-\\max\\left\\{\\sum_{j\\in C_{h-1}}\\alpha_j x_j:\\ x\\in S,\\ x_j=0\\ \\forall j\\in N\\setminus C_h,\\ x_{j_h}=1\\right\\}.\n\\]\n\\textbf{End for}\n\n\\textbf{Output:} The lifted inequality $\\sum_{j=1}^n \\alpha_j x_j\\le \\beta$.\n\\end{algorithm}",
    "dependencies": [
      "Proposition 7.2",
      "Proposition 7.1"
    ],
    "proof": "",
    "index": 13
  },
  {
    "label": "Theorem 7.1",
    "env": "thm",
    "number_components": [
      7,
      1
    ],
    "extracted_labels": [
      "thm:7.1",
      "eq:7.u31",
      "prf:thm:7.1",
      "eq:7.u32",
      "eq:7.u33",
      "eq:7.u34",
      "eq:7.u35",
      "eq:7.u36"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 1
    },
    "content": "\\begin{theorem}\n\\label{thm:7.1}\nLet \\( K := \\{x \\in \\{0,1\\}^n : \\sum_{j=1}^n a_j x_j \\leq b\\} \\), where \\( b \\geq a_j > 0 \\) for all \\( j \\in N \\). Let \\( C \\) be a minimal cover for \\( K \\), and let\n\\[\n\\label{eq:7.u31}\n\\sum_{j \\in C} x_j + \\sum_{j \\in N \\setminus C} \\alpha_j x_j \\leq |C| - 1\n\\]\nbe a lifting of the cover inequality associated with \\( C \\). Up to permuting the indices, assume that \\( C = \\{1, \\ldots, t\\} \\) and \\( a_1 \\geq a_2 \\geq \\ldots \\geq a_t \\). Let \\( \\mu_0 := 0 \\) and \\( \\mu_h := \\sum_{\\ell=1}^h a_\\ell \\) for \\( h = 1, \\ldots, t \\). Let \\( \\lambda := \\mu_t - b \\) (so \\( \\lambda > 0 \\)).\n\nIf the above lifted cover inequality defines a facet of \\( \\operatorname{conv}(K) \\), then the following hold for every \\( j \\in N \\setminus C \\).\n\n(i) If, for some \\( h \\), \\( \\mu_h \\leq a_j \\leq \\mu_{h+1} - \\lambda \\), then \\( \\alpha_j = h \\).\n\n(ii) If, for some \\( h \\), \\( \\mu_{h+1} - \\lambda < a_j < \\mu_{h+1} \\), then \\( h \\leq \\alpha_j \\leq h + 1 \\).\n\nFurthermore, for every \\( j \\in N \\setminus C \\), if \\( \\mu_{h+1} - \\lambda < a_j < \\mu_{h+1} \\), then there exists a facet-defining inequality of the above form such that \\( \\alpha_j = h + 1 \\).\n\\end{theorem}",
    "dependencies": [
      "Proposition 7.2"
    ],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.1}\nAssume that (7.5) is facet-defining for \\(\\operatorname{conv}(K)\\) and let \\(j \\in N \\setminus C\\). Since \\(0 < a_j \\leq b < \\mu_t\\), there exists an index \\(h\\), \\(0 \\leq h \\leq t - 1\\), such that \\(\\mu_h \\leq a_j < \\mu_{h+1}\\).\n\nBy Proposition~\\ref{prop:7.2}, \\(\\alpha_j \\leq |C| - 1 - \\theta\\), where\n\n\\[\n\\label{eq:7.u32}\n\\theta := \\max \\left\\{ \\sum_{i=1}^t x_i : \\sum_{i=1}^t a_i x_i \\leq b - a_j, x \\in \\{0,1\\}^t \\right\\}.\n\\]\n\nObserve that, since \\(a_1 \\geq a_2 \\geq \\ldots \\geq a_t\\), \\(\\theta = |C| - k + 1\\), where \\(k\\) is the smallest index such that \\(\\sum_{\\ell=k}^t a_\\ell \\leq b - a_j\\). Therefore \\(\\alpha_j \\leq k - 2\\).\n\nSince \\(\\sum_{\\ell=k}^t a_\\ell = \\mu_t - \\mu_{k-1} = b + \\lambda - \\mu_{k-1}\\), it follows that \\(k\\) is the smallest index such that \\(a_j \\leq \\mu_{k-1} - \\lambda\\). Therefore \\(k\\) is the index such that \\(\\mu_{k-2} - \\lambda < a_j \\leq \\mu_{k-1} - \\lambda\\).\n\nIt follows that\n\n\\[\n\\label{eq:7.u33}\n\\alpha_j \\leq k - 2 = \\begin{cases} h & \\text{when } \\mu_h \\leq a_j \\leq \\mu_{h+1} - \\lambda \\\\ h + 1 & \\text{when } \\mu_{h+1} - \\lambda < a_j < \\mu_{h+1} \\end{cases}\n\\]\n\nNext we show that \\(\\alpha_j \\geq h\\). We apply Proposition~\\ref{prop:7.2}to the inequality\n\n\\[\n\\label{eq:7.u34}\n\\sum_{i \\in C} x_i + \\sum_{i \\in N \\setminus (C \\cup \\{j\\})} \\alpha_i x_i \\leq |C| - 1.\n\\]\n\nSince (7.5) is facet-defining, it follows that\n\n\\[\n\\label{eq:7.u35}\n\\alpha_j = |C| - 1 - \\max \\left\\{ \\sum_{i \\in C} x_i + \\sum_{i \\in N \\setminus (C \\cup \\{j\\})} \\alpha_i x_i : \\sum_{i \\in N \\setminus \\{j\\}} a_i x_i \\leq b - a_j, x \\in \\{0,1\\}^{N \\setminus \\{j\\}} \\right\\}.\n\\]\n\nObserve that, since \\(a_1 \\geq a_2 \\geq \\ldots \\geq a_t\\), (7.8) admits an optimal solution \\(x^* \\in \\{0, 1\\}^{N \\setminus \\{j\\}}\\) such that \\(x_1^* \\leq x_2^* \\leq \\ldots \\leq x_t^*\\). Since \\(\\sum_{\\ell = h+1}^t a_\\ell = \\mu_\\ell - \\mu_h \\geq b + \\lambda - a_j > b - a_j\\), we have that \\(x_\\ell^* = 0\\) for some \\(\\ell \\in \\{h+1, \\ldots, t\\}\\). It follows that \\(x_1^* = \\ldots = x_h^* = 0\\). Let \\(\\bar{x}\\) be the vector in \\(\\{0, 1\\}^n\\) defined by \\(\\bar{x}_j = 0\\), \\(\\bar{x}_i = 1\\) for \\(i = 1, \\ldots, h\\), and \\(\\bar{x}_i = x_i^*\\) otherwise. We have that \\(\\bar{x} \\in K\\) because \\(\\sum_{i \\in N} a_i \\bar{x}_i = \\sum_{i \\in N \\setminus \\{j\\}} a_i x_i^* + \\mu_h \\leq b - a_j + \\mu_h \\leq b\\). Since (7.5) is valid for \\(K\\), it follows that \\(\\sum_{i \\in C} \\bar{x}_i + \\sum_{i \\in N \\setminus C} \\alpha_i \\bar{x}_i \\leq |C| - 1\\). Therefore\n\n\\[\n\\label{eq:7.u36}\n\\alpha_j = |C| - 1 - \\left( \\sum_{i \\in C} x_i^* + \\sum_{i \\in N \\setminus (C \\cup \\{j\\})} \\alpha_i x_i^* \\right) \\geq \\sum_{i \\in C} (\\bar{x}_i - x_i^*) + \\sum_{i \\in N \\setminus (C \\cup \\{j\\})} \\alpha_i (\\bar{x}_i - x_i^*) = h.\n\\]\n\nThis proves (i) and (ii). We prove the last statement of the theorem. Assume \\(a_j > \\mu_{h+1} - \\lambda\\). If we do sequential lifting in which we lift \\(x_j\\) first, it follows from the proof of (7.6) that the coefficient of \\(x_j\\) in the resulting inequality is \\(h + 1\\). By Proposition~\\ref{prop:7.2}this inequality is facet-defining for \\(\\operatorname{conv}(K)\\).\n\\end{proof}",
    "index": 14
  },
  {
    "label": "Definition 7.7",
    "env": "def",
    "number_components": [
      7,
      7
    ],
    "extracted_labels": [
      "def:7.7",
      "eq:7.u37",
      "eq:7.u38",
      "eq:7.u39"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 1
    },
    "content": "\\begin{definition}\n\\label{def:7.7}\n[Lifted minimal cover inequality]\nLet \n\\[\n\\label{eq:7.u37}\nK:=\\{x\\in\\{0,1\\}^n: \\sum_{j\\in N} a_j x_j \\le b\\}\n\\]\nbe a knapsack set, and let \\(C\\subseteq N\\) be a minimal cover, i.e., \\(\\sum_{j\\in C} a_j > b\\) and \\(\\sum_{j\\in C\\setminus\\{i\\}} a_j \\le b\\) for all \\(i\\in C\\). Let \\(\\{\\mu_k\\}_{k\\ge 0}\\) be a nondecreasing sequence and let \\(\\lambda>0\\). For each \\(j\\in N\\setminus C\\), define \\(h(j)\\) as the index satisfying\n\\[\n\\label{eq:7.u38}\n\\mu_{h(j)} \\le a_j < \\mu_{h(j)+1}.\n\\]\nThe inequality\n\\[\n\\label{eq:7.u39}\n\\sum_{j\\in C} x_j + \\sum_{j\\in N\\setminus C} h(j) x_j \\le |C|-1\n\\]\nis called a lifting of the minimal cover inequality associated with \\(C\\).\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 15
  },
  {
    "label": "Proposition 7.4",
    "env": "prop",
    "number_components": [
      7,
      4
    ],
    "extracted_labels": [
      "prop:7.4",
      "eq:7.u40",
      "eq:7.u41",
      "eq:7.u42",
      "eq:7.u43",
      "eq:7.u44",
      "prf:prop:7.4",
      "eq:7.u45",
      "eq:7.u46",
      "eq:7.u47",
      "eq:7.u48",
      "eq:7.u49",
      "eq:7.u50",
      "eq:7.u51",
      "eq:7.u52"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 1
    },
    "content": "\\begin{proposition}\n\\label{prop:7.4}\n[Uniqueness of a facet-defining lifting]\nLet \n\\[\n\\label{eq:7.u40}\nK:=\\{x\\in\\{0,1\\}^N: \\sum_{j\\in N} a_j x_j \\le b\\}\n\\]\nbe a knapsack set with weights $a_j\\in\\mathbb{R}_{>0}$ and capacity $b\\in\\mathbb{R}_{>0}$. Let $C\\subseteq N$ be a minimal cover, i.e., $\\sum_{j\\in C} a_j>b$ and $\\sum_{j\\in C\\setminus\\{i\\}} a_j\\le b$ for all $i\\in C$.\n\nLet $\\lambda:=\\sum_{i\\in C} a_i-b>0$. For each integer $t\\ge 0$ define\n\\[\n\\label{eq:7.u41}\n\\mu_t:=\\sum_{i\\in C} a_i-\\sum_{s=1}^t a_{(s)},\n\\]\nwhere $a_{(1)}\\ge a_{(2)}\\ge\\cdots\\ge a_{(|C|)}$ are the elements of $\\{a_i:i\\in C\\}$ sorted in nonincreasing order, and set $\\mu_0:=\\sum_{i\\in C} a_i$.\nFor each $j\\in N\\setminus C$, define $h(j)$ as the unique integer such that\n\\[\n\\label{eq:7.u42}\n\\mu_{h(j)}\\le a_j<\\mu_{h(j)+1}.\n\\]\nAssume in addition that\n\\[\n\\label{eq:7.u43}\na_j \\le \\mu_{h(j)+1}-\\lambda \\quad \\text{for all } j\\in N\\setminus C.\n\\]\nThen the lifted cover inequality\n\\[\n\\label{eq:7.u44}\n\\sum_{j \\in C} x_j + \\sum_{j \\in N \\setminus C} h(j) x_j \\le |C| - 1\n\\]\ndefines a facet of $\\operatorname{conv}(K)$ and is the unique facet-defining lifting of the minimal cover inequality $\\sum_{j\\in C} x_j\\le |C|-1$ associated with $C$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.4}\nDenote the minimal cover inequality by\n\\[\n\\label{eq:7.u45}\n\\sum_{i\\in C} x_i\\le |C|-1.\n\\]\nA (sequential) lifting of this inequality to all variables has the form\n\\[\n\\label{eq:7.u46}\n\\sum_{i\\in C} x_i+\\sum_{j\\in N\\setminus C} \\alpha_j x_j\\le |C|-1,\n\\]\nwith coefficients $\\alpha_j\\in\\mathbb{Z}_{\\ge 0}$ chosen so that the inequality is valid for $K$.\n\nFix $j\\in N\\setminus C$. For any integer $t\\ge 0$, consider the feasibility of a point with $x_j=1$ and with exactly $|C|-t$ variables in $C$ set to $1$. The smallest possible knapsack weight contributed by the $|C|-t$ chosen items of $C$ is obtained by omitting the $t$ largest weights among $\\{a_i:i\\in C\\}$, hence this minimum is $\\mu_t$. Therefore, for a given $t$, there exists $x\\in K$ with $x_j=1$ and $\\sum_{i\\in C} x_i=|C|-t$ if and only if\n\\[\n\\label{eq:7.u47}\na_j+\\mu_t\\le b.\n\\]\nSince $b=\\sum_{i\\in C} a_i-\\lambda$, this condition is equivalent to\n\\[\n\\label{eq:7.u48}\na_j\\le \\mu_t-\\lambda.\n\\]\nConsequently, the smallest integer $t$ for which feasibility is possible satisfies\n\\[\n\\label{eq:7.u49}\nt=\\min\\{s\\ge 0: a_j\\le \\mu_s-\\lambda\\}.\n\\]\nWith the definition of $h(j)$ and the assumption $a_j\\le \\mu_{h(j)+1}-\\lambda$, one has $a_j\\not\\le \\mu_{h(j)}-\\lambda$ (because $a_j\\ge \\mu_{h(j)}$ and $\\lambda>0$) and $a_j\\le \\mu_{h(j)+1}-\\lambda$, hence the above minimum equals $h(j)+1$.\n\nNow consider any valid lifting coefficient $\\alpha_j$ in a facet-defining lifting. Setting $x_j=1$ forces, for every $x\\in K$ with $x_j=1$, at most $|C|-\\alpha_j-1$ variables from $C$ to be equal to $1$; otherwise the left-hand side would be at least $|C|-\\alpha_j+\\alpha_j=|C|$, violating the right-hand side $|C|-1$. Equivalently, feasibility with $x_j=1$ requires dropping at least $\\alpha_j+1$ items from $C$. By the characterization above, this implies\n\\[\n\\label{eq:7.u50}\n\\alpha_j+1\\ge \\min\\{s\\ge 0: a_j\\le \\mu_s-\\lambda\\}=h(j)+1,\n\\]\nso $\\alpha_j\\ge h(j)$.\n\nOn the other hand, the choice $\\alpha_j=h(j)$ is valid for variable $j$ because, by definition of the minimum, there exists $x\\in K$ with $x_j=1$ and $\\sum_{i\\in C} x_i=|C|-(h(j)+1)$, i.e., with exactly $h(j)+1$ items of $C$ dropped. For such an $x$,\n\\[\n\\label{eq:7.u51}\n\\sum_{i\\in C} x_i + h(j) x_j = (|C|-(h(j)+1)) + h(j)=|C|-1,\n\\]\nso increasing $\\alpha_j$ above $h(j)$ would cut off this feasible point and therefore cannot yield a valid lifting. Hence every valid lifting must have $\\alpha_j=h(j)$.\n\nApplying this argument to each $j\\in N\\setminus C$ shows that there is exactly one valid lifted inequality of the above form, namely\n\\[\n\\label{eq:7.u52}\n\\sum_{j \\in C} x_j + \\sum_{j \\in N \\setminus C} h(j) x_j \\le |C| - 1.\n\\]\nBy construction it is tight on a set of affinely independent feasible points consisting of (i) for each $i\\in C$, the point with $x_i=0$ and $x_k=1$ for all $k\\in C\\setminus\\{i\\}$ and $x_j=0$ for $j\\in N\\setminus C$, and (ii) for each $j\\in N\\setminus C$, a point with $x_j=1$ and exactly $|C|-(h(j)+1)$ ones in $C$ attaining equality as above; these points exist by the minimality of $C$ and the feasibility characterization using $\\mu_{h(j)+1}$. These points lie in $K$ and satisfy the inequality at equality, and their affine hull has codimension $1$ in $\\operatorname{aff}(\\operatorname{conv}(K))$. Therefore the inequality defines a facet of $\\operatorname{conv}(K)$. Since every facet-defining lifting must use the unique coefficients $\\alpha_j=h(j)$, this facet-defining lifting is unique.\n\\end{proof}",
    "index": 16
  },
  {
    "label": "Definition 7.8",
    "env": "def",
    "number_components": [
      7,
      8
    ],
    "extracted_labels": [
      "def:7.8",
      "eq:7.u53",
      "eq:7.u54"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 1
    },
    "content": "\\begin{definition}\n\\label{def:7.8}\n[Knapsack instance of Example~7.6]\nDefine\n\\[\n\\label{eq:7.u53}\nK := \\{x \\in \\{0, 1\\}^5 : 5x_1 + 4x_2 + 3x_3 + 2x_4 + x_5 \\leq 5\\}\n\\]\nand the cover \\(C:=\\{3,4,5\\}\\). The minimal cover inequality associated with \\(C\\) is\n\\[\n\\label{eq:7.u54}\nx_3+x_4+x_5\\le 2.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 17
  },
  {
    "label": "Proposition 7.5",
    "env": "prop",
    "number_components": [
      7,
      5
    ],
    "extracted_labels": [
      "prop:7.5",
      "eq:7.u55",
      "eq:7.u56",
      "prf:prop:7.5",
      "eq:7.u57",
      "eq:7.u58",
      "eq:7.u59",
      "eq:7.u60",
      "eq:7.u61"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 1
    },
    "content": "\\begin{proposition}\n\\label{prop:7.5}\n[Facet-defining lifted cover inequality]\nLet\n\\[\n\\label{eq:7.u55}\nK := \\{x \\in \\{0,1\\}^5 : 5x_1 + 4x_2 + 3x_3 + 2x_4 + x_5 \\le 5\\},\n\\qquad P:=\\operatorname{conv}(K),\n\\]\nand let \\(C:=\\{3,4,5\\}\\). Then \\(C\\) is a minimal cover for the knapsack constraint, and the inequality\n\\[\n\\label{eq:7.u56}\n2x_1 + x_2 + x_3 + x_4 + x_5 \\le 2\n\\]\nis valid for \\(P\\) and defines a facet of \\(P\\). Moreover, among inequalities obtained by sequentially lifting the cover inequality\n\\(x_3+x_4+x_5\\le 2\\) to the variables \\(x_2\\) and \\(x_1\\), the above inequality is the unique facet-defining lifting.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.5}\nFirst, \\(C=\\{3,4,5\\}\\) is a cover since \\(3+2+1=6>5\\). It is minimal because removing any element yields total weight at most \\(5\\): \\(2+1=3\\), \\(3+1=4\\), and \\(3+2=5\\).\n\n\\emph{Validity.} For any \\(x\\in K\\), if \\(x_1=0\\) then the knapsack constraint implies \\(4x_2+3x_3+2x_4+x_5\\le 5\\), hence at most two of \\(x_2,x_3,x_4,x_5\\) can equal \\(1\\) (the minimum weight of any three distinct variables among these is \\(x_3+x_4+x_5\\) with weight \\(3+2+1=6\\)). Therefore, when \\(x_1=0\\) one has \\(x_2+x_3+x_4+x_5\\le 2\\), so \\(2x_1+x_2+x_3+x_4+x_5\\le 2\\). If \\(x_1=1\\), then \\(5x_1\\le 5\\) forces \\(x_2=x_3=x_4=x_5=0\\), and the inequality gives \\(2\\le 2\\). Thus the inequality is valid for all \\(x\\in K\\), hence for \\(P\\).\n\n\\emph{Facet.} Consider the face\n\\[\n\\label{eq:7.u57}\nF:=\\{x\\in P: 2x_1+x_2+x_3+x_4+x_5=2\\}.\n\\]\nThe following five points of \\(K\\) satisfy the inequality at equality:\n\\[\n\\label{eq:7.u58}\n(1,0,0,0,0),\\ (0,1,1,0,0),\\ (0,1,0,1,0),\\ (0,1,0,0,1),\\ (0,0,1,1,0).\n\\]\nAll are feasible since their knapsack weights are respectively \\(5\\), \\(4+3=7\\) (not feasible), \\(4+2=6\\) (not feasible), \\(4+1=5\\), and \\(3+2=5\\). Replace the infeasible points by feasible equality points:\n\\[\n\\label{eq:7.u59}\n(1,0,0,0,0),\\ (0,1,0,0,1),\\ (0,0,1,1,0),\\ (0,0,1,0,1),\\ (0,0,0,1,1).\n\\]\nTheir knapsack weights are \\(5\\), \\(5\\), \\(5\\), \\(4\\), and \\(3\\), respectively, and each satisfies \\(2x_1+x_2+x_3+x_4+x_5=2\\). Let the rows of the matrix\n\\[\n\\label{eq:7.u60}\nM:=\\begin{pmatrix}\n1&0&0&0&0\\\\\n0&1&0&0&1\\\\\n0&0&1&1&0\\\\\n0&0&1&0&1\\\\\n0&0&0&1&1\n\\end{pmatrix}\n\\]\nbe these points. The rank of \\(M\\) is \\(5\\) (the first row isolates \\(x_1\\); the remaining four rows form a nonsingular \\(4\\times 4\\) matrix in variables \\(x_2,x_3,x_4,x_5\\)). Hence these five points are affinely independent. Therefore \\(F\\) has affine dimension \\(4\\), so it is a facet of \\(P\\) (since \\(P\\subseteq\\mathbb{R}^5\\) is full-dimensional).\n\n\\emph{Uniqueness among sequential liftings.} Start from the cover inequality on \\(C\\):\n\\[\n\\label{eq:7.u61}\nx_3+x_4+x_5\\le 2.\n\\]\nLift \\(x_2\\) first. The lifting coefficient \\(\\alpha_2\\) is the largest value such that\n\\(\\alpha_2 x_2 + x_3+x_4+x_5\\le 2\\) is valid for all \\(x\\in K\\) with \\(x_1=0\\). If \\(x_2=1\\), the remaining capacity is \\(1\\), so at most one of \\(x_3,x_4,x_5\\) can be \\(1\\) (since the smallest weight among them is \\(1\\)). Hence the maximum of \\(x_3+x_4+x_5\\) subject to \\(x\\in K\\), \\(x_1=0\\), \\(x_2=1\\) is \\(1\\), giving \\(\\alpha_2=2-1=1\\). Thus the lifted inequality becomes\n\\(x_2+x_3+x_4+x_5\\le 2\\).\n\nNext lift \\(x_1\\). With \\(x_1=1\\), feasibility forces \\(x_2=x_3=x_4=x_5=0\\), so the maximum of \\(x_2+x_3+x_4+x_5\\) under \\(x\\in K\\), \\(x_1=1\\) equals \\(0\\), yielding the lifting coefficient \\(\\alpha_1=2-0=2\\). This produces\n\\(2x_1+x_2+x_3+x_4+x_5\\le 2\\).\n\nThe coefficients \\(\\alpha_2\\) and \\(\\alpha_1\\) are uniquely determined by these maximization problems, so this sequential lifting yields a unique lifted inequality. Since it was shown to define a facet, it is the unique facet-defining inequality obtainable by sequentially lifting \\(x_3+x_4+x_5\\le 2\\) to \\(x_2\\) and \\(x_1\\).\n\\end{proof}",
    "index": 18
  },
  {
    "label": "Definition 7.9",
    "env": "def",
    "number_components": [
      7,
      9
    ],
    "extracted_labels": [
      "def:7.9",
      "eq:7.u62"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Functions, Superadditivity, and Sequence Independent Lifting",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 2
    },
    "content": "\\begin{definition}\n\\label{def:7.9}\nLet \\(S := \\{x \\in \\{0,1\\}^n : Ax \\le b\\}\\), where \\(A \\ge 0\\) and \\(\\dim(S)=n\\). Let \\(C \\subseteq N:=\\{1,\\dots,n\\}\\), and let \\(\\sum_{j\\in C}\\alpha_j x_j \\le \\beta\\) be a valid inequality for \\(S \\cap \\{x : x_j=0\\ \\text{for } j\\in N\\setminus C\\}\\). For \\(z\\in[0,b]\\), define\n\\[\n\\label{eq:7.u62}\n\\begin{aligned}\n f(z) := \\beta - \\max\\ &\\sum_{i\\in C}\\alpha_i x_i\\\\\n \\text{s.t. }&\\sum_{i\\in C} a^i x_i \\le b - z,\\\\\n &x_i\\in\\{0,1\\}\\ \\text{for } i\\in C,\n\\end{aligned}\n\\]\nwhere \\(a^i\\) denotes the \\(i\\)th column of \\(A\\). The function \\(f:[0,b]\\to\\mathbb{R}\\) is called the lifting function of \\(\\sum_{j\\in C}\\alpha_j x_j \\le \\beta\\).\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 19
  },
  {
    "label": "Definition 7.10",
    "env": "def",
    "number_components": [
      7,
      10
    ],
    "extracted_labels": [
      "def:7.10",
      "eq:7.u63"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Functions, Superadditivity, and Sequence Independent Lifting",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 2
    },
    "content": "\\begin{definition}\n\\label{def:7.10}\nLet $U\\subseteq \\mathbb{R}^m$. A function $g:U\\to\\mathbb{R}$ is called \\emph{superadditive} if for all $u,v\\in U$ with $u+v\\in U$, the inequality\n\\[\n\\label{eq:7.u63}\ng(u+v)\\ge g(u)+g(v)\n\\]\nholds.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 20
  },
  {
    "label": "Theorem 7.2",
    "env": "thm",
    "number_components": [
      7,
      2
    ],
    "extracted_labels": [
      "thm:7.2",
      "eq:7.u64",
      "eq:7.u65",
      "prf:thm:7.2",
      "eq:7.11",
      "eq:7.u66"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Functions, Superadditivity, and Sequence Independent Lifting",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 2
    },
    "content": "\\begin{theorem}\n\\label{thm:7.2}\nLet \\(g : [0, b] \\to \\mathbb{R}\\) be a superadditive function such that \\(g \\leq f\\). Then\n\\[\n\\label{eq:7.u64}\n\\sum_{j \\in C} \\alpha_j x_j + \\sum_{j \\in N \\setminus C} g(a^j) x_j \\leq \\beta\n\\]\nis a valid inequality for \\(S\\). In particular, if \\(f\\) is superadditive, then the inequality\n\\[\n\\label{eq:7.u65}\n\\sum_{j \\in C} \\alpha_j x_j + \\sum_{j \\in N \\setminus C} f(a^j) x_j \\leq \\beta\n\\]\nis the unique maximal lifting of \\(\\sum_{j \\in C} \\alpha_j x_j \\leq \\beta\\).\n\\end{theorem}",
    "dependencies": [
      "Proposition 7.2"
    ],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.2}\nFor the first part of the statement, let \\(\\alpha_j := g(a^j)\\) for \\(j \\in N \\setminus C\\). Let \\(t := n - |C|\\). Given an ordering \\(j_1, \\ldots, j_t\\) of the indices in \\(N \\setminus C\\), let \\(C_0 := C\\) and \\(C_i := C_{i-1} \\cup \\{j_i\\}\\), \\(i = 1, \\ldots, t\\), and define the function \\(f_i : [0, b] \\to \\mathbb{R}\\) by\n\n\\[\n\\begin{aligned}\nf_i(z) := \\beta - \\max \\sum_{j \\in C_{i-1}} \\alpha_j x_j \\\\\n\\sum_{j \\in C_{i-1}} a^j x_j \\leq b - z\n\\end{aligned}\n\\tag{7.11}\\label{eq:7.11}\n\\]\n\nNote that \\(f_1 = f\\) and, by definition, \\(f_1 \\geq f_2 \\geq \\ldots \\geq f_t\\). By Proposition~\\ref{prop:7.2}, the inequality \\(\\sum_{j=1}^{n} \\alpha_j x_j \\leq \\beta\\) is valid for \\(S\\) if \\(\\alpha_{j_i} \\leq f_i(a^{j_i})\\) for \\(i = 1, \\ldots, t\\). The claim is that \\(g \\leq f_i\\) for \\(i = 1, \\ldots, t\\), implying that \\(\\alpha_{j_i} = g(a^{j_i}) \\leq f_i(a^{j_i})\\).\n\nThe proof is by induction on \\(i\\). By assumption \\(g \\leq f_1\\). Consider \\(2 \\leq i \\leq t\\), and assume by induction that \\(g \\leq f_{i-1}\\). Given \\(z \\in [0, b]\\), it suffices to prove that \\(g(z) \\leq f_i(z)\\). Let \\(x^*\\) be an optimal solution of (7.11), and define \\(u^* := a^{j_{i-1}} x^*_{j_{i-1}}\\). Then\n\n\\begin{align*}\n\\label{eq:7.u66}\nf_i(z) &= \\beta - \\sum_{j \\in C_{i-2}} \\alpha_j x_j^* - \\alpha_{j_{i-1}} x^*_{j_{i-1}} \\\\\n&= \\beta - \\max \\left\\{ \\sum_{j \\in C_{i-2}} \\alpha_j x_j : \\sum_{j \\in C_{i-2}} a^j x_j \\leq b - z - u^* \\right\\} - \\alpha_{j_{i-1}} x^*_{j_{i-1}} \\\\\n&= f_{i-1}(z + u^*) - g(a^{j_{i-1}}) x^*_{j_{i-1}} \\\\\n&\\geq g(z + u^*) - g(a^{j_{i-1}}) x^*_{j_{i-1}} \\quad \\text{(because } g \\leq f_{i-1}) \\\\\n&\\geq g(z + u^*) - g(a^{j_{i-1}}) x^*_{j_{i-1}} \\quad \\text{(because } g \\text{ is superadditive and } x^*_{j_{i-1}} \\in \\mathbb{Z}_+) \\\\\n&= g(z + u^*) - g(u^*) \\\\\n&\\geq g(z) \\quad \\text{(because } g \\text{ is superadditive)}.\n\\end{align*}\n\nFor the last part of the statement, assume that \\(f = f_1\\) is superadditive. By the first part of the statement, \\(\\sum_{j \\in C} \\alpha_j x_j + \\sum_{j \\in N \\setminus C} f(a^j) x_j \\leq \\beta\\) is valid for \\(S\\). It follows from the first part of the proof that \\(f_1 \\leq f_i\\) for \\(i = 1, \\ldots, t\\). Since \\(f_1 \\geq f_2 \\geq \\ldots \\geq f_t\\), it follows that \\(f_1 = f_2 = \\ldots = f_t\\). Therefore \\(\\alpha_j \\leq f(a^j)\\), \\(j \\in N \\setminus C\\), for every lifting \\(\\sum_{j=1}^n \\alpha_j x_j \\leq \\beta\\) of \\(\\sum_{j \\in C} \\alpha_j x_j \\leq \\beta\\).\n\\end{proof}",
    "index": 21
  },
  {
    "label": "Proposition 7.6",
    "env": "prop",
    "number_components": [
      7,
      6
    ],
    "extracted_labels": [
      "prop:7.6",
      "eq:7.u67",
      "prf:prop:7.6",
      "eq:7.u68"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Lifting Functions, Superadditivity, and Sequence Independent Lifting",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 2
    },
    "content": "\\begin{proposition}\n\\label{prop:7.6}\nLet $N$ be a finite index set and let $S\\subseteq\\{0,1\\}^N$. Let $C\\subseteq N$. For each $j\\in C$ let $\\alpha_j\\in\\mathbb{R}$, let $\\beta\\in\\mathbb{R}$, and for each $j\\in N\\setminus C$ let $g(a^j)\\in\\mathbb{R}\\cup\\{+\\infty\\}$. Consider the inequality\n\\[\n\\label{eq:7.u67}\n\\sum_{j\\in C}\\alpha_j x_j + \\sum_{j\\in N\\setminus C} g(a^j) x_j \\le \\beta.\n\\]\nAssume that for every $x\\in S$, the extended-real expression on the left-hand side is well-defined with the convention $0\\cdot(+\\infty)=0$ and $1\\cdot(+\\infty)=+\\infty$. If for some $j\\in N\\setminus C$ one has $S\\cap\\{x\\in\\{0,1\\}^N: x_j=1\\}=\\emptyset$, then the inequality remains valid for $S$ even when $g(a^j)=+\\infty$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.6}\nFix $j\\in N\\setminus C$ such that $S\\cap\\{x\\in\\{0,1\\}^N: x_j=1\\}=\\emptyset$. Then $x_j=0$ for all $x\\in S$. For any $x\\in S$, using the convention $0\\cdot(+\\infty)=0$ gives\n\\[\n\\label{eq:7.u68}\ng(a^j)x_j = g(a^j)\\cdot 0 = 0,\n\\]\nso the value of $g(a^j)$ (including the case $g(a^j)=+\\infty$) does not affect the left-hand side evaluated at $x$. Therefore, for every $x\\in S$ the inequality with coefficient $g(a^j)=+\\infty$ is equivalent to the same inequality with any finite replacement of that coefficient, and in particular it is satisfied by exactly the same points of $S$. Hence the inequality is valid for $S$ even when $g(a^j)=+\\infty$.\n\\end{proof}",
    "index": 22
  },
  {
    "label": "Definition 7.11",
    "env": "def",
    "number_components": [
      7,
      11
    ],
    "extracted_labels": [
      "def:7.11",
      "eq:7.u69",
      "eq:7.u70"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Sequence Independent Lifting for Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 3
    },
    "content": "\\begin{definition}\n\\label{def:7.11}\n[0--1 knapsack set and (minimal) cover inequality]\nLet $a\\in\\mathbb{R}^n$ and $b\\in\\mathbb{R}$ satisfy $0<a_j\\le b$ for all $j\\in\\{1,\\dots,n\\}$. The $0$--$1$ knapsack set is\n\\[\n\\label{eq:7.u69}\nK:=\\Bigl\\{x\\in\\{0,1\\}^n:\\sum_{j=1}^n a_j x_j\\le b\\Bigr\\}.\n\\]\nA set $C\\subseteq\\{1,\\dots,n\\}$ is a cover (for $K$) if $\\sum_{j\\in C} a_j>b$. A cover $C$ is minimal if $\\sum_{j\\in C\\setminus\\{i\\}} a_j\\le b$ for all $i\\in C$. For any cover $C$, the associated cover inequality is\n\\[\n\\label{eq:7.u70}\n\\sum_{j\\in C} x_j\\le |C|-1.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 23
  },
  {
    "label": "Definition 7.12",
    "env": "def",
    "number_components": [
      7,
      12
    ],
    "extracted_labels": [
      "def:7.12",
      "eq:7.u71",
      "eq:7.u72"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Sequence Independent Lifting for Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 3
    },
    "content": "\\begin{definition}\n\\label{def:7.12}\n[Superadditive lifting function $g$]\nLet $\\lambda\\in\\mathbb{R}$, let $t\\ge 1$ be an integer, and let $\\mu_1,\\dots,\\mu_t\\in\\mathbb{R}$ be given breakpoints. For $h=0,\\dots,t-1$, define\n\\[\n\\label{eq:7.u71}\n\\rho_h:=\\max\\{0,\\, a_{h+1}-(a_1-\\lambda)\\}.\n\\]\nDefine $g:\\mathbb{R}_{\\ge 0}\\to\\mathbb{R}$ by\n\\[\n\\label{eq:7.u72}\ng(z) := \\begin{cases} \n0 & \\text{if } z = 0, \\\\\n h & \\text{if } \\mu_h - \\lambda + \\rho_h < z \\leq \\mu_{h+1} - \\lambda, \\text{ for } h = 0, \\ldots, t-1, \\\\\n h - \\dfrac{\\mu_h - \\lambda + \\rho_h - z}{\\rho_1} & \\text{if } \\mu_h - \\lambda < z \\leq \\mu_h - \\lambda + \\rho_h, \\text{ for } h = 1, \\ldots, t-1.\n\\end{cases}\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 24
  },
  {
    "label": "Proposition 7.7",
    "env": "prop",
    "number_components": [
      7,
      7
    ],
    "extracted_labels": [
      "prop:7.7",
      "eq:7.u73",
      "eq:7.u74",
      "prf:prop:7.7",
      "eq:7.u75",
      "eq:7.u76",
      "eq:7.u77",
      "eq:7.u78"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Lifting",
      "subsection": "Sequence Independent Lifting for Minimal Cover Inequalities",
      "chapter_number": 7,
      "section_number": 2,
      "subsection_number": 3
    },
    "content": "\\begin{proposition}\n\\label{prop:7.7}\n[Lifted cover inequality induced by $g$]\nLet $K=\\{x\\in\\{0,1\\}^n: \\sum_{j=1}^n a_j x_j\\le b\\}$, where $a_j\\ge 0$ for all $j\\in N:=\\{1,\\dots,n\\}$ and $b\\ge 0$. Let $C\\subseteq N$ be a minimal cover, i.e., $\\sum_{j\\in C} a_j>b$ and $\\sum_{j\\in C\\setminus\\{i\\}} a_j\\le b$ for all $i\\in C$. Let $g:\\mathbb{R}_+\\to\\mathbb{R}_+$ be superadditive, i.e., $g(u+v)\\ge g(u)+g(v)$ for all $u,v\\in\\mathbb{R}_+$.\n\nFor each $j\\in N\\setminus C$, define the lifting argument\n\\[\n\\label{eq:7.u73}\na^j:=\\max\\Bigl\\{0,\\, a_j-\\bigl(b-\\sum_{i\\in C} a_i\\bigr)\\Bigr\\}.\n\\]\nThen the inequality\n\\[\n\\label{eq:7.u74}\n\\sum_{i\\in C} x_i + \\sum_{j\\in N\\setminus C} g(a^j)\\,x_j \\le |C|-1\n\\]\nis valid for $K$ and is a lifting of the minimal cover inequality $\\sum_{i\\in C} x_i\\le |C|-1$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.7}\nThe minimal cover inequality $\\sum_{i\\in C} x_i\\le |C|-1$ is valid for $K$ because $\\sum_{i\\in C} a_i>b$ implies that no point $x\\in K$ can satisfy $x_i=1$ for all $i\\in C$.\n\nFix $x\\in K$. If $\\sum_{i\\in C} x_i\\le |C|-1$, then\n\\[\n\\label{eq:7.u75}\n\\sum_{i\\in C} x_i + \\sum_{j\\in N\\setminus C} g(a^j)x_j \\le |C|-1 + \\sum_{j\\in N\\setminus C} g(a^j)x_j,\n\\]\nso it suffices to show that whenever some $x_j=1$ for $j\\in N\\setminus C$, the additional term $\\sum_{j\\in N\\setminus C} g(a^j)x_j$ cannot force the left-hand side to exceed $|C|-1$.\n\nAssume for contradiction that there exists $x\\in K$ such that\n\\[\n\\label{eq:7.u76}\n\\sum_{i\\in C} x_i + \\sum_{j\\in N\\setminus C} g(a^j)x_j \\ge |C|.\n\\]\nSince $x_i\\in\\{0,1\\}$, this implies $\\sum_{i\\in C} x_i=|C|$ and $\\sum_{j\\in N\\setminus C} g(a^j)x_j>0$. In particular, $x_i=1$ for all $i\\in C$.\n\nLet $J:=\\{j\\in N\\setminus C: x_j=1\\}$. Feasibility of $x$ for the knapsack yields\n\\[\n\\label{eq:7.u77}\n\\sum_{i\\in C} a_i + \\sum_{j\\in J} a_j \\le b.\n\\]\nRearranging gives\n\\[\n\\label{eq:7.u78}\n\\sum_{j\\in J} a_j \\le b-\\sum_{i\\in C} a_i.\n\\]\nBecause $C$ is a cover, $\\sum_{i\\in C} a_i>b$, hence the right-hand side is negative. Since each $a_j\\ge 0$, this forces $J=\\varnothing$. Consequently $x_j=0$ for all $j\\in N\\setminus C$, and thus $\\sum_{j\\in N\\setminus C} g(a^j)x_j=0$, contradicting the assumption that the left-hand side is at least $|C|$.\n\nTherefore the inequality is valid for all $x\\in K$. It is a lifting of $\\sum_{i\\in C} x_i\\le |C|-1$ because setting $x_j=0$ for all $j\\in N\\setminus C$ recovers the original cover inequality.\n\\end{proof}",
    "index": 25
  },
  {
    "label": "Definition 7.13",
    "env": "def",
    "number_components": [
      7,
      13
    ],
    "extracted_labels": [
      "def:7.13",
      "eq:7.u79"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.13}\n[Single-node flow set]\nLet $n\\in\\mathbb{Z}_{\\ge 1}$, let $a\\in\\mathbb{R}_{>0}^n$ and $b\\in\\mathbb{R}_{>0}$ satisfy $0<a_j\\le b$ for all $j\\in\\{1,\\dots,n\\}$. The \\emph{single-node flow set} is\n\\[\n\\label{eq:7.u79}\nT:=\\left\\{(x,y)\\in\\{0,1\\}^n\\times\\mathbb{R}_+^n:\\ \\sum_{j=1}^n y_j\\le b\\right\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 26
  },
  {
    "label": "Definition 7.14",
    "env": "def",
    "number_components": [
      7,
      14
    ],
    "extracted_labels": [
      "def:7.14",
      "eq:7.u80",
      "eq:7.u81"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.14}\n[Flow cover and flow cover inequality]\nLet $N:=\\{1,\\dots,n\\}$ and let $T$ be the single-node flow set with parameters $(a,b)$. A set $C\\subseteq N$ is a \\emph{flow cover} if\n\\[\n\\label{eq:7.u80}\n\\sum_{j\\in C} a_j>b.\n\\]\nFor a flow cover $C$, define $\\lambda:=\\sum_{j\\in C} a_j-b$ and $(t)^+:=\\max\\{t,0\\}$. The \\emph{flow cover inequality} associated with $C$ is\n\\[\n\\label{eq:7.u81}\n\\sum_{j\\in C} y_j + \\sum_{j\\in C} (a_j-\\lambda)^+\\,(1-x_j)\\le b.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 27
  },
  {
    "label": "Theorem 7.3",
    "env": "thm",
    "number_components": [
      7,
      3
    ],
    "extracted_labels": [
      "thm:7.3",
      "prf:thm:7.3",
      "eq:7.u82",
      "eq:7.u83",
      "eq:7.u84",
      "eq:7.u85",
      "eq:7.u86",
      "eq:7.16"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.3}\n[Padberg et al.]\nLet $C$ be a flow cover for the single-node flow set $T$, and let $\\lambda := \\sum_{j \\in C} a_j - b$. The flow cover inequality defined by $C$ is valid for $T$. Furthermore, it defines a facet of $\\operatorname{conv}(T)$ if $\\lambda < \\max_{j \\in C} a_j$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.3}\nThe flow cover inequality defined by $C$ is valid for $T$ since\n\\[\n\\label{eq:7.u82}\n\\sum_{j \\in C} y_j \\leq \\min\\{b, \\sum_{j \\in C} a_j x_j\\} = b - (b - \\sum_{j \\in C} a_j x_j)^+ = b - (\\sum_{j \\in C} a_j (1 - x_j) - \\lambda)^+ \\leq b - \\sum_{j \\in C} (a_j - \\lambda)^+ (1 - x_j),\n\\]\nwhere the last inequality holds because $x$ is a $0,1$ vector.\n\nLet $ F $ be the face of $ \\text{conv}(T) $ defined by (7.14). Note that $ F $ is a proper face, since the point defined by $ x_j = 1 $, $ y_j = 0 $ for $ j = 1, \\ldots, n $ is in $ T \\setminus F $.\n\nAssume that $ \\lambda < \\max_{j \\in C} a_j $. It suffices to provide a set $ X \\subseteq F $ of points such that $ \\dim(X) = 2n - 1 $.\n\nWithout loss of generality, assume that $ C = \\{1, \\ldots, k\\} $, and $ a_1 \\geq \\ldots \\geq a_t \\geq \\lambda $, $ a_{t+1}, \\ldots, a_k < \\lambda $ where $ 1 \\leq t \\leq k $.\n\nDefine the point $ \\tilde{x} \\in \\{0, 1\\}^n $ by $ \\tilde{x}_j = 1 $ for $ j \\in C $, $ \\tilde{x}_j = 0 $ for $ j \\in N \\setminus C $. For $ i \\in C $, let $ x^i := \\tilde{x} - e^i $, where $ e^i $ denotes the $ i $th unit vector. For $ i \\in N \\setminus C $, let $ x^i := \\tilde{x} - e^1 + e^i $.\n\nFor $ i = 1, \\ldots, t $, define the points $ y^i, \\tilde{y}^i \\in \\mathbb{R}^n $ by\n\\[\n\\label{eq:7.u83}\ny^i_j := \\begin{cases} \n a_j & j \\in C \\setminus \\{i\\} \\\\\n 0 & j \\in (N \\setminus C) \\cup \\{i\\}\n\\end{cases}, \\quad \\tilde{y}^i_j := \\begin{cases} \n y^i_j & j \\in N \\setminus \\{i\\} \\\\\n a_i - \\lambda & j = i.\n\\end{cases}\n\\]\n\nFor $ i = t + 1, \\ldots, k $, define the point $ y^i \\in \\mathbb{R}^n $ by\n\\[\n\\label{eq:7.u84}\ny^i_j := \\begin{cases} \n a_1 + a_i - \\lambda & j = 1 \\\\\n a_j & j \\in C \\setminus \\{1, i\\} \\\\\n 0 & j \\in (N \\setminus C) \\cup \\{i\\}.\n\\end{cases}\n\\]\n\nFinally, for $ i \\in N \\setminus C $, let $ y^i \\in \\mathbb{R}^n $ be defined by\n\\[\n\\label{eq:7.u85}\ny^i_j := \\begin{cases} \n y^1_j & j \\in N \\setminus \\{i\\} \\\\\n \\min\\{a_i, a_1 - \\lambda\\} & j = i.\n\\end{cases}\n\\]\n\nLet $ X $ be the following set of $ 2n $ points in $ \\{0, 1\\}^n \\times \\mathbb{R}^n $: $ (x^i, y^i) $ for $ i \\in N $; $ (x^i, y^1) $ for $ i \\in N \\setminus C $; $ (\\tilde{x}, \\tilde{y}^i) $ for $ i = 1, \\ldots, t $; $ (\\tilde{x}, y^i) $ for $ i = t + 1, \\ldots, k $.\n\nOne can verify that $ X \\subseteq T \\cap F $. It suffices to show that the system\n\\[\n\\label{eq:7.u86}\n\\alpha x + \\beta y = \\gamma \\quad \\text{for all } (x, y) \\in X,\n\\]\nin the variables $ (\\alpha, \\beta, \\gamma) \\in \\mathbb{R}^n \\times \\mathbb{R}^n \\times \\mathbb{R} $, has a unique nonzero solution up to scalar multiplication. Consider such a nonzero solution $ (\\alpha, \\beta, \\gamma) $.\n\nLet $ i \\in N \\setminus C $. Then $ \\alpha_i = (\\alpha x^i + \\beta y^1) - (\\alpha x^1 + \\beta y^1) = \\gamma - \\gamma = 0 $. Similarly, $ \\min\\{a_i, a_1 - \\lambda\\} \\beta_i = (\\alpha x^i + \\beta y^i) - (\\alpha x^i + \\beta y^1) = 0 $, implying $ \\beta_i = 0 $. This shows $ \\alpha_i = \\beta_i = 0 $ for all $ i \\in N \\setminus C $.\n\nFor $ i = 2, \\ldots, t $, $ \\lambda(\\beta_1 - \\beta_i) = (\\alpha \\tilde{x} + \\beta \\tilde{y}^i) - (\\alpha \\tilde{x} + \\beta \\tilde{y}^1) = 0 $. For $ i = t + 1, \\ldots, k $, $ a_i(\\beta_1 - \\beta_i) = (\\alpha \\tilde{x} + \\beta y^i) - (\\alpha \\tilde{x} + \\beta \\tilde{y}^1) = 0 $. This shows that $ \\beta_i = \\beta_1 $ for all $ i \\in C $.\n\nFor $ i = t + 1, \\ldots, k $, $ \\alpha_i = (\\alpha \\tilde{x} + \\beta y^i) - (\\alpha x^i + \\beta y^i) = 0 $. For $ i = 1, \\ldots, t $,\n$ \\alpha_i + \\beta_i (a_i - \\lambda) = (\\alpha \\tilde{x} + \\beta \\tilde{y}^i) - (\\alpha x^i + \\beta y^i) = 0 $, thus $ \\alpha_i = -\\beta_1 (a_i - \\lambda) $. Since\n$ (\\alpha, \\beta) $ is not the zero vector, it follows that $ \\beta_1 \\neq 0 $, and up to rescaling it may be assumed that $ \\beta_1 = 1 $.\n\nFinally, substituting $ (\\tilde{x}^1, \\tilde{y}^1) $ into (7.15) gives $ \\gamma = b - \\sum_{j \\in C} (a_j - \\lambda)^+ $.\n\nTherefore the points in $ F $ defined above generate the affine space\n\\[\n\\sum_{j \\in C} y_j + \\sum_{j \\in C} (a_j - \\lambda)^+ (1 - x_j) = b.\n\\tag{7.16}\\label{eq:7.16}\n\\]\n\nThis proves that (7.14) defines a facet of $ \\text{conv}(T) $.\n\\end{proof}",
    "index": 28
  },
  {
    "label": "Definition 7.15",
    "env": "def",
    "number_components": [
      7,
      15
    ],
    "extracted_labels": [
      "def:7.15",
      "eq:7.u87"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.15}\n[Knapsack set]\nLet $a\\in\\mathbb{R}^n_+$ and $b\\in\\mathbb{R}_+$. The \\emph{knapsack set} is\n\\[\n\\label{eq:7.u87}\nK := \\left\\{ x \\in \\{0,1\\}^n : \\sum_{j=1}^n a_j x_j \\le b \\right\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 29
  },
  {
    "label": "Proposition 7.8",
    "env": "prop",
    "number_components": [
      7,
      8
    ],
    "extracted_labels": [
      "prop:7.8",
      "eq:7.u88",
      "eq:7.u89",
      "eq:7.u90",
      "eq:7.u91",
      "prf:prop:7.8",
      "eq:7.u92",
      "eq:7.u93",
      "eq:7.u94",
      "eq:7.u95",
      "eq:7.u96",
      "eq:7.u97",
      "eq:7.u98"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.8}\n[Flow cover inequality induces knapsack cover inequality]\nLet $a\\in\\mathbb{R}^n_+$ and $b\\in\\mathbb{R}_+$, and define the knapsack set\n\\[\n\\label{eq:7.u88}\nK:=\\Bigl\\{x\\in\\{0,1\\}^n:\\sum_{j=1}^n a_j x_j\\le b\\Bigr\\}.\n\\]\nLet $C\\subseteq\\{1,\\dots,n\\}$ be a minimal cover for $K$, i.e., $\\sum_{j\\in C} a_j>b$ and $\\sum_{j\\in C\\setminus\\{i\\}} a_j\\le b$ for every $i\\in C$. Define\n\\[\n\\label{eq:7.u89}\n\\lambda:=\\sum_{j\\in C} a_j - b>0.\n\\]\nThen the inequality\n\\[\n\\label{eq:7.u90}\n\\sum_{j \\in C} a_j x_j + \\sum_{j \\in C} (a_j - \\lambda)^+ (1 - x_j) \\leq b\n\\]\nis valid for $K$. Moreover, minimality of $C$ implies $a_j>\\lambda$ for all $j\\in C$, so $(a_j-\\lambda)^+=a_j-\\lambda$ for $j\\in C$, and the above inequality is equivalent to\n\\[\n\\label{eq:7.u91}\n\\sum_{j\\in C} x_j\\le |C|-1.\n\\]\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.8}\nFix $x\\in K$. If there exists $j\\in C$ with $x_j=0$, then\n\\[\n\\label{eq:7.u92}\n\\sum_{i\\in C} a_i x_i \\le \\sum_{i\\in C\\setminus\\{j\\}} a_i \\le b\n\\]\nby the minimal-cover property. Since $(a_i-\\lambda)^+\\ge 0$ for all $i\\in C$, the left-hand side\n\\[\n\\label{eq:7.u93}\n\\sum_{i \\in C} a_i x_i + \\sum_{i \\in C} (a_i - \\lambda)^+ (1 - x_i)\n\\]\nis at most\n\\[\n\\label{eq:7.u94}\n\\sum_{i\\in C} a_i x_i + \\sum_{i\\in C} (a_i-\\lambda)^+ \\le \\sum_{i\\in C} a_i x_i + \\sum_{i\\in C} a_i,\n\\]\nbut a sharper direct bound suffices: because $x_j=0$, the second sum contains the nonnegative term $(a_j-\\lambda)^+$, hence the entire expression is bounded above by $b$ already from $\\sum_{i\\in C} a_i x_i\\le b$. Therefore the inequality holds.\n\nIf instead $x_j=1$ for all $j\\in C$, then\n\\[\n\\label{eq:7.u95}\n\\sum_{j \\in C} a_j x_j + \\sum_{j \\in C} (a_j - \\lambda)^+ (1 - x_j)=\\sum_{j\\in C} a_j = b+\\lambda > b.\n\\]\nThus such an $x$ cannot belong to $K$ because it would violate the knapsack constraint $\\sum_{j=1}^n a_j x_j\\le b$. Hence every $x\\in K$ satisfies $x_j=0$ for at least one $j\\in C$, and the inequality is valid for $K$.\n\nTo prove the stated equivalence under minimality, fix $j\\in C$. From $\\sum_{i\\in C\\setminus\\{j\\}} a_i\\le b$ it follows that\n\\[\n\\label{eq:7.u96}\n\\lambda=\\sum_{i\\in C} a_i-b \\le \\sum_{i\\in C} a_i-\\sum_{i\\in C\\setminus\\{j\\}} a_i=a_j,\n\\]\nand strict inequality holds because $\\sum_{i\\in C} a_i>b$. Hence $a_j>\\lambda$ for all $j\\in C$, so $(a_j-\\lambda)^+=a_j-\\lambda$ on $C$. Substituting yields\n\\[\n\\label{eq:7.u97}\n\\sum_{j\\in C} a_j x_j+\\sum_{j\\in C}(a_j-\\lambda)(1-x_j)=\\sum_{j\\in C}(a_j-\\lambda)+\\lambda\\sum_{j\\in C}x_j.\n\\]\nSince $\\sum_{j\\in C}(a_j-\\lambda)=\\sum_{j\\in C}a_j-|C|\\lambda=b+\\lambda-|C|\\lambda=b-(|C|-1)\\lambda$, the inequality becomes\n\\[\n\\label{eq:7.u98}\nb-(|C|-1)\\lambda+\\lambda\\sum_{j\\in C}x_j\\le b,\n\\]\nwhich is equivalent (as $\\lambda>0$) to $\\sum_{j\\in C}x_j\\le |C|-1$.\n\\end{proof}",
    "index": 30
  },
  {
    "label": "Definition 7.16",
    "env": "def",
    "number_components": [
      7,
      16
    ],
    "extracted_labels": [
      "def:7.16",
      "eq:7.u99",
      "eq:7.u100",
      "eq:7.u101",
      "eq:7.u102",
      "eq:7.u103"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.16}\n[Capacitated facility location formulation]\nGiven demands $d_i\\ge 0$ for $i=1,\\dots,m$, facility capacities $u_j\\ge 0$ and fixed opening costs $f_j$ for $j=1,\\dots,n$, and transportation costs $c_{ij}$, the \\emph{capacitated facility location problem} is the mixed-integer program\n\\[\n\\label{eq:7.u99}\n\\min \\sum_{i=1}^{m} \\sum_{j=1}^{n} c_{ij} y_{ij} + \\sum_{j=1}^{n} f_j x_j\n\\]\nsubject to\n\\[\n\\label{eq:7.u100}\n\\sum_{j=1}^{n} y_{ij} = d_i \\quad i = 1, \\ldots, m,\n\\]\n\\[\n\\label{eq:7.u101}\n\\sum_{i=1}^{m} y_{ij} \\leq u_j x_j \\quad j = 1, \\ldots, n,\n\\]\n\\[\n\\label{eq:7.u102}\ny_{ij}\\ge 0 \\quad (i=1,\\dots,m;\\ j=1,\\dots,n),\n\\]\n\\[\n\\label{eq:7.u103}\nx\\in\\{0,1\\}^n.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 31
  },
  {
    "label": "Definition 7.17",
    "env": "def",
    "number_components": [
      7,
      17
    ],
    "extracted_labels": [
      "def:7.17",
      "eq:7.u104",
      "eq:7.u105",
      "eq:7.u106",
      "eq:7.u107"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.17}\n[Aggregated variables for facility location]\nFor the capacitated facility location formulation, define aggregated shipment variables $z_j$ for $j=1,\\dots,n$ by\n\\[\n\\label{eq:7.u104}\nz_j := \\sum_{i=1}^{m} y_{ij}.\n\\]\nLet $b:=\\sum_{i=1}^{m} d_i$. Then any feasible solution induces a pair $(x,z)\\in\\{0,1\\}^n\\times\\mathbb{R}^n$ satisfying\n\\[\n\\label{eq:7.u105}\n\\sum_{j=1}^{n} z_j \\leq b,\n\\]\n\\[\n\\label{eq:7.u106}\nz_j \\leq u_j x_j \\quad j = 1, \\ldots, n,\n\\]\n\\[\n\\label{eq:7.u107}\nz_j \\geq 0 \\quad j = 1, \\ldots, n.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 32
  },
  {
    "label": "Theorem 7.4",
    "env": "thm",
    "number_components": [
      7,
      4
    ],
    "extracted_labels": [
      "thm:7.4",
      "eq:7.u108",
      "eq:7.u109",
      "prf:thm:7.4",
      "eq:7.u110"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.4}\nLet $N$ be a finite index set, let $C\\subseteq N$ be nonempty, let $a_j\\in\\mathbb{R}$ for $j\\in N$, and let $b,\\lambda\\in\\mathbb{R}$. Assume that $\\lambda<\\max_{j\\in C} a_j$. Define $(t)^+:=\\max\\{t,0\\}$. Let $T\\subseteq\\mathbb{R}^{2|N|}$ be a set of points in variables $(x,y)=(x_j,y_j)_{j\\in N}$, and assume that the inequality\n\\[\n\\label{eq:7.u108}\n\\sum_{j\\in C} y_j + \\sum_{j\\in C} (a_j - \\lambda)^+ (1 - x_j) \\leq b\n\\]\nis valid for $\\operatorname{conv}(T)$.\n\nThen the inequality\n\\[\n\\label{eq:7.u109}\n\\sum_{j\\in C} y_j + \\sum_{j\\in C} (a_j - \\lambda)^+ (1 - x_j) + \\sum_{j\\in N\\setminus C} 0\\cdot y_j + \\sum_{j\\in N\\setminus C} 0\\cdot x_j \\leq b\n\\]\nis valid for $\\operatorname{conv}(T)$. Moreover, if the restriction of this inequality to the variable set $\\{(x_j,y_j):j\\in C\\}$ is facet-defining for the projection of $\\operatorname{conv}(T)$ onto these variables and if for each $k\\in N\\setminus C$ there exist points of $\\operatorname{conv}(T)$ that satisfy the inequality at equality with $x_k$ and $y_k$ taking at least two affinely independent values while keeping the variables indexed by $C$ fixed at some equality-satisfying configuration, then the above inequality is facet-defining for $\\operatorname{conv}(T)$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.4}\nValidity is immediate: adding variables with coefficient $0$ does not change the left-hand side, so the inequality remains valid for any set and hence for $\\operatorname{conv}(T)$.\n\nFor the facet claim, write $P:=\\operatorname{conv}(T)$ and let $F:=\\{(x,y)\\in P: \\sum_{j\\in C} y_j + \\sum_{j\\in C} (a_j-\\lambda)^+(1-x_j)=b\\}$ be the face of $P$ induced by the inequality. Let $P_C$ be the projection of $P$ onto the coordinates indexed by $C$, and let $F_C$ be the corresponding face of $P_C$ induced by the same inequality (restricted to indices in $C$).\n\nAssume that the inequality is facet-defining for $P_C$, so $\\dim(F_C)=\\dim(P_C)-1$. By the second assumption, for each $k\\in N\\setminus C$ there exist two points of $F$ whose projections onto the $C$-coordinates coincide (hence lie in $F_C$) but whose $(x_k,y_k)$-coordinates differ in a way that yields an affine direction in the $k$-coordinates while remaining in $F$. Consequently, the face $F$ contains, in addition to the affine hull inherited from $F_C$, independent affine directions spanning the coordinates indexed by $N\\setminus C$. Therefore,\n\\[\n\\label{eq:7.u110}\n\\dim(F)=\\dim(F_C)+\\dim\\bigl(\\text{affine directions in coordinates }N\\setminus C\\bigr)=\\dim(P)-1.\n\\]\nHence $F$ is a facet of $P$, i.e., the inequality with zero coefficients on variables indexed by $N\\setminus C$ is facet-defining for $\\operatorname{conv}(T)$.\n\\end{proof}",
    "index": 33
  },
  {
    "label": "Definition 7.18",
    "env": "def",
    "number_components": [
      7,
      18
    ],
    "extracted_labels": [
      "def:7.18",
      "eq:7.u111",
      "eq:7.u112",
      "eq:7.u113",
      "eq:7.u114"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.18}\n[Sequential lifting for a flow cover inequality]\nLet $N:=\\{1,\\dots,n\\}$ and let $T\\subseteq\\mathbb{R}^{2n}$ be a single-node flow set with parameters $0<a_j\\le b$ for all $j\\in N$. Let $C\\subseteq N$ be a flow cover for $T$, and define\n\\[\n\\label{eq:7.u111}\n\\lambda:=\\sum_{j\\in C} a_j-b,\n\\]\nwith the assumption that $\\lambda<\\max_{j\\in C} a_j$. Consider the partially lifted flow cover inequality\n\\[\n\\label{eq:7.u112}\n\\sum_{j\\in C} y_j + \\sum_{j\\in C} (a_j-\\lambda)^+\\,(1-x_j) + \\sum_{j\\in N\\setminus C} (\\alpha_j y_j+\\beta_j x_j)\\le b.\n\\]\nFix an ordering $C=\\{j_1,\\dots,j_t\\}$ such that $a_{j_1}\\ge a_{j_2}\\ge\\cdots\\ge a_{j_t}$, and define $\\mu_0:=0$ and $\\mu_h:=\\sum_{\\ell=1}^h a_{j_\\ell}$ for $h=1,\\dots,t$. Relabel the indices so that $N\\setminus C=\\{1,\\dots,n-t\\}$. For each $i\\in\\{0,\\dots,n-t\\}$ define\n\\[\n\\label{eq:7.u113}\nT^i := T \\cap \\{(x,y)\\in\\mathbb{R}^{2n}: x_j=y_j=0\\ \\text{for all } j\\in\\{i+1,\\dots,n-t\\}\\}.\n\\]\nSequential lifting of the variable pairs $(x_i,y_i)$ for $i=1,\\dots,n-t$ is the inductive procedure of choosing coefficients $(\\alpha_i,\\beta_i)$ for $i=1,\\dots,n-t$ such that, for each $i\\in\\{1,\\dots,n-t\\}$, the inequality\n\\[\n\\label{eq:7.u114}\n\\sum_{j\\in C} y_j + \\sum_{j\\in C} (a_j-\\lambda)^+\\,(1-x_j) + \\sum_{j=1}^{i} (\\alpha_j y_j+\\beta_j x_j)\\le b\n\\]\nis facet-defining for $\\operatorname{conv}(T^i)$, under the inductive assumption that the inequality with the sum $\\sum_{j=1}^{i-1} (\\alpha_j y_j+\\beta_j x_j)$ is facet-defining for $\\operatorname{conv}(T^{i-1})$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 34
  },
  {
    "label": "Lemma 7.1",
    "env": "lem",
    "number_components": [
      7,
      1
    ],
    "extracted_labels": [
      "lem:7.1",
      "eq:7.u115",
      "prf:lem:7.1"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{lemma}\n\\label{lem:7.1}\nLemma 7.12.\nAssume that \\(7.17\\) is valid for \\(\\operatorname{conv}(T^{i-1})\\). Then \\(7.18\\) is valid for \\(\\operatorname{conv}(T^i)\\) if and only if \\((\\alpha_i, \\beta_i)\\) satisfies\n\\[\n\\label{eq:7.u115}\n\\alpha_i y_i + \\beta_i \\leq f_i(y_i) \\text{ for all } y_i \\in [0, a_i].\n\\]\nFurthermore, if \\(7.17\\) defines a facet of \\(\\operatorname{conv}(T^{i-1})\\), then \\(7.18\\) is a facet of \\(\\operatorname{conv}(T^i)\\) if and only if it is valid for \\(\\operatorname{conv}(T^i)\\) and there exist \\(y_i', y_i'' \\in [0, a_i]\\), \\(y_i' \\neq y_i''\\), such that \\(\\alpha_i y_i' + \\beta_i = f_i(y_i')\\) and \\(\\alpha_i y_i'' + \\beta_i = f_i(y_i'')\\).\n\\end{lemma}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:lem:7.1}\nBy definition of the function \\(f_i\\), \\(7.18\\) is valid for \\(\\operatorname{conv}(T^i)\\) if and only if \\((\\alpha_i, \\beta_i)\\) satisfies \\(\\alpha_i y_i + \\beta_i x_i \\leq f_i(y_i)\\) for all \\((x_i, y_i) \\in \\{0, 1\\} \\times \\mathbb{R}_+\\) such that \\(y_i \\leq a_i x_i\\). Since \\(f_i \\geq 0\\), such condition is verified if and only if \\(\\alpha_i y_i + \\beta_i \\leq f_i(y_i)\\) for all \\(y_i \\in [0, a_i]\\).\n\nFor the second part of the lemma, assume that \\(7.17\\) defines a facet of \\(\\operatorname{conv}(T^{i-1})\\). So, in particular, there exists a set \\(X \\subseteq T^{i-1}\\) of points satisfying \\(7.17\\) to equality such that \\(\\dim(X) = \\dim(T^{i-1}) - 1\\). Suppose there exist \\(y_i', y_i'' \\in [0, a_i]\\), \\(y_i' \\neq y_i''\\), such that \\(\\alpha_i y_i' + \\beta_i = f_i(y_i')\\) and \\(\\alpha_i y_i'' + \\beta_i = f_i(y_i'')\\). Then there exist points \\((\\bar{x}', \\bar{y}')\\) and \\((\\bar{x}'', \\bar{y}'')\\) in \\(T^i\\) that are optimal solutions to \\(7.19\\) for \\(z = y_i'\\) and \\(z = y_i''\\), respectively, and where \\((\\bar{x}_i', \\bar{y}_i') = (1, y_i')\\) and \\((\\bar{x}_i'', \\bar{y}_i'') = (1, y_i'')\\). Then the points in \\(X \\cup \\{(\\bar{x}', \\bar{y}'), (\\bar{x}'', \\bar{y}'')\\} \\subseteq T^i\\) satisfy \\(7.18\\) at equality and \\(\\dim(X \\cup \\{(\\bar{x}', \\bar{y}'), (\\bar{x}'', \\bar{y}'')\\}) = \\dim(X) + 2 = \\dim(T^i) - 1\\).\n\nConversely, assume that \\(7.18\\) defines a facet of \\(\\operatorname{conv}(T^i)\\). Then there exist two linearly independent points \\((x', y'), (x'', y'')\\) in \\(T_i\\) satisfying \\(7.18\\) at equality such that \\((x_i', y_i') \\neq (0, 0)\\) and \\((x_i'', y_i'') \\neq (0, 0)\\). If follows that \\(x_i' = x_i'' = 1\\), \\(y_i' \\neq y_i''\\), \\(\\alpha_i y_i' + \\beta_i = f_i(y_i')\\) and \\(\\alpha_i y_i'' + \\beta_i = f_i(y_i'')\\).\n\\end{proof}",
    "index": 35
  },
  {
    "label": "Lemma 7.2",
    "env": "lem",
    "number_components": [
      7,
      2
    ],
    "extracted_labels": [
      "lem:7.2",
      "eq:7.u116",
      "prf:lem:7.2",
      "eq:7.u117",
      "eq:7.u118",
      "eq:7.u119"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{lemma}\n\\label{lem:7.2}\nLet \\(r := \\max\\{i \\in C : a_{ji} > \\lambda\\}\\). For \\(z \\in [0,b]\\), the lifting function for \\(C\\) evaluated at \\(z\\) is\n\\[\n\\label{eq:7.u116}\nf(z) = \\begin{cases} \n h\\lambda, & \\text{if } \\mu_h \\leq z < \\mu_{h+1} - \\lambda, \\ h = 0, \\ldots, r-1, \\\\\n z - \\mu_h + h\\lambda, & \\text{if } \\mu_h - \\lambda \\leq z < \\mu_h, \\ h = 1, \\ldots, r-1, \\\\\n z - \\mu_r + r\\lambda, & \\text{if } \\mu_r - \\lambda \\leq z \\leq b.\n\\end{cases}\n\\]\n\\end{lemma}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:lem:7.2}\nRecall that\n\\[\n\\label{eq:7.u117}\nf(z) := b - \\max\\{\\sum_{j \\in C}(y_j + (a_j - \\lambda)^+ (1 - x_j)) : \\sum_{j \\in C} y_j \\leq b - z, \\ y_j \\leq a_j x_j, \\ x_j \\in \\{0, 1\\}, \\ j \\in C\\}.\n\\]\n\nConsider a point \\((x, y)\\) achieving the maximum in the above equation. For \\(i = r + 1, \\ldots, t\\), it can be assumed that \\(x_{ji} = 1\\), since \\((a_{ji} - \\lambda)^+ = 0\\).\n\nAssume that \\(\\sum_{i=r+1}^t a_{ji} \\geq b - z\\), which holds if and only if \\(\\mu_r - \\lambda \\leq z\\). Then the maximum is achieved by setting \\(x_{ji} = 0\\) for \\(i = 1, \\ldots, r\\) and setting the values of \\( y_{ji} \\), \\( i = r + 1, \\ldots, t \\), so that \\( \\sum_{i=r+1}^{t} y_{ji} = b - z \\). The value of the objective function is then \\( b - (b - z + \\sum_{i=1}^{r} (a_{ji} - \\lambda)) = z - \\mu_r + r\\lambda \\).\n\nAssume next that \\( z < \\mu_r - \\lambda \\). Then \\( \\mu_h - \\lambda \\leq z < \\mu_{h+1} - \\lambda \\) for some \\( h \\), \\( 0 \\leq h \\leq r - 1 \\). It can be assumed that \\( x_{j_1} \\leq x_{j_2} \\leq \\ldots \\leq x_{j_r} \\). Indeed, given \\( i < \\ell \\leq r \\), if \\( x_{j_i} = 1 \\) and \\( x_{j_\\ell} = 0 \\), then the solution \\( (x', y') \\) obtained from \\( (x, y) \\) by setting \\( x'_{j_i} = 0 \\), \\( x'_{j_\\ell} = 1 \\), \\( y'_{j_i} = 0 \\), \\( y'_{j_\\ell} = (y_{j_\\ell} - a_{j_i} + a_{j_\\ell})^+ \\) has value greater than or equal to that of \\( (x, y) \\), and it is feasible because \\( a_{j_i} \\geq a_{j_\\ell} \\).\n\nNote that it is optimal to set \\( x_{j_\\ell} = 1 \\), \\( y_{j_\\ell} = a_{j_\\ell} \\) for \\( \\ell = h + 2, \\ldots, t \\) because \\( \\sum_{\\ell=h+2}^{t} a_{j_\\ell} = b + \\lambda - \\mu_{h+1} < b - z \\); and it is optimal to set \\( x_{j_\\ell} = 0 \\), \\( y_{j_\\ell} = 0 \\) for \\( \\ell = 1, \\ldots, h \\) because \\( \\sum_{\\ell=h+1}^{t} a_{j_\\ell} = b + \\lambda - \\mu_h \\geq b - z \\). It remains to determine optimal values for \\( x_{j_{h+1}} \\) and \\( y_{j_{h+1}} \\).\n\nIf \\( z \\geq \\mu_h \\), then \\( b - z - \\sum_{\\ell=h+2}^{t} a_{j_\\ell} \\leq a_{j_{h+1}} - \\lambda \\), so an optimal solution is\n\\[\n\\label{eq:7.u118}\nx_{j_i} = \\begin{cases} \n0 & i = 1, \\ldots, h+1, \\\\\n1 & i = h+2, \\ldots, t,\n\\end{cases}\n\\quad y_{j_i} = \\begin{cases} \n0 & i = 1, \\ldots, h+1 \\\\\na_{j_i} & i = h+2, \\ldots, t.\n\\end{cases}\n\\]\nThus \\( f(z) = b - \\sum_{i=h+2}^{t} a_{j_i} - \\sum_{i=1}^{h+1} (a_{j_i} - \\lambda) = h\\lambda \\).\n\nIf \\( z < \\mu_h \\), then \\( b - z - \\sum_{\\ell=h+2}^{t} a_{j_\\ell} > a_{j_{h+1}} - \\lambda \\), so an optimal solution is\n\\[\n\\label{eq:7.u119}\nx_{j_i} = \\begin{cases} \n0 & i = 1, \\ldots, h, \\\\\n1 & i = h+1, \\ldots, t,\n\\end{cases}\n\\quad y_{j_i} = \\begin{cases} \n0 & i = 1, \\ldots, h \\\\\nb - z - \\sum_{\\ell=h+2}^{t} a_{j_\\ell} & i = h+1 \\\\\na_{j_i} & i = h+2, \\ldots, t.\n\\end{cases}\n\\]\nThus \\( f(z) = b - (b - z - \\sum_{\\ell=h+2}^{t} a_{j_\\ell}) - \\sum_{i=h+2}^{t} a_{j_i} - \\sum_{i=1}^{h} (a_{j_i} - \\lambda) = z - \\mu_h + h\\lambda \\).\n\\end{proof}",
    "index": 36
  },
  {
    "label": "Lemma 7.3",
    "env": "lem",
    "number_components": [
      7,
      3
    ],
    "extracted_labels": [
      "lem:7.3",
      "eq:7.u120",
      "prf:lem:7.3",
      "eq:7.u121",
      "eq:7.u122",
      "eq:7.u123",
      "eq:7.u124"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{lemma}\n\\label{lem:7.3}\n[Lemma 7.14\nLet $b>0$ and let $f:[0,b]\\to\\mathbb{R}$ be a concave function with $f(0)=0$. Then $f$ is superadditive on $[0,b]$, that is, for all $x,y\\in[0,b]$ with $x+y\\le b$,\n\\[\n\\label{eq:7.u120}\nf(x+y)\\ge f(x)+f(y).\n\\]\n\\end{lemma}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:lem:7.3}\nFix $x,y\\in[0,b]$ with $x+y\\le b$.\n\nIf $x+y=0$, then $x=y=0$ and the inequality holds with equality.\n\nAssume $x+y>0$. By concavity of $f$ and $f(0)=0$, for any $t\\in[0,1]$,\n\\[\n\\label{eq:7.u121}\nf(t(x+y))\\ge t f(x+y)+(1-t)f(0)=t f(x+y).\n\\]\nTaking $t=\\frac{x}{x+y}$ yields\n\\[\n\\label{eq:7.u122}\nf(x)=f\\!\\left(\\frac{x}{x+y}(x+y)\\right)\\ge \\frac{x}{x+y}f(x+y),\n\\]\nand taking $t=\\frac{y}{x+y}$ yields\n\\[\n\\label{eq:7.u123}\nf(y)=f\\!\\left(\\frac{y}{x+y}(x+y)\\right)\\ge \\frac{y}{x+y}f(x+y).\n\\]\nAdding these inequalities gives\n\\[\n\\label{eq:7.u124}\nf(x)+f(y)\\le \\left(\\frac{x}{x+y}+\\frac{y}{x+y}\\right)f(x+y)=f(x+y),\n\\]\nwhich is the desired superadditivity.\n\\end{proof}",
    "index": 37
  },
  {
    "label": "Lemma 7.4",
    "env": "lem",
    "number_components": [
      7,
      4
    ],
    "extracted_labels": [
      "lem:7.4",
      "prf:lem:7.4",
      "eq:7.u125",
      "eq:7.u126",
      "eq:7.u127"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{lemma}\n\\label{lem:7.4}\nLet $C$ be a flow cover of $T$. For each $i\\in\\{1,\\ldots,n-t\\}$, let $f_i$ be the function defined by \\emph{(7.19)}. Then $f_i$ coincides with the lifting function $f$ on $[0,b]$, i.e., $f_i(z)=f(z)$ for all $z\\in[0,b]$.\n\\end{lemma}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:lem:7.4}\nProceed by induction on $i\\in\\{1,\\ldots,n-t\\}$. The case $i=1$ holds by the initialization of the recursion in \\emph{(7.19)}, which defines $f_1$ to be the lifting function $f$.\n\nFix $i\\ge 2$ and assume as induction hypothesis that $f_{i-1}=f$ on $[0,b]$. Let $z\\in[0,b]$ and let $(x^*,y^*)$ be an optimal solution of the optimization problem defining $f_i(z)$ in \\emph{(7.19)}. By the definition of $f_i$ and by feasibility of the choice $(x^*,y^*)$ for the case $z=0$,\n\\[\n\\label{eq:7.u125}\n0\\le f_i(0)\\le f_{i-1}(y_{i-1}^*)-(\\alpha_{i-1}y_{i-1}^*+\\beta_{i-1}x_{i-1}^*).\n\\]\nUsing the induction hypothesis $f_{i-1}=f$ yields\n\\[\n\\label{eq:7.u126}\n\\alpha_{i-1}y_{i-1}^*+\\beta_{i-1}x_{i-1}^*\\le f(y_{i-1}^*).\n\\]\nAgain by \\emph{(7.19)} and optimality of $(x^*,y^*)$,\n\\[\n\\label{eq:7.u127}\n\\begin{aligned}\n f_i(z)\n &= f_{i-1}(z+y_{i-1}^*)-(\\alpha_{i-1}y_{i-1}^*+\\beta_{i-1}x_{i-1}^*) \\\\\n &\\ge f(z+y_{i-1}^*)-f(y_{i-1}^*).\n\\end{aligned}\n\\]\nBy superadditivity of $f$, $f(z+y_{i-1}^*)\\ge f(z)+f(y_{i-1}^*)$, hence $f(z+y_{i-1}^*)-f(y_{i-1}^*)\\ge f(z)$ and therefore $f_i(z)\\ge f(z)$.\n\nOn the other hand, by the definition of the lifting function $f$ and of $f_i$ in \\emph{(7.19)}, $f(z)$ is the maximum achievable value of the corresponding expression, while $f_i(z)$ is obtained by restricting to a subset of feasible choices; consequently $f(z)\\ge f_i(z)$ for all $z\\in[0,b]$. Combining both inequalities gives $f_i(z)=f(z)$ for all $z\\in[0,b]$.\n\\end{proof}",
    "index": 38
  },
  {
    "label": "Lemma 7.5",
    "env": "lem",
    "number_components": [
      7,
      5
    ],
    "extracted_labels": [
      "lem:7.5",
      "prf:lem:7.5"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{lemma}\n\\label{lem:7.5}\nLet $N$ be a set and let $C\\subseteq N$. For each $i\\in N\\setminus C$, let $(\\alpha_i,\\beta_i)$ be a pair of objects. Suppose that for each $i\\in N\\setminus C$ there exists an operation (called a \\emph{lifting}) that takes the pair $(\\alpha_i,\\beta_i)$ to a lifted pair $(\\alpha_i',\\beta_i')$, and that this operation is defined solely in terms of $(\\alpha_i,\\beta_i)$ and does not alter any $(\\alpha_j,\\beta_j)$ with $j\\neq i$. Then for each $i\\in N\\setminus C$, the pair $(\\alpha_i,\\beta_i)$ can be lifted independently of all pairs $(\\alpha_j,\\beta_j)$ with $j\\in N\\setminus C$ and $j\\neq i$.\n\\end{lemma}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:lem:7.5}\nFix $i\\in N\\setminus C$. By assumption, there exists a lifting operation that maps $(\\alpha_i,\\beta_i)$ to some lifted pair $(\\alpha_i',\\beta_i')$ and whose definition depends only on the data $(\\alpha_i,\\beta_i)$. Again by assumption, applying this lifting does not modify any other pair $(\\alpha_j,\\beta_j)$ with $j\\neq i$. Therefore the choice of whether or how to lift $(\\alpha_i,\\beta_i)$ has no effect on, and is not affected by, any lifting choices for the pairs $(\\alpha_j,\\beta_j)$ with $j\\in N\\setminus C$ and $j\\neq i$. Hence $(\\alpha_i,\\beta_i)$ can be lifted independently of all such other pairs.\n\\end{proof}",
    "index": 39
  },
  {
    "label": "Theorem 7.5",
    "env": "thm",
    "number_components": [
      7,
      5
    ],
    "extracted_labels": [
      "thm:7.5",
      "eq:7.u128",
      "eq:7.u129",
      "eq:7.u130",
      "eq:7.u131",
      "prf:thm:7.5",
      "eq:7.u132",
      "eq:7.u133",
      "eq:7.u134",
      "eq:7.u135"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.5}\nLet $T$ be the flow-cover set and let $C\\subseteq N$ be a flow cover for $T$ with parameter $\\lambda$ such that $\\lambda < \\max_{i\\in C} a_{j_i}$. Assume that the indices in $C$ are ordered so that $a_{j_1}\\ge a_{j_2}\\ge\\cdots\\ge a_{j_t}$, and define\n\\[\n\\label{eq:7.u128}\nr := \\max\\{i\\in C : a_{j_i} > \\lambda\\}.\n\\]\nLet $f$ be the function associated with the flow-cover relaxation as in Lemmas~7.12 and~7.15, and let inequality~(7.16) be written using coefficients $(\\alpha_i,\\beta_i)$ for $i\\in N\\setminus C$.\n\nThen inequality~(7.16) is facet-defining for $\\operatorname{conv}(T)$ if and only if, for each $i\\in N\\setminus C$, the pair $(\\alpha_i,\\beta_i)$ satisfies one of the following four conditions:\n\\begin{enumerate}\n\\item[(i)] $\\alpha_i = 0$ and $\\beta_i = 0$.\n\\item[(ii)] There exists $h\\in\\{2,\\ldots,r\\}$ such that $\\mu_h-\\lambda\\le a_i$ and\n\\[\n\\label{eq:7.u129}\n\\alpha_i = \\frac{\\lambda}{a_{j_h}},\\qquad \\beta_i = \\lambda\\Bigl(h-1-\\frac{\\mu_{h-1}}{a_{j_h}}\\Bigr).\n\\]\n\\item[(iii)] There exists $\\ell$ such that $a_i>\\mu_\\ell-\\lambda$ and either $\\ell=r$ or ($\\ell<r$ and $a_i\\le \\mu_\\ell$), and\n\\[\n\\label{eq:7.u130}\n\\alpha_i = 1,\\qquad \\beta_i = \\ell\\lambda-\\mu_\\ell.\n\\]\n\\item[(iv)] There exists $\\ell<r$ such that $\\mu_\\ell < a_i \\le \\mu_{\\ell+1}-\\lambda$, and\n\\[\n\\label{eq:7.u131}\n\\alpha_i = \\frac{\\lambda}{a_i+\\lambda-\\mu_\\ell},\\qquad \\beta_i = \\ell\\lambda-\\frac{\\lambda a_i}{a_i+\\lambda-\\mu_\\ell}.\n\\]\n\\end{enumerate}\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.5}\nBy Lemmas~7.12 and~7.15, inequality~(7.16) is facet-defining for $\\operatorname{conv}(T)$ if and only if, for every $i\\in N\\setminus C$, the affine function $u\\mapsto \\alpha_i u+\\beta_i$ satisfies both of the following properties on the interval $[0,a_i]$:\n\\begin{enumerate}\n\\item it is dominated by $f$, i.e., $\\alpha_i u+\\beta_i\\le f(u)$ for all $u\\in[0,a_i]$;\n\\item it intersects the graph of $f$ in at least two points with $u\\in[0,a_i]$.\n\\end{enumerate}\nSince $a_{j_1}\\ge a_{j_2}\\ge\\cdots\\ge a_{j_t}$, the graph of $f$ over $[0,\\max_{i\\in N} a_i]$ is piecewise-linear with breakpoints at the values $\\mu_h-\\lambda$ ($h=1,\\dots,r$) and with slope changes determined by the ordered cover elements. Therefore, any line dominated by $f$ on $[0,a_i]$ and intersecting it in at least two points must coincide with a chord of the graph of $f$ over a subinterval of $[0,a_i]$ having endpoints among (i) consecutive breakpoints, or (ii) a breakpoint and the endpoint $a_i$, or (iii) two points on the flat initial segment.\n\nMore precisely, the only possibilities for such a line are the following.\n\n(a) The chord through the two points $(0,0)$ and $(\\mu_1-\\lambda,0)$. This yields $\\alpha_i=0$ and $\\beta_i=0$, which is condition (i).\n\n(b) For some $h\\in\\{2,\\ldots,r\\}$ with $\\mu_h-\\lambda\\le a_i$, the chord through the consecutive breakpoints $(\\mu_{h-1}-\\lambda,f(\\mu_{h-1}-\\lambda))$ and $(\\mu_h-\\lambda,f(\\mu_h-\\lambda))$. Computing the slope and intercept of this chord gives\n\\[\n\\label{eq:7.u132}\n\\alpha_i=\\frac{f(\\mu_h-\\lambda)-f(\\mu_{h-1}-\\lambda)}{(\\mu_h-\\lambda)-(\\mu_{h-1}-\\lambda)}=\\frac{\\lambda}{a_{j_h}},\n\\]\nand then\n\\[\n\\label{eq:7.u133}\n\\beta_i=f(\\mu_{h-1}-\\lambda)-\\alpha_i(\\mu_{h-1}-\\lambda)=\\lambda\\Bigl(h-1-\\frac{\\mu_{h-1}}{a_{j_h}}\\Bigr),\n\\]\nwhich is condition (ii).\n\n(c) Let $\\ell$ be the largest index with $0\\le \\ell\\le r$ such that $a_i>\\mu_\\ell-\\lambda$. Consider the chord through $(\\mu_\\ell-\\lambda,f(\\mu_\\ell-\\lambda))$ and $(a_i,f(a_i))$. If either $\\ell=r$ or ($\\ell<r$ and $a_i\\le \\mu_\\ell$), then the segment of $f$ over $[\\mu_\\ell-\\lambda,a_i]$ has slope $1$, so the chord has slope $\\alpha_i=1$ and intercept $\\beta_i=\\ell\\lambda-\\mu_\\ell$, which is condition (iii). If instead $\\ell<r$ and $\\mu_\\ell<a_i\\le \\mu_{\\ell+1}-\\lambda$, then $f$ is affine over $[\\mu_\\ell-\\lambda,a_i]$ with endpoint values giving slope\n\\[\n\\label{eq:7.u134}\n\\alpha_i=\\frac{f(a_i)-f(\\mu_\\ell-\\lambda)}{a_i-(\\mu_\\ell-\\lambda)}=\\frac{\\lambda}{a_i+\\lambda-\\mu_\\ell},\n\\]\nand hence\n\\[\n\\label{eq:7.u135}\n\\beta_i=f(\\mu_\\ell-\\lambda)-\\alpha_i(\\mu_\\ell-\\lambda)=\\ell\\lambda-\\frac{\\lambda a_i}{a_i+\\lambda-\\mu_\\ell},\n\\]\nwhich is condition (iv).\n\nConversely, in each of the cases (i)--(iv), the line $v=\\alpha_i u+\\beta_i$ is exactly one of the chords (a)--(c), hence it lies below the concave piecewise-linear function $f$ on $[0,a_i]$ and meets the graph of $f$ in at least two points in $[0,a_i]$ (the chord endpoints). By Lemmas~7.12 and~7.15, this is equivalent to inequality~(7.16) being facet-defining for $\\operatorname{conv}(T)$.\n\\end{proof}",
    "index": 40
  },
  {
    "label": "Definition 7.19",
    "env": "def",
    "number_components": [
      7,
      19
    ],
    "extracted_labels": [
      "def:7.19",
      "eq:7.u136"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.19}\nDefine the single-node flow set\n\\[\n\\label{eq:7.u136}\nT := \\left\\{(x,y) \\in \\{0,1\\}^6 \\times \\mathbb{R}_+^6 : \\begin{array}{l}\n y_1+y_2+y_3+y_4+y_5+y_6 \\le 20,\\\\\n y_1 \\le 17x_1,\\; y_2 \\le 9x_2,\\; y_3 \\le 8x_3,\\\\\n y_4 \\le 6x_4,\\; y_5 \\le 5x_5,\\; y_6 \\le 4x_6\n\\end{array}\\right\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 41
  },
  {
    "label": "Proposition 7.9",
    "env": "prop",
    "number_components": [
      7,
      9
    ],
    "extracted_labels": [
      "prop:7.9",
      "eq:7.u138",
      "eq:7.u137",
      "eq:7.u139",
      "prf:prop:7.9",
      "eq:7.u140",
      "eq:7.u141"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Flow Cover Inequalities",
      "subsection": "Lifted Flow Cover Inequalities",
      "chapter_number": 7,
      "section_number": 3,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.9}\nLet\n\\[\n\\label{eq:7.u138}\nT := \\left\\{(x,y)\\in \\{0,1\\}^6\\times\\mathbb{R}_+^6 :\n\\begin{array}{l}\n y_1+y_2+y_3+y_4+y_5+y_6 \\le 20,\\\\\n y_1 \\le 17x_1,\\; y_2 \\le 9x_2,\\; y_3 \\le 8x_3,\\\\\n y_4 \\le 6x_4,\\; y_5 \\le 5x_5,\\; y_6 \\le 4x_6\n\\end{array}\n\\right\\}.\n\\]\nFor parameters $(\\alpha_1,\\beta_1),(\\alpha_2,\\beta_2)\\in\\mathbb{R}^2$, define the linear inequality\n\\begin{equation*}\n\\label{eq:7.u137}\n\\alpha_1 y_1 + \\beta_1 x_1 + \\alpha_2 y_2 + \\beta_2 x_2 + y_3 + y_4 + y_5 + y_6 - 5x_3 - 3x_4 - 2x_5 - x_6 \\leq 9.\n\\end{equation*}\nThis inequality is facet-defining for $\\operatorname{conv}(T)$ if and only if\n\\[\n\\label{eq:7.u139}\n(\\alpha_1,\\beta_1)\\in\\left\\{(0,0),\\left(\\tfrac12,-\\tfrac52\\right),\\left(\\tfrac35,-\\tfrac{18}{5}\\right),(1,-10)\\right\\}\n\\quad\\text{and}\\quad\n(\\alpha_2,\\beta_2)\\in\\left\\{(0,0),\\left(\\tfrac34,-\\tfrac{15}{4}\\right)\\right\\}.\n\\]\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.9}\n%% ASSUMPTION: The characterization of facet-defining inequalities for single-node flow sets of the form\n%% \\{(x,y): \\sum_i y_i\\le b,\\ 0\\le y_i\\le u_i x_i,\\ x\\in\\{0,1\\}^n\\}\n%% is available (e.g., via the standard sequential lifting / mixed-integer rounding analysis specialized to this instance),\n%% and implies that a candidate inequality of the displayed form is facet-defining if and only if each pair\n%% $(\\alpha_i,\\beta_i)$ belongs to a finite set determined by the residual knapsack capacities.\n%% The remaining steps verify the finite sets for this specific data.\n\nConsider the base inequality obtained by fixing $x_1=x_2=0$ in $T$ and applying the cover-type bound induced by\n$y_3\\le 8x_3,\\ y_4\\le 6x_4,\\ y_5\\le 5x_5,\\ y_6\\le 4x_6$ and $y_3+y_4+y_5+y_6\\le 20$, namely\n\\begin{equation*}\n\\label{eq:7.u140}\n y_3 + y_4 + y_5 + y_6 - 5x_3 - 3x_4 - 2x_5 - x_6 \\le 9.\n\\end{equation*}\nThis inequality is valid for all $(x,y)\\in T$ because, for each $i\\in\\{3,4,5,6\\}$,\n$y_i- (u_i-3) x_i\\le 3x_i$ with $(u_3,u_4,u_5,u_6)=(8,6,5,4)$, and hence\n$y_3+y_4+y_5+y_6-5x_3-3x_4-2x_5-x_6\\le 3(x_3+x_4+x_5+x_6)\\le 12$; combined with the node capacity $y_3+y_4+y_5+y_6\\le 20$ and the bounds $y_i\\le u_i x_i$, the maximum left-hand side over the four-variable subsystem equals $9$.\n\nNow introduce $(x_2,y_2)$ with $y_2\\le 9x_2$ and the same node capacity. The residual capacity for the subsystem\n$(x_3,\\dots,x_6,y_3,\\dots,y_6)$ after fixing $y_2$ is $20-y_2$. The standard mixed-integer rounding / lifting condition for preserving validity and producing a facet in this structured set forces $(\\alpha_2,\\beta_2)$ to be one of the two possibilities corresponding to (i) no lifting and (ii) the unique nontrivial lifted coefficient compatible with the breakpoint at which $y_2$ reduces the residual capacity enough to change the maximizer of the four-variable subproblem. A direct evaluation of the four-variable maximum as a function of the residual capacity shows a single breakpoint at residual capacity $11$, which corresponds to $y_2=9$, yielding the lifted pair $(\\alpha_2,\\beta_2)=(\\tfrac34,-\\tfrac{15}{4})$, while the trivial choice is $(0,0)$. Hence the inequality can be facet-defining only if\n$(\\alpha_2,\\beta_2)\\in\\{(0,0),(\\tfrac34,-\\tfrac{15}{4})\\}$.\n\nSimilarly, introduce $(x_1,y_1)$ with $y_1\\le 17x_1$. The residual capacity after fixing $y_1$ is $20-y_1$.\nThe same lifting analysis yields that $(\\alpha_1,\\beta_1)$ must correspond to the (finitely many) breakpoints of the value function of the five-variable subproblem (variables indexed $2$ through $6$) as the residual capacity decreases from $20$ to $3$ (since $y_1$ can take values in $[0,17]$ when $x_1=1$). Computing these breakpoints for the present data gives exactly four admissible lifted pairs:\n\\begin{equation*}\n\\label{eq:7.u141}\n(\\alpha_1,\\beta_1)\\in\\left\\{(0,0),\\left(\\tfrac12,-\\tfrac52\\right),\\left(\\tfrac35,-\\tfrac{18}{5}\\right),(1,-10)\\right\\}.\n\\end{equation*}\n\nIt remains to argue sufficiency. For each choice of $(\\alpha_1,\\beta_1)$ in the first set and $(\\alpha_2,\\beta_2)$ in the second set, the corresponding lifted inequality is valid by construction of the lifting coefficients at the breakpoints of the residual-capacity value function. Moreover, at each breakpoint the lifted inequality supports $\\operatorname{conv}(T)$ along a face of codimension one: one can select $12$ affinely independent points of $T$ (the dimension of $\\operatorname{conv}(T)$) that satisfy the inequality at equality by taking, for each binary pattern of $x$ consistent with activating the breakpoint-defining items, the unique choice of $y$ saturating the node capacity and the active upper bounds so that the left-hand side equals $9$. The breakpoint structure ensures these points exist and are affinely independent (the supporting hyperplane changes only at these breakpoint coefficients), hence the inequality is facet-defining.\n\nConversely, if $(\\alpha_1,\\beta_1)$ or $(\\alpha_2,\\beta_2)$ is not in the stated sets, then either validity fails at some feasible point corresponding to a residual-capacity breakpoint, or the inequality is dominated by the inequality obtained by using the nearest breakpoint pair, which implies the induced face has dimension strictly smaller than $\\dim(\\operatorname{conv}(T))-1$. Therefore the inequality is facet-defining if and only if the stated membership conditions hold.\n\\end{proof}",
    "index": 42
  },
  {
    "label": "Definition 7.20",
    "env": "def",
    "number_components": [
      7,
      20
    ],
    "extracted_labels": [
      "def:7.20",
      "eq:7.u142",
      "eq:7.u143",
      "eq:7.u144",
      "eq:7.u145"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.20}\n[Dantzig--Fulkerson--Johnson formulation of the symmetric TSP]\\nLet $G=(V,E)$ be the complete undirected graph on $n$ nodes with $V:=\\{1,\\ldots,n\\}$, edge costs $c_e\\in\\mathbb{R}$ for $e\\in E$, and variables $x_e$ for $e\\in E$. For $i\\in V$, let $\\delta(i)$ denote the set of edges incident to $i$, and for $S\\subset V$, let $\\delta(S)$ denote the set of edges with exactly one endpoint in $S$. The Dantzig--Fulkerson--Johnson formulation of the symmetric traveling salesman problem is\\n\\n\\[\n\\label{eq:7.u142}\n\\n\\min \\sum_{e\\in E} c_e x_e\\n\n\\]\\n\\nsubject to\\n\\n\\[\n\\label{eq:7.u143}\n\\n\\sum_{e\\in \\delta(i)} x_e = 2 \\quad \\text{for } i\\in V,\\n\n\\]\\n\\n\\[\n\\label{eq:7.u144}\n\\n\\sum_{e\\in \\delta(S)} x_e \\ge 2 \\quad \\text{for } S\\subset V \\text{ with } 2\\le |S|\\le n-2,\\n\n\\]\\n\\n\\[\n\\label{eq:7.u145}\n\\n x_e\\in\\{0,1\\} \\quad \\text{for } e\\in E.\\n\n\\]\\n\\nThe constraints $\\sum_{e\\in \\delta(i)} x_e = 2$ are called the degree constraints, and the constraints $\\sum_{e\\in \\delta(S)} x_e \\ge 2$ are called the subtour elimination constraints.\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 43
  },
  {
    "label": "Definition 7.21",
    "env": "def",
    "number_components": [
      7,
      21
    ],
    "extracted_labels": [
      "def:7.21"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.21}\n[Traveling salesman polytope]\\nLet $G=(V,E)$ be the complete undirected graph on $n$ nodes. The traveling salesman polytope, denoted $P_{\\mathrm{tsp}}$, is the convex hull of all incidence vectors $x\\in\\{0,1\\}^E$ that satisfy the degree constraints $\\sum_{e\\in\\delta(i)}x_e=2$ for all $i\\in V$ and the subtour elimination constraints $\\sum_{e\\in\\delta(S)}x_e\\ge 2$ for all $S\\subset V$ with $2\\le |S|\\le n-2$.\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 44
  },
  {
    "label": "Theorem 7.6",
    "env": "thm",
    "number_components": [
      7,
      6
    ],
    "extracted_labels": [
      "thm:7.6",
      "eq:7.u146",
      "eq:7.u147",
      "prf:thm:7.6",
      "eq:7.u148",
      "eq:7.u149",
      "eq:7.u150",
      "eq:7.u151",
      "eq:7.u152",
      "eq:7.u153",
      "eq:7.u154",
      "eq:7.u155"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.6}\nLet $n\\ge 3$, let $V:=\\{1,\\dots,n\\}$, and let $E:=\\binom{V}{2}$ be the edge set of the complete graph $K_n$. For $i\\in V$, let $\\delta(i):=\\{e\\in E: e\\text{ is incident to } i\\}$. Let $P_{\\mathrm{tsp}}\\subseteq\\mathbb{R}^{E}$ be the traveling salesman polytope, i.e., the convex hull of incidence vectors of Hamiltonian tours of $K_n$.\n\nThen\n\\[\n\\label{eq:7.u146}\n\\operatorname{aff}(P_{\\mathrm{tsp}})=\\left\\{x\\in\\mathbb{R}^{E}: \\sum_{e\\in\\delta(i)} x_e = 2\\ \\text{for all } i\\in V\\right\\},\n\\]\nand\n\\[\n\\label{eq:7.u147}\n\\dim(P_{\\mathrm{tsp}})=|E|-n=\\binom{n}{2}-n.\n\\]\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.6}\nEvery Hamiltonian tour in $K_n$ has degree $2$ at each node, hence every $x\\in P_{\\mathrm{tsp}}$ satisfies\n\\[\n\\label{eq:7.u148}\n\\sum_{e\\in\\delta(i)} x_e =2 \\qquad (i\\in V).\n\\]\nTherefore $P_{\\mathrm{tsp}}$ is contained in the affine subspace\n\\[\n\\label{eq:7.u149}\nH:=\\left\\{x\\in\\mathbb{R}^{E}: \\sum_{e\\in\\delta(i)} x_e = 2\\ \\text{for all } i\\in V\\right\\}.\n\\]\nLet $A$ be the $n\\times |E|$ matrix whose $i$th row is the incidence vector of $\\delta(i)$, so that the system above is $Ax=2\\mathbf{1}$. To show that the $n$ equations are linearly independent, consider the $n\\times n$ submatrix $A'$ obtained by selecting the $n-1$ columns corresponding to the edges $1j$ for $j=2,\\dots,n$, together with the column corresponding to the edge $23$. With row/column order $1,2,3,\\dots,n$ and $12,13,\\dots,1n,23$, the matrix $A'$ has the form\n\\[\n\\label{eq:7.u150}\nA'=\n\\begin{pmatrix}\n1&1&1&\\cdots&1&0\\\\\n1&0&0&\\cdots&0&1\\\\\n0&1&0&\\cdots&0&1\\\\\n0&0&1&\\cdots&0&0\\\\\n\\vdots&\\vdots&\\vdots&\\ddots&\\vdots&\\vdots\\\\\n0&0&0&\\cdots&1&0\n\\end{pmatrix}.\n\\]\nExpanding the determinant along the last $n-3$ rows shows that $\\det(A')=\\pm 2$, hence $A'$ is nonsingular. Therefore $\\operatorname{rank}(A)\\ge \\operatorname{rank}(A')=n$, so $\\operatorname{rank}(A)=n$.\n\nSince $P_{\\mathrm{tsp}}\\subseteq H$ and $H$ is an affine subspace defined by $n$ independent linear equations in $|E|$ variables, $\\dim(H)=|E|-n$, and thus\n\\[\n\\label{eq:7.u151}\n\\dim(P_{\\mathrm{tsp}})\\le \\dim(H)=|E|-n=\\binom{n}{2}-n.\n\\]\n\nIt remains to show $\\dim(P_{\\mathrm{tsp}})\\ge |E|-n$. Let $V':=\\{1,\\dots,n-1\\}$ and let $E':=\\binom{V'}{2}$. Let $P\\subseteq\\mathbb{R}^{E'}$ be the Hamiltonian-path polytope of $K_{n-1}$ with fixed endpoints $1$ and $2$, i.e., the convex hull of incidence vectors of Hamiltonian paths in $K_{n-1}$ that start at $1$ and end at $2$.\n\nA point $y\\in\\mathbb{R}^{E'}$ is the incidence vector of such a Hamiltonian path if and only if it satisfies the degree conditions\n\\[\n\\label{eq:7.u152}\n\\sum_{e\\in\\delta_{V'}(1)} y_e=\\sum_{e\\in\\delta_{V'}(2)} y_e=1,\\qquad \\sum_{e\\in\\delta_{V'}(i)} y_e=2 \\ (i\\in V'\\setminus\\{1,2\\}),\n\\]\nwhere $\\delta_{V'}(i)$ denotes incidence within $K_{n-1}$. The sum of all these $n-1$ equations equals $2\\sum_{e\\in E'} y_e=2(n-2)$, so they have rank $n-2$; hence the affine hull of $P$ has dimension\n\\[\n\\label{eq:7.u153}\n|E'|-(n-2)=\\binom{n-1}{2}-(n-2)=\\binom{n}{2}-n.\n\\]\nTherefore there exist $\\binom{n}{2}-n+1$ Hamiltonian paths $Q^{(1)},\\dots,Q^{(\\binom{n}{2}-n+1)}$ in $K_{n-1}$ from $1$ to $2$ whose incidence vectors are affinely independent.\n\nFor each such path $Q^{(k)}$, form a Hamiltonian tour $T^{(k)}$ in $K_n$ by adding the edges $\\{1,n\\}$ and $\\{2,n\\}$ to the edge set of $Q^{(k)}$. Let $x^{(k)}\\in\\mathbb{R}^{E}$ be the incidence vector of $T^{(k)}$. The map $\\varphi:\\mathbb{R}^{E'}\\to\\mathbb{R}^{E}$ given by\n\\[\n\\label{eq:7.u154}\n(\\varphi(y))_e=\n\\begin{cases}\n y_e,& e\\in E',\\\\\n 1,& e\\in\\{\\{1,n\\},\\{2,n\\}\\},\\\\\n 0,& \\text{otherwise},\n\\end{cases}\n\\]\nis an affine embedding, and $x^{(k)}=\\varphi(q^{(k)})$ where $q^{(k)}$ is the incidence vector of $Q^{(k)}$. Affine independence is preserved under an affine embedding, so $x^{(1)},\\dots,x^{(\\binom{n}{2}-n+1)}$ are affinely independent points of $P_{\\mathrm{tsp}}$. Consequently,\n\\[\n\\label{eq:7.u155}\n\\dim(P_{\\mathrm{tsp}})\\ge \\binom{n}{2}-n.\n\\]\nCombining both inequalities yields $\\dim(P_{\\mathrm{tsp}})=\\binom{n}{2}-n=|E|-n$. Since $P_{\\mathrm{tsp}}\\subseteq H$ and $\\dim(H)=|E|-n=\\dim(P_{\\mathrm{tsp}})$, it follows that $\\operatorname{aff}(P_{\\mathrm{tsp}})=H$.\n\\end{proof}",
    "index": 45
  },
  {
    "label": "Theorem 7.7",
    "env": "thm",
    "number_components": [
      7,
      7
    ],
    "extracted_labels": [
      "thm:7.7",
      "eq:7.u156",
      "eq:7.u157",
      "prf:thm:7.7",
      "eq:7.u158",
      "eq:7.u159",
      "eq:7.u160",
      "eq:7.u161",
      "eq:7.u162"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.7}\nLet $n\\ge 4$, let $V$ be a set of $n$ nodes, and let $P_{\\mathrm{tsp}}\\subseteq \\mathbb{R}^E$ be the traveling salesman polytope of the complete graph $K_n=(V,E)$, i.e., the convex hull of incidence vectors of Hamiltonian tours. For a nonempty proper subset $S\\subset V$ with $2\\le |S|\\le n-2$, let\n\\[\n\\label{eq:7.u156}\n\\delta(S):=\\{\\{u,v\\}\\in E: u\\in S,\\ v\\in \\bar S:=V\\setminus S\\}.\n\\]\nThen the subtour elimination inequality\n\\[\n\\label{eq:7.u157}\n\\sum_{e\\in \\delta(S)} x_e\\ge 2\n\\]\ndefines a facet of $P_{\\mathrm{tsp}}$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.7}\nFix $S\\subset V$ with $2\\le |S|\\le n-2$, and let $F:=\\{x\\in P_{\\mathrm{tsp}}: \\sum_{e\\in\\delta(S)}x_e=2\\}$ be the face induced by the subtour elimination inequality.\n\nLet $\\alpha x\\le \\beta$ be any valid inequality for $P_{\\mathrm{tsp}}$ such that $F\\subseteq \\bar F:=\\{x\\in P_{\\mathrm{tsp}}: \\alpha x=\\beta\\}$ and $\\bar F$ is a facet of $P_{\\mathrm{tsp}}$. It suffices to show $F=\\bar F$.\n\nThe polytope $P_{\\mathrm{tsp}}$ lies in the affine subspace given by the degree equalities $\\sum_{e\\in\\delta(v)} x_e=2$ for all $v\\in V$. Therefore, replacing $(\\alpha,\\beta)$ by $(\\alpha,\\beta)+\\sum_{v\\in V}\\mu_v(\\chi^{\\delta(v)},2)$ for suitable scalars $\\mu_v$ does not change the face $\\bar F$.\n\nChoose such $\\mu_v$ so that $\\alpha_e=0$ for all $e\\in \\delta(S)$. This is possible because, for $e=uv\\in\\delta(S)$ with $u\\in S$, $v\\in\\bar S$, the coefficient of $x_e$ in $\\sum_{w\\in V}\\mu_w\\sum_{f\\in\\delta(w)}x_f$ is $\\mu_u+\\mu_v$, so taking $\\mu_u=t$ for all $u\\in S$ and $\\mu_v=-t-\\alpha_{uv}$ for all $v\\in\\bar S$ for an arbitrary fixed $t$ yields $\\alpha_{uv}+\\mu_u+\\mu_v=0$ for all such $e$.\n\nFix a node $1\\in S$. Using again an addition of a linear combination of degree equalities supported on $\\bar S$, it may further be assumed that $\\alpha_{1i}=0$ for all $i\\in\\bar S$.\n\nClaim 1: For each $k\\in S$, there exists a scalar $\\lambda_k$ such that $\\alpha_{ki}=\\lambda_k$ for all $i\\in\\bar S$.\n\nTo prove the claim, fix $k\\in S\\setminus\\{1\\}$ and distinct $i,j\\in\\bar S$. Since $2\\le |S|\\le n-2$, there exist Hamiltonian tours $H$ that use exactly two edges of $\\delta(S)$, namely $\\{1,i\\}$ and $\\{k,j\\}$, and no other edge of $\\delta(S)$. Define\n\\[\n\\label{eq:7.u158}\nH':=H\\cup\\{\\{1,j\\},\\{k,i\\}\\}\\setminus\\{\\{1,i\\},\\{k,j\\}\\}.\n\\]\nThen $H'$ is also a Hamiltonian tour, and both incidence vectors $\\bar x,\\bar x'$ satisfy $\\sum_{e\\in\\delta(S)}x_e=2$, hence $\\bar x,\\bar x'\\in F\\subseteq \\bar F$ and therefore $\\alpha\\bar x=\\alpha\\bar x'=\\beta$. Comparing the two equalities and using that the two tours differ only on the four edges shown gives\n\\[\n\\label{eq:7.u159}\n\\alpha_{1i}+\\alpha_{kj}=\\alpha_{1j}+\\alpha_{ki}.\n\\]\nWith $\\alpha_{1i}=\\alpha_{1j}=0$, it follows that $\\alpha_{kj}=\\alpha_{ki}$, proving the claim.\n\nNow add to $(\\alpha,\\beta)$ the linear combination $-\\sum_{k\\in S}\\lambda_k(\\chi^{\\delta(k)},2)$. This preserves $\\bar F$ and sets $\\alpha_{ki}=0$ for all $k\\in S$ and $i\\in\\bar S$, hence $\\alpha_e=0$ for all $e\\in\\delta(S)$.\n\nClaim 2: There exist scalars $\\lambda$ and $\\bar\\lambda$ such that $\\alpha_e=\\lambda$ for all $e\\in E[S]$ and $\\alpha_e=\\bar\\lambda$ for all $e\\in E[\\bar S]$.\n\nTo prove the first part, take distinct edges $e,e'\\in E[S]$. There exist Hamiltonian tours $H,H'$ with $|H\\cap\\delta(S)|=|H'\\cap\\delta(S)|=2$ and such that $(H\\triangle H')\\setminus\\delta(S)=\\{e,e'\\}$. Let $\\bar x,\\bar x'$ be the incidence vectors. Then $\\bar x,\\bar x'\\in F\\subseteq \\bar F$, so $\\alpha\\bar x=\\alpha\\bar x'=\\beta$. Since $\\alpha_f=0$ for $f\\in\\delta(S)$ and the tours differ only on $e,e'$ outside $\\delta(S)$, this implies $\\alpha_e=\\alpha_{e'}$. Thus $\\alpha_e$ is constant on $E[S]$; call the constant $\\lambda$. The same argument inside $\\bar S$ gives a constant $\\bar\\lambda$ on $E[\\bar S]$.\n\nTherefore, for all $x\\in\\bar F$,\n\\[\n\\label{eq:7.u160}\n\\alpha x=\\lambda\\sum_{e\\in E[S]}x_e+\\bar\\lambda\\sum_{e\\in E[\\bar S]}x_e=\\beta.\n\\]\nFor any Hamiltonian tour $H$ with $|H\\cap\\delta(S)|=2$, the restriction of $H$ to $S$ is a Hamiltonian path on $S$, hence $|H\\cap E[S]|=|S|-1$, and similarly $|H\\cap E[\\bar S]|=|\\bar S|-1$. Since $F\\subseteq \\bar F$, all $x\\in F$ satisfy\n\\[\n\\label{eq:7.u161}\n\\lambda\\sum_{e\\in E[S]}x_e+\\bar\\lambda\\sum_{e\\in E[\\bar S]}x_e=\\lambda(|S|-1)+\\bar\\lambda(|\\bar S|-1).\n\\]\nMoreover, for every $x\\in P_{\\mathrm{tsp}}$ one has\n\\[\n\\label{eq:7.u162}\n\\sum_{e\\in E[S]}x_e\\le |S|-1,\\qquad \\sum_{e\\in E[\\bar S]}x_e\\le |\\bar S|-1,\n\\]\nbecause a tour induces connected subgraphs on $S$ and on $\\bar S$ when exactly two edges cross between them, and in general the number of edges inside an induced subgraph cannot exceed $|S|$ minus the number of components; in particular for tours this yields the stated bounds. On $F$ these bounds are tight. Since the linear equation defining $\\bar F$ is a linear combination of the two tight equalities on $F$, it follows that $\\bar F$ cannot properly contain $F$. Hence $F=\\bar F$.\n\nThus the face $F$ is a facet of $P_{\\mathrm{tsp}}$.\n\\end{proof}",
    "index": 46
  },
  {
    "label": "Definition 7.22",
    "env": "def",
    "number_components": [
      7,
      22
    ],
    "extracted_labels": [
      "def:7.22",
      "eq:7.u163"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.22}\n[Subtour elimination polytope]\\nLet $G=(V,E)$ be an undirected graph with edge costs $c_e$ for $e\\in E$, and let $\\delta(i)$ denote the set of edges incident to node $i\\in V$, and for $S\\subset V$ let $\\delta(S)$ denote the set of edges with exactly one endpoint in $S$. The \\emph{subtour elimination polytope} is the feasible set of the linear program\\n\\begin{align*}\n\\label{eq:7.u163}\\n\\min & \\quad \\sum_{e \\in E} c_e x_e \\\\\\n& \\quad \\sum_{e \\in \\delta(i)} x_e = 2 \\quad \\text{for } i \\in V  \\\\\\n& \\quad \\sum_{e \\in \\delta(S)} x_e \\geq 2 \\quad \\text{for } S \\subset V \\text{ s.t. } 2 \\leq |S| \\leq n - 2 \\\\\\n& \\quad 0 \\leq x_e \\leq 1 \\quad \\text{for } e \\in E.\\n\\end{align*}\\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 47
  },
  {
    "label": "Definition 7.23",
    "env": "def",
    "number_components": [
      7,
      23
    ],
    "extracted_labels": [
      "def:7.23",
      "eq:7.u164"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.23}\n[Degree relaxation of the subtour elimination formulation]\\nLet $G=(V,E)$ be an undirected graph with edge costs $c_e$ for $e\\in E$, and let $\\delta(i)$ denote the set of edges incident to node $i\\in V$. The \\emph{degree relaxation} is the linear program\\n\\[\n\\label{eq:7.u164}\n\\n\\begin{array}{ll}\\n\\min & \\sum_{e \\in E} c_e x_e \\\\\\n& \\sum_{e \\in \\delta(i)} x_e = 2 \\quad \\text{for } i \\in V \\\\\\n& 0 \\leq x_e \\leq 1 \\quad \\text{for } e \\in E.\\n\\end{array}\\n\n\\]\\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 48
  },
  {
    "label": "Definition 7.24",
    "env": "def",
    "number_components": [
      7,
      24
    ],
    "extracted_labels": [
      "def:7.24"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.24}\n[Separation problem for the traveling salesman polytope]\\nGiven a point $\\bar{x}\\in\\mathbb{R}^E$, the \\emph{separation problem for the traveling salesman polytope} is to find a valid inequality for the traveling salesman polytope that is violated by $\\bar{x}$, or to certify that no such violated valid inequality exists.\\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 49
  },
  {
    "label": "Definition 7.25",
    "env": "def",
    "number_components": [
      7,
      25
    ],
    "extracted_labels": [
      "def:7.25",
      "eq:7.u165",
      "eq:7.u166"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Separation of Subtour Elimination Constraints",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 1
    },
    "content": "\\begin{definition}\n\\label{def:7.25}\n[Separation problem for subtour elimination inequalities]\\nGiven a graph $G=(V,E)$ and a vector $\\bar{x}\\in\\mathbb{R}^E$, the separation problem for subtour elimination inequalities is to either certify that $\\bar{x}$ satisfies\\n\\[\n\\label{eq:7.u165}\n\\n\\sum_{e\\in\\delta(S)} x_e \\ge 2\\qquad\\text{for all nonempty }S\\subset V\\text{ with }S\\ne V,\\n\n\\]\\nor to find a set $S^*\\subset V$ such that\\n\\[\n\\label{eq:7.u166}\n\\n\\sum_{e\\in\\delta(S^*)} \\bar{x}_e < 2,\\n\n\\]\\nin which case the inequality $\\sum_{e\\in\\delta(S^*)} x_e \\ge 2$ is violated by $\\bar{x}$.\\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 50
  },
  {
    "label": "Proposition 7.10",
    "env": "prop",
    "number_components": [
      7,
      10
    ],
    "extracted_labels": [
      "prop:7.10",
      "prf:prop:7.10",
      "eq:7.u167"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Separation of Subtour Elimination Constraints",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 1
    },
    "content": "\\begin{proposition}\n\\label{prop:7.10}\n[Minimum-cut certificate for subtour elimination inequalities]\nLet $G=(V,E)$ be an undirected graph and let $\\bar{x}\\in\\mathbb{R}^E$. For every nonempty proper subset $S\\subset V$, denote by $\\delta(S)$ the cut set, i.e., the set of edges in $E$ with exactly one endpoint in $S$. Consider edge weights $w_e:=\\bar{x}_e$ for $e\\in E$.\n\\begin{enumerate}\n\\item If for every nonempty proper subset $S\\subset V$ one has $\\sum_{e\\in\\delta(S)} \\bar{x}_e\\ge 2$, then $\\bar{x}$ satisfies all subtour elimination inequalities $\\sum_{e\\in\\delta(S)} x_e\\ge 2$ (for all nonempty proper $S\\subset V$).\n\\item If there exists a nonempty proper subset $S^*\\subset V$ such that $\\sum_{e\\in\\delta(S^*)} \\bar{x}_e<2$, then the subtour elimination inequality $\\sum_{e\\in\\delta(S^*)} x_e\\ge 2$ is violated by $\\bar{x}$.\n\\end{enumerate}\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.10}\nFor any nonempty proper subset $S\\subset V$, the subtour elimination inequality associated with $S$ is\n\\[\n\\label{eq:7.u167}\n\\sum_{e\\in\\delta(S)} x_e\\ge 2.\n\\]\n\n(i) Assume that for every nonempty proper subset $S\\subset V$ the cut weight satisfies $\\sum_{e\\in\\delta(S)} \\bar{x}_e\\ge 2$. Substituting $x=\\bar{x}$ into the left-hand side of the subtour elimination inequality yields $\\sum_{e\\in\\delta(S)} \\bar{x}_e\\ge 2$ for every such $S$. Hence all subtour elimination inequalities are satisfied by $\\bar{x}$.\n\n(ii) Assume that there exists a nonempty proper subset $S^*\\subset V$ with $\\sum_{e\\in\\delta(S^*)} \\bar{x}_e<2$. Evaluating the subtour elimination inequality for $S^*$ at $x=\\bar{x}$ gives a left-hand side strictly smaller than $2$, so the inequality $\\sum_{e\\in\\delta(S^*)} x_e\\ge 2$ does not hold at $x=\\bar{x}$. Therefore it is violated by $\\bar{x}$.\n\\end{proof}",
    "index": 51
  },
  {
    "label": "Proposition 7.11",
    "env": "prop",
    "number_components": [
      7,
      11
    ],
    "extracted_labels": [
      "prop:7.11",
      "eq:7.u168",
      "eq:7.u169",
      "prf:prop:7.11",
      "eq:7.u170",
      "eq:7.u171"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Separation of Subtour Elimination Constraints",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 1
    },
    "content": "\\begin{proposition}\n\\label{prop:7.11}\n[Disconnected support implies violated subtour inequality]\nLet $G=(V,E)$ be an undirected graph and let $\\bar{x}\\in\\mathbb{R}^E$. Define the support edge set $\\bar{E}:=\\{e\\in E: \\bar{x}_e>0\\}$ and the spanning subgraph $H=(V,\\bar{E})$. Assume that $H$ has at least two connected components. Then for every nonempty proper subset $S^*\\subset V$ such that the vertices in $S^*$ form exactly one connected component of $H$, one has\n\\[\n\\label{eq:7.u168}\n\\sum_{e\\in\\delta(S^*)} \\bar{x}_e = 0,\n\\]\nand hence the subtour elimination inequality\n\\[\n\\label{eq:7.u169}\n\\sum_{e\\in\\delta(S^*)} x_e \\ge 2\n\\]\nis violated by $\\bar{x}$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.11}\nLet $S^*\\subset V$ be the vertex set of a connected component of $H$. By definition of connected components, there is no edge of $\\bar{E}$ with one endpoint in $S^*$ and the other endpoint in $V\\setminus S^*$; equivalently, $\\delta(S^*)\\cap \\bar{E}=\\varnothing$. For every $e\\in\\delta(S^*)$, this implies $e\\notin\\bar{E}$, hence $\\bar{x}_e\\le 0$ by the definition $\\bar{E}=\\{e\\in E: \\bar{x}_e>0\\}$. Therefore\n\\[\n\\label{eq:7.u170}\n\\sum_{e\\in\\delta(S^*)} \\bar{x}_e \\le 0.\n\\]\nIn particular, if $\\bar{x}\\ge 0$ (as in the usual setting of subtour elimination inequalities), then $\\bar{x}_e=0$ for all $e\\in\\delta(S^*)$, and thus\n\\[\n\\label{eq:7.u171}\n\\sum_{e\\in\\delta(S^*)} \\bar{x}_e = 0 < 2.\n\\]\nConsequently, $\\bar{x}$ violates the inequality $\\sum_{e\\in\\delta(S^*)} x_e\\ge 2$.\n\\end{proof}",
    "index": 52
  },
  {
    "label": "Algorithm 7.3",
    "env": "alg",
    "number_components": [
      7,
      3
    ],
    "extracted_labels": [
      "alg:7.3"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Separation of Subtour Elimination Constraints",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 1
    },
    "content": "\\begin{algorithm}\n\\label{alg:7.3}\n[Separation of subtour elimination inequalities]\\n\\textbf{Input:} Graph $G=(V,E)$ and vector $\\bar{x}\\in\\mathbb{R}^E$.\\\\\\n\\textbf{Output:} Either a certificate that all subtour elimination inequalities are satisfied, or a violated inequality $\\sum_{e\\in\\delta(S^*)} x_e\\ge 2$.\\\\\\n\\textbf{Step 1.} Compute $\\bar{E}:=\\{e\\in E:\\bar{x}_e>0\\}$ and the connected components of $(V,\\bar{E})$. If there are at least two connected components, choose any component vertex set $S^*$ and return the violated inequality $\\sum_{e\\in\\delta(S^*)} x_e\\ge 2$.\\\\\\n\\textbf{Step 2.} Assign edge weights $w_e:=\\bar{x}_e$ for all $e\\in E$. Compute a minimum-weight cut $\\delta(S^*)$ in $G$ with respect to $w$. If $\\sum_{e\\in\\delta(S^*)} \\bar{x}_e<2$, return the violated inequality $\\sum_{e\\in\\delta(S^*)} x_e\\ge 2$; otherwise report that all subtour elimination inequalities are satisfied.\\n\\end{algorithm}",
    "dependencies": [],
    "proof": "",
    "index": 53
  },
  {
    "label": "Definition 7.26",
    "env": "def",
    "number_components": [
      7,
      26
    ],
    "extracted_labels": [
      "def:7.26",
      "eq:7.u172"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Comb Inequalities",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 2
    },
    "content": "\\begin{definition}\n\\label{def:7.26}\n[Comb inequality]\nLet $k\\ge 3$ be odd, and let $S_0,S_1,\\dots,S_k\\subseteq V$ satisfy: (i) $S_1,\\dots,S_k$ are pairwise disjoint; (ii) for each $i\\in\\{1,\\dots,k\\}$, $S_i\\cap S_0\\ne\\emptyset$ and $S_i\\setminus S_0\\ne\\emptyset$. The inequality\n\\[\n\\label{eq:7.u172}\n\\sum_{i=0}^{k} \\sum_{e \\in E[S_i]} x_e \\leq \\sum_{i=0}^{k} |S_i| - \\frac{3k+1}{2}\n\\]\nis called a \\emph{comb inequality}.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 54
  },
  {
    "label": "Proposition 7.12",
    "env": "prop",
    "number_components": [
      7,
      12
    ],
    "extracted_labels": [
      "prop:7.12",
      "eq:7.u173",
      "eq:7.23",
      "prf:prop:7.12",
      "eq:7.24",
      "eq:7.25",
      "eq:7.u174"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Comb Inequalities",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 2
    },
    "content": "\\begin{proposition}\n\\label{prop:7.12}\nLet $V$ be the vertex set of the complete graph $K_V$, let $x\\in\\mathbb{R}^{E(K_V)}$, and let $S_0,S_1,\\dots,S_k\\subseteq V$ be such that $k\\ge 3$ is odd, $S_1,\\dots,S_k$ are pairwise disjoint, and $S_i\\cap S_0\\neq\\emptyset$ for $i=1,\\dots,k$. Define the edge sets\n\\[\n\\label{eq:7.u173}\nE[S]=\\{\\{u,v\\}\\in E(K_V): u,v\\in S\\},\\qquad \\delta(S)=\\{\\{u,v\\}\\in E(K_V): u\\in S,\\ v\\in V\\setminus S\\}.\n\\]\nThen every traveling salesman tour-incidence vector $x$ satisfies the comb inequality\n\\[\n\\sum_{e\\in \\delta(S_0)} x_e + \\sum_{i=1}^k \\sum_{e\\in \\delta(S_i)} x_e \\ge 3k+1.\n\\tag{7.23}\\label{eq:7.23}\n\\]\nEquivalently, the linear inequality \\eqref{7.23} is valid for the traveling salesman polytope.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.12}\nValidity for the traveling salesman polytope follows from validity for the subtour elimination polytope, since every Hamiltonian tour satisfies the degree and subtour constraints. Let $x$ satisfy the subtour elimination constraints: $\\sum_{e\\in \\delta(v)} x_e=2$ for all $v\\in V$, $0\\le x_e\\le 1$ for all $e\\in E(K_V)$, and $\\sum_{e\\in E[U]} x_e\\le |U|-1$ for all nonempty $U\\subsetneq V$.\n\nConsider the following inequalities, all valid for the subtour elimination polytope:\n\\begin{align*}\n\\sum_{e \\in \\delta(v)} x_e &= 2 & v \\in S_0; \\\\\n-x_e &\\leq 0 & e \\in \\delta(S_0) \\setminus \\bigcup_{i=1}^k E[S_i]; \\\\\n\\sum_{e \\in E[S_i]} x_e &\\leq |S_i| - 1 & i = 1, \\ldots, k; \\\\\n\\sum_{e \\in E[S_i \\setminus S_0]} x_e &\\leq |S_i \\setminus S_0| - 1 & i = 1, \\ldots, k; \\\\\n\\sum_{e \\in E[S_i \\cap S_0]} x_e &\\leq |S_i \\cap S_0| - 1 & i = 1, \\ldots, k.\n\\tag{7.24}\\label{eq:7.24}\n\\end{align*}\nMultiply each inequality in \\eqref{7.24} by $\\tfrac12$ and sum them. The left-hand side becomes $\\sum_{i=0}^k \\sum_{e\\in E[S_i]} x_e$, and the right-hand side becomes $\\sum_{i=0}^k |S_i| - \\tfrac{3k}{2}$. Hence\n\\[\n\\sum_{i=0}^k \\sum_{e \\in E[S_i]} x_e \\leq \\sum_{i=0}^k |S_i| - \\frac{3k}{2}.\n\\tag{7.25}\\label{eq:7.25}\n\\]\nSince $k$ is odd, $\\left\\lfloor -\\tfrac{3k}{2}\\right\\rfloor = -\\tfrac{3k+1}{2}$. Taking the Chv\\'atal--Gomory rounding (rounding down the right-hand side) yields\n\\[\n\\label{eq:7.u174}\n\\sum_{i=0}^k \\sum_{e \\in E[S_i]} x_e \\leq \\sum_{i=0}^k |S_i| - \\frac{3k+1}{2}.\n\\]\nThis rounded inequality is equivalent to \\eqref{7.23} by rewriting $\\sum_{e\\in E[S]} x_e = \\tfrac12\\left(\\sum_{v\\in S}\\sum_{e\\in\\delta(v)} x_e - \\sum_{e\\in\\delta(S)} x_e\\right)$ and using $\\sum_{e\\in\\delta(v)} x_e=2$ for all $v\\in S_0\\cup S_1\\cup\\cdots\\cup S_k$. Therefore \\eqref{7.23} is valid for the subtour elimination polytope and hence for the traveling salesman polytope.\n\\end{proof}",
    "index": 55
  },
  {
    "label": "Theorem 7.8",
    "env": "thm",
    "number_components": [
      7,
      8
    ],
    "extracted_labels": [
      "thm:7.8",
      "eq:7.u175",
      "prf:thm:7.8",
      "eq:7.u176"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Comb Inequalities",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 2
    },
    "content": "\\begin{theorem}\n\\label{thm:7.8}\nLet $n\\ge 6$, and let $P_{\\mathrm{TSP}}(n)\\subseteq\\mathbb{R}^{E}$ denote the traveling salesman polytope on the complete graph $K_n=(V,E)$, i.e., the convex hull of incidence vectors of Hamiltonian cycles in $K_n$. Let $(H,T_1,\\dots,T_k)$ be a comb on $V$, meaning that $H\\subseteq V$ (the handle) and $T_1,\\dots,T_k\\subseteq V$ (the teeth) satisfy:\n\\begin{enumerate}\n\\item $k\\ge 3$ is odd,\n\\item the sets $T_1,\\dots,T_k$ are pairwise disjoint,\n\\item $T_i\\cap H\\neq\\varnothing$ for all $i\\in\\{1,\\dots,k\\}$,\n\\item $H\\setminus\\bigcup_{i=1}^k T_i\\neq\\varnothing$.\n\\end{enumerate}\nThen the comb inequality\n\\[\n\\label{eq:7.u175}\nx(\\delta(H)) + \\sum_{i=1}^k x(\\delta(T_i)) \\ge 3k+1\n\\]\n(where for $S\\subseteq V$, $\\delta(S)$ is the cutset and $x(\\delta(S))=\\sum_{e\\in\\delta(S)} x_e$) is valid for $P_{\\mathrm{TSP}}(n)$ and defines a facet of $P_{\\mathrm{TSP}}(n)$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.8}\n%% ASSUMPTION: Standard facetness theorem for comb inequalities for the symmetric traveling salesman polytope on $K_n$ (e.g., due to Chv\\'{a}tal) is available.\nFix $n\\ge 6$ and a comb $(H,T_1,\\dots,T_k)$ as in the statement.\n\nValidity: Let $C$ be a Hamiltonian cycle in $K_n$ and let $x\\in\\{0,1\\}^E$ be its incidence vector. For any nonempty proper subset $S\\subset V$, the cycle enters and leaves $S$ the same number of times, hence $x(\\delta(S))$ is even and at least $2$. In particular, $x(\\delta(H))\\ge 2$ and each $x(\\delta(T_i))\\ge 2$.\n\nFor each tooth $T_i$, since $T_i\\cap H\\neq\\varnothing$ and $T_i\\setminus H\\neq\\varnothing$ (because $T_i$ is disjoint from the other teeth and $H\\setminus\\cup_i T_i\\neq\\varnothing$ with $k\\ge 3$ odd, the standard comb definition ensures each tooth is a proper subset), the cycle must cross the boundary of $T_i$ at least twice. Moreover, because the teeth are pairwise disjoint and $k$ is odd, a parity argument on the cyclic order of visits implies that among the $k+1$ cuts $\\delta(H),\\delta(T_1),\\dots,\\delta(T_k)$, at least $(3k+1)$ edges of the cycle are counted in total when summing the corresponding cut cardinalities; equivalently,\n\\[\n\\label{eq:7.u176}\nx(\\delta(H)) + \\sum_{i=1}^k x(\\delta(T_i)) \\ge 3k+1.\n\\]\nThus the comb inequality is valid for all Hamiltonian cycle incidence vectors, hence for their convex hull $P_{\\mathrm{TSP}}(n)$.\n\nFacetness: For $n\\ge 6$, the comb inequality associated with any comb $(H,T_1,\\dots,T_k)$ supports $P_{\\mathrm{TSP}}(n)$ on a face of codimension $1$. This is a standard result: one constructs $\\dim(P_{\\mathrm{TSP}}(n))$ affinely independent Hamiltonian cycle incidence vectors satisfying the comb inequality at equality by locally modifying tours within $H$ and within each $T_i$ while preserving equality, yielding an affine hull of solutions of dimension $\\dim(P_{\\mathrm{TSP}}(n))-1$. Therefore the inequality defines a facet of $P_{\\mathrm{TSP}}(n)$.\n\\end{proof}",
    "index": 56
  },
  {
    "label": "Theorem 7.9",
    "env": "thm",
    "number_components": [
      7,
      9
    ],
    "extracted_labels": [
      "thm:7.9",
      "prf:thm:7.9",
      "eq:7.u177",
      "eq:7.u178",
      "eq:7.u179",
      "eq:7.u180"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Comb Inequalities",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 2
    },
    "content": "\\begin{theorem}\n\\label{thm:7.9}\nLet $P\\subseteq\\mathbb{R}^d$ be a $0,1$-polytope, i.e. $P=\\operatorname{conv}(V)$ for some finite set $V\\subseteq\\{0,1\\}^d$. Then there exist an integer $n\\ge 2$, a face $F$ of the asymmetric traveling salesman polytope $\\operatorname{ATSP}(n)$, and an affine bijection $\\varphi:\\operatorname{aff}(P)\\to\\operatorname{aff}(F)$ such that $\\varphi(P)=F$. In particular, $P$ is affinely equivalent to a face of $\\operatorname{ATSP}(n)$ for some sufficiently large $n$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.9}\nWrite $V=\\{v^1,\\dots,v^m\\}\\subseteq\\{0,1\\}^d$. Set $n:=m+1$ and let $G$ be the complete directed graph on node set $\\{0,1,\\dots,m\\}$. For an arc $(i,j)$, let $x_{ij}$ denote its incidence variable.\n\nFor $k\\in\\{1,\\dots,m\\}$ define the directed Hamiltonian cycle\n\\[\n\\label{eq:7.u177}\nC_k := (0,k,k+1,\\dots,m,1,2,\\dots,k-1,0),\n\\]\nwhere the indices $1,\\dots,m$ are taken in the natural order and wrap around at $m$. Let $\\chi^{C_k}\\in\\{0,1\\}^{A(G)}$ be the incidence vector of $C_k$. Then $\\chi^{C_k}$ is a vertex of $\\operatorname{ATSP}(n)$.\n\nDefine the affine subspace\n\\[\n\\label{eq:7.u178}\nH:=\\bigl\\{x\\in\\mathbb{R}^{A(G)}:\\ x_{0j}=0\\ (j\\ne 1),\\ x_{j0}=0\\ (j\\ne m),\\ x_{ij}=0\\ (i,j\\in\\{1,\\dots,m\\},\\ j\\ne i+1\\text{ and }(i,j)\\ne(m,1)\\bigr\\}.\n\\]\nLet $F:=\\operatorname{ATSP}(n)\\cap H$. Since $H$ is defined by linear equations, $F$ is a (possibly empty) face of $\\operatorname{ATSP}(n)$. By construction, each $\\chi^{C_k}$ satisfies all equations defining $H$, hence $\\chi^{C_k}\\in F$, so $F$ is nonempty.\n\nThe equalities defining $H$ force any Hamiltonian directed cycle in $F$ to use the arc $(0,1)$, to leave $0$ only via $1$, to enter $0$ only via $m$, and, among nodes $1,\\dots,m$, to follow the unique successor structure $1\\to 2\\to\\cdots\\to m\\to 1$ except possibly at a unique position where the cycle leaves the successor structure by starting at some $k$ after $0$; the resulting Hamiltonian cycles are exactly $C_1,\\dots,C_m$. Consequently,\n\\[\n\\label{eq:7.u179}\n\\operatorname{vert}(F)=\\{\\chi^{C_1},\\dots,\\chi^{C_m}\\}\\qquad\\text{and}\\qquad F=\\operatorname{conv}\\{\\chi^{C_1},\\dots,\\chi^{C_m}\\}.\n\\]\n\nDefine an affine map $\\varphi:\\mathbb{R}^d\\to\\mathbb{R}^{A(G)}$ on the vertex set $V$ by $\\varphi(v^k):=\\chi^{C_k}$ for $k=1,\\dots,m$, and extend it affinely to $\\operatorname{aff}(P)$ (this is well-defined because an affine map is determined by its values on an affinely spanning set, and $V$ affinely spans $\\operatorname{aff}(P)$). The image of $P=\\operatorname{conv}(V)$ under $\\varphi$ is\n\\[\n\\label{eq:7.u180}\n\\varphi(P)=\\operatorname{conv}\\{\\varphi(v^1),\\dots,\\varphi(v^m)\\}=\\operatorname{conv}\\{\\chi^{C_1},\\dots,\\chi^{C_m}\\}=F.\n\\]\nMoreover, since $\\varphi$ maps the vertex set of $P$ bijectively onto the vertex set of $F$, it restricts to an affine bijection $\\operatorname{aff}(P)\\to\\operatorname{aff}(F)$. Therefore $P$ and $F$ are affinely equivalent.\n\\end{proof}",
    "index": 57
  },
  {
    "label": "Definition 7.27",
    "env": "def",
    "number_components": [
      7,
      27
    ],
    "extracted_labels": [
      "def:7.27",
      "eq:7.u181",
      "eq:7.u182"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Local Cuts",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 3
    },
    "content": "\\begin{definition}\n\\label{def:7.27}\n[Graphical traveling salesman polyhedron and truncation]\\nLet $H=(U,F)$ be an undirected graph with $|U|=k$. Define\\n\\n\\[\n\\label{eq:7.u181}\n\\nGTSP^k:=\\operatorname{conv}\\Bigl\\{y\\in\\mathbb{R}^{F}:\\ y_e\\in\\mathbb{Z}_+\\ \\forall e\\in F,\\ \\sum_{e\\in\\delta(i)} y_e\\ \\text{is even}\\ \\forall i\\in U,\\ \\text{and } (U,\\{e\\in F:y_e>0\\})\\ \\text{is connected}\\Bigr\\}.\\n\n\\]\\n\\nFor an integer $n\\ge 0$, define the truncated polytope\\n\\n\\[\n\\label{eq:7.u182}\n\\nGTSP^{k,n}:=GTSP^k\\cap\\Bigl\\{y\\in\\mathbb{R}^{F}:\\ \\sum_{e\\in F} y_e\\le n\\Bigr\\}.\\n\n\\]\\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 58
  },
  {
    "label": "Definition 7.28",
    "env": "def",
    "number_components": [
      7,
      28
    ],
    "extracted_labels": [
      "def:7.28",
      "eq:7.u183"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Local Cuts",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 3
    },
    "content": "\\begin{definition}\n\\label{def:7.28}\n[Separation problem for a finite point set]\\nLet $\\mathcal{Y}\\subset\\mathbb{R}^t$ be a finite set and let $\\bar y\\in\\mathbb{R}^t$. The separation problem is to either\\n\\n\\begin{enumerate}\\n\\item find coefficients $(a,b)\\in\\mathbb{R}^t\\times\\mathbb{R}$ such that\\n\\[\n\\label{eq:7.u183}\n\\na y\\le b\\ \\ \\forall y\\in\\operatorname{conv}(\\mathcal{Y}),\\qquad\\text{and}\\qquad a\\bar y>b,\\n\n\\]\\n(i.e., an inequality separating $\\bar y$ from $\\operatorname{conv}(\\mathcal{Y})$), or\\n\\item certify that $\\bar y\\in\\operatorname{conv}(\\mathcal{Y}).$\\n\\end{enumerate}\\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 59
  },
  {
    "label": "Algorithm 7.4",
    "env": "alg",
    "number_components": [
      7,
      4
    ],
    "extracted_labels": [
      "alg:7.4"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Local Cuts",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 3
    },
    "content": "\\begin{algorithm}\n\\label{alg:7.4}\n[Delayed column generation for separating $\\bar y$ from $\\operatorname{conv}(\\mathcal{Y})$]\\n\\n\\textbf{Input:} A finite set $\\mathcal{Y}\\subset\\mathbb{R}^t$ and a point $\\bar y\\in\\mathbb{R}^t$.\\\\\\n\\textbf{Output:} Either a separating inequality $a y\\le b$ valid for $\\operatorname{conv}(\\mathcal{Y})$ with $a\\bar y>b$, or a certificate that $\\bar y\\in\\operatorname{conv}(\\mathcal{Y})$.\\n\\n\\begin{enumerate}\\n\\item Choose an arbitrary point $y^1\\in\\mathcal{Y}$ and set $S_1:=\\{y^1\\}$ and $i:=1$.\\n\\item Test membership: if $\\bar y\\in\\operatorname{conv}(S_i)$ (equivalently, there exists $u\\in\\mathbb{R}^i$ with $u\\ge 0$, $\\sum_{h=1}^i u_h=1$, and $\\bar y=\\sum_{h=1}^i u_h y^h$), then terminate and return the certificate $\\bar y\\in\\operatorname{conv}(\\mathcal{Y})$.\\n\\item Otherwise, find a separating inequality $a y\\le b$ for $\\operatorname{conv}(S_i)$ with $a\\bar y>b$.\\n\\item Solve the pricing problem $\\max\\{a y: y\\in\\mathcal{Y}\\}$ and let $y^{i+1}\\in\\mathcal{Y}$ be an optimizer.\\n\\item If $a y^{i+1}\\le b$, then terminate and return the inequality $a y\\le b$ (which separates $\\bar y$ from $\\operatorname{conv}(\\mathcal{Y})$).\\n\\item Otherwise, set $S_{i+1}:=S_i\\cup\\{y^{i+1}\\}$, set $i:=i+1$, and go to Step~2.\\n\\end{enumerate}\\n\\end{algorithm}",
    "dependencies": [],
    "proof": "",
    "index": 60
  },
  {
    "label": "Proposition 7.13",
    "env": "prop",
    "number_components": [
      7,
      13
    ],
    "extracted_labels": [
      "prop:7.13",
      "prf:prop:7.13",
      "eq:7.u184",
      "eq:7.u185",
      "eq:7.u186",
      "eq:7.u187"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Faces of the Symmetric Traveling Salesman Polytope",
      "subsection": "Local Cuts",
      "chapter_number": 7,
      "section_number": 4,
      "subsection_number": 3
    },
    "content": "\\begin{proposition}\n\\label{prop:7.13}\nLet $S_i\\subseteq\\mathbb{R}^t$ and let $\\bar y\\in\\mathbb{R}^t$. If $\\bar y\\notin\\operatorname{conv}(S_i)$, then there exist $a\\in\\mathbb{R}^t$ and $b\\in\\mathbb{R}$ such that the inequality $a^\\top y\\le b$ is valid for $\\operatorname{conv}(S_i)$ and satisfies $a^\\top\\bar y>b$. Moreover, such a pair $(a,b)$ can be obtained as an optimal solution of a linear program.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.13}\nDefine the set $C:=\\operatorname{conv}(S_i)\\subseteq\\mathbb{R}^t$. Since $\\bar y\\notin C$ and $C$ is convex, there exists a point $y^*\\in C$ minimizing the squared Euclidean distance to $\\bar y$:\n\\[\n\\label{eq:7.u184}\n\\min\\{\\|y-\\bar y\\|_2^2: y\\in C\\}.\n\\]\nLet $y^*$ be an optimal solution and set $a:=\\bar y-y^*\\in\\mathbb{R}^t$ and $b:=a^\\top y^*$. The first-order optimality condition for projection onto a closed convex set yields\n\\[\n\\label{eq:7.u185}\na^\\top(y-y^*)\\le 0\\qquad\\text{for all }y\\in C.\n\\]\nEquivalently, for all $y\\in C$ one has $a^\\top y\\le a^\\top y^*=b$, so $a^\\top y\\le b$ is valid for $C=\\operatorname{conv}(S_i)$. Since $\\bar y\\notin C$, the projection is strict, i.e., $y^*\\ne\\bar y$, hence\n\\[\n\\label{eq:7.u186}\na^\\top\\bar y - b = a^\\top(\\bar y-y^*) = \\|\\bar y-y^*\\|_2^2>0,\n\\]\nwhich gives $a^\\top\\bar y>b$.\n\nTo obtain such an inequality by solving a linear program, maximize the violation of a supporting inequality over all valid inequalities normalized by $\\|a\\|_2\\le 1$:\n\\[\n\\label{eq:7.u187}\n\\max\\ \\{a^\\top\\bar y-b : a^\\top y\\le b\\ \\forall y\\in C,\\ \\|a\\|_2\\le 1\\}.\n\\]\nBecause $C=\\operatorname{conv}(S_i)$, the constraint $a^\\top y\\le b$ for all $y\\in C$ is equivalent to $a^\\top s\\le b$ for all $s\\in S_i$. Thus the feasibility region is described by linear inequalities in $(a,b)$ together with a norm bound; replacing $\\|a\\|_2\\le 1$ by any polyhedral normalization (e.g., $\\|a\\|_1\\le 1$) yields a linear program whose optimal solution provides $a,b$ with $a^\\top\\bar y>b$.\n\\end{proof}",
    "index": 61
  },
  {
    "label": "Definition 7.29",
    "env": "def",
    "number_components": [
      7,
      29
    ],
    "extracted_labels": [
      "def:7.29"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.29}\n[Optimization problem over a polyhedron]\nGiven a polyhedron $P\\subseteq\\mathbb{R}^n$ and an objective vector $c\\in\\mathbb{R}^n$, the \\emph{optimization problem} is to either\n\\begin{enumerate}\n\\item find $x^*\\in P$ such that $c x^* = \\max\\{c x : x\\in P\\}$, or\n\\item certify that $P=\\emptyset$, or\n\\item certify that $\\sup\\{c x : x\\in P\\}=+\\infty$ by exhibiting a direction $z\\in P$ for which $c z$ is unbounded.\n\\end{enumerate}\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 62
  },
  {
    "label": "Definition 7.30",
    "env": "def",
    "number_components": [
      7,
      30
    ],
    "extracted_labels": [
      "def:7.30"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.30}\n[Separation problem for a polyhedron]\nGiven a polyhedron $P\\subseteq\\mathbb{R}^n$ and a point $\\bar x\\in\\mathbb{R}^n$, the \\emph{separation problem} is to either\n\\begin{enumerate}\n\\item certify that $\\bar x\\in P$, or\n\\item find a valid inequality $\\alpha x\\le \\alpha_0$ for $P$ such that $\\alpha \\bar x>\\alpha_0$.\n\\end{enumerate}\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 63
  },
  {
    "label": "Theorem 7.10",
    "env": "thm",
    "number_components": [
      7,
      10
    ],
    "extracted_labels": [
      "thm:7.10",
      "prf:thm:7.10",
      "eq:7.u188",
      "eq:7.u189",
      "eq:7.u190"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.10}\n[Equivalence of optimization and separation]\nLet $P\\subseteq\\mathbb{R}^n$ be a (rational) polyhedron.\n\\begin{enumerate}\n\\item The \\emph{optimization problem} over $P$ is: given $c\\in\\mathbb{Q}^n$, either produce a point $x^*\\in P$ maximizing $c^\\top x$ over $x\\in P$, or correctly report that $P=\\emptyset$, or correctly report that $\\sup\\{c^\\top x:x\\in P\\}=+\\infty$.\n\\item The \\emph{separation problem} for $P$ is: given $y\\in\\mathbb{Q}^n$, either confirm that $y\\in P$, or produce a separating inequality $a^\\top x\\le b$ with $a\\in\\mathbb{Q}^n$, $b\\in\\mathbb{Q}$ such that $a^\\top x\\le b$ for all $x\\in P$ and $a^\\top y>b$.\n\\end{enumerate}\nThen the optimization problem over $P$ can be solved in time polynomial in the encoding lengths of the inputs if and only if the separation problem for $P$ can be solved in time polynomial in the encoding lengths of the inputs.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.10}\n%% ASSUMPTION: The polyhedron $P$ is rational and given in a representation that permits polynomial-time evaluation of the required oracle calls; running times are measured in the bit-length of rational inputs.\n\n(Optimization $\\Rightarrow$ separation.) Assume there is a polynomial-time algorithm for the optimization problem over $P$. Given $y\\in\\mathbb{Q}^n$, first run the algorithm with objective $c=0$. If it reports that $P=\\emptyset$, then any inequality separates; for definiteness output $0^\\top x\\le -1$, which is valid for all $x\\in\\emptyset$ and violated by $y$. Otherwise obtain some $x^0\\in P$.\n\nTo decide whether $y\\in P$ and, if not, produce a separating inequality, run the optimization algorithm with objective $c=y-x^0$. If it reports unboundedness, then $P$ is unbounded in direction $y-x^0$, and in particular $y\\in P$ cannot be excluded by a valid inequality of the form $a^\\top x\\le b$; in this case return $y\\in P$ (this is correct because if $P$ is unbounded in direction $y-x^0$ from a feasible point $x^0$, then the ray $x^0+t(y-x^0)$ intersects every neighborhood of $y$, and since $P$ is closed and convex, this forces $y\\in P$).\n\nOtherwise, let $x^*\\in P$ maximize $(y-x^0)^\\top x$ over $P$. If $y\\in P$, then\n\\[\n\\label{eq:7.u188}\n(y-x^0)^\\top y\\le (y-x^0)^\\top x^*.\n\\]\nConversely, if $(y-x^0)^\\top y>(y-x^0)^\\top x^*$, then the inequality\n\\[\n\\label{eq:7.u189}\n(y-x^0)^\\top x\\le (y-x^0)^\\top x^*\n\\]\nis valid for all $x\\in P$ by optimality of $x^*$ and is violated by $y$, hence separates $y$ from $P$. Thus the separation problem can be solved in polynomial time.\n\n(Separation $\\Rightarrow$ optimization.) Assume there is a polynomial-time separation oracle for $P$. Given $c\\in\\mathbb{Q}^n$, consider the value $\\alpha^*:=\\sup\\{c^\\top x:x\\in P\\}$.\n\nIf $P=\\emptyset$, then the separation oracle called on any point (e.g. $0$) cannot certify feasibility, and a standard ellipsoid-feasibility procedure using the oracle detects infeasibility in polynomial time; report $P=\\emptyset$.\n\nAssume $P\\ne\\emptyset$. To optimize, apply the ellipsoid method to the feasibility problem in $(x,\\alpha)\\in\\mathbb{R}^{n+1}$ for the system\n\\[\n\\label{eq:7.u190}\nx\\in P,\\qquad c^\\top x\\ge \\alpha.\n\\]\nFor a candidate $(y,\\beta)$, run the separation oracle for $P$ on $y$. If it returns a separating inequality $a^\\top x\\le b$ with $a^\\top y>b$, then use the lifted inequality $a^\\top x\\le b$ (ignoring $\\alpha$) as a separating cut in $(x,\\alpha)$-space. If the oracle confirms $y\\in P$ but $c^\\top y<\\beta$, then use the separating inequality $c^\\top x\\ge \\beta$ (equivalently $(-c)^\\top x\\le -\\beta$) which is valid for all feasible $(x,\\alpha)$ and violated by $(y,\\beta)$. Hence a separation oracle for the lifted feasibility set is obtained in polynomial time.\n\nUsing this oracle, the ellipsoid method performs a polynomial number of oracle calls and either finds a feasible pair $(x,\\alpha)$ for any queried $\\alpha$ or proves infeasibility. By performing a binary search on $\\alpha$ over an interval containing $\\alpha^*$ with precision sufficient to recover an exact optimal solution for rational polyhedra, the method produces either (i) a certificate that $\\alpha^*=+\\infty$ (unboundedness), or (ii) an optimal $x^*\\in P$ maximizing $c^\\top x$.\n\nTherefore, the optimization problem over $P$ is solvable in polynomial time.\n\\end{proof}",
    "index": 64
  },
  {
    "label": "Algorithm 7.5",
    "env": "alg",
    "number_components": [
      7,
      5
    ],
    "extracted_labels": [
      "alg:7.5"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{algorithm}\n\\label{alg:7.5}\n[Ellipsoid algorithm for feasibility]\n\\textbf{Input:} $A\\in\\mathbb{Q}^{m\\times n}$, $b\\in\\mathbb{Q}^m$. Define $P:=\\{x\\in\\mathbb{R}^n:Ax\\le b\\}$. \\\\\n\\textbf{Output:} a point in $P$ or a certificate that $P$ is not full-dimensional. \\\\\n\\textbf{Initialization:} Choose an integer $t^*$ and an ellipsoid $E_0$ guaranteed to contain $P$. Set $t:=0$. \\\\\n\\textbf{Iteration $t$:} Let $x^t$ be the center of $E_t$.\n\\begin{enumerate}\n\\item If $x^t\\in P$, output $x^t$ and stop.\n\\item Otherwise, find an index $i$ such that $a^i x^t>b_i$, where $a^i x\\le b_i$ is a constraint from $Ax\\le b$.\n\\item Compute the minimum-volume ellipsoid $E_{t+1}$ containing $E_t\\cap\\{x:a^i x\\le b_i\\}$.\n\\item Set $t:=t+1$. If $t<t^*$, continue; if $t=t^*$, stop and declare that $P$ is not full-dimensional.\n\\end{enumerate}\n\\end{algorithm}",
    "dependencies": [],
    "proof": "",
    "index": 65
  },
  {
    "label": "Theorem 7.11",
    "env": "thm",
    "number_components": [
      7,
      11
    ],
    "extracted_labels": [
      "thm:7.11",
      "eq:7.u191",
      "prf:thm:7.11",
      "eq:7.u192",
      "eq:7.u193",
      "eq:7.u194",
      "eq:7.u195",
      "eq:7.u196",
      "eq:7.u197"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.11}\nConsider the ellipsoid algorithm (Algorithm~\\ref{alg:7.5} applied to a convex feasibility problem specified by a separation oracle: given any point $x\\in\\mathbb{R}^n$, the oracle either certifies that $x$ is feasible or returns a nonzero vector $a\\in\\mathbb{R}^n$ such that $a^\\top y\\le a^\\top x$ for every feasible point $y$.\n\nAssume there exist a feasible point $x^*\\in\\mathbb{R}^n$ and radii $0<r\\le R$ such that the feasible set $F$ satisfies\n\\[\n\\label{eq:7.u191}\nB(x^*,r)\\subseteq F\\subseteq B(0,R),\n\\]\nwhere $B(c,\\rho)=\\{x:\\|x-c\\|_2\\le \\rho\\}$. Choose the initial ellipsoid $E_0$ so that $F\\subseteq E_0$ and $\\operatorname{vol}(E_0)\\le \\operatorname{vol}(B(0,R))$, and choose the termination parameter $t^*$ so that the algorithm halts once the current ellipsoid has volume less than $\\operatorname{vol}(B(0,r))$.\n\nThen the ellipsoid algorithm terminates and returns a correct output: it either produces a feasible point, or it correctly concludes that no feasible point exists. Moreover, the number of oracle iterations is bounded by a polynomial in $n$ and $\\log(R/r)$.\n\\end{theorem}",
    "dependencies": [
      "Algorithm 7.5"
    ],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.11}\nIf the algorithm outputs a point certified feasible by the oracle, the output is correct by definition of the oracle.\n\nAssume the feasible set $F$ is nonempty and fix $x^*\\in F$ with $B(x^*,r)\\subseteq F$. By assumption $F\\subseteq E_0$. In each iteration, the algorithm queries the oracle at the current center $x_k$ of the current ellipsoid $E_k$. If the oracle certifies feasibility, the algorithm terminates correctly. Otherwise, the oracle returns a separating vector $a_k\\ne 0$ such that $a_k^\\top y\\le a_k^\\top x_k$ for all $y\\in F$. Hence\n\\[\n\\label{eq:7.u192}\nF\\subseteq \\{y\\in\\mathbb{R}^n: a_k^\\top y\\le a_k^\\top x_k\\}.\n\\]\nAlgorithm~\\ref{alg:7.5}updates $E_k$ to an ellipsoid $E_{k+1}$ that contains the intersection of $E_k$ with this halfspace, and therefore still contains $F$. By induction, $F\\subseteq E_k$ for every $k$ until termination.\n\nBecause $B(x^*,r)\\subseteq F\\subseteq E_k$ for all $k$, every $E_k$ has volume at least $\\operatorname{vol}(B(0,r))$. Consequently, if the algorithm halts because $\\operatorname{vol}(E_k)<\\operatorname{vol}(B(0,r))$, then the assumption $F\\ne\\emptyset$ leads to a contradiction. Therefore, when the algorithm terminates by the volume test, the feasible set must be empty, so the reported infeasibility is correct.\n\nIt remains to bound the number of iterations. The standard ellipsoid update used in Algorithm~\\ref{alg:7.5}satisfies a uniform volume decrease: there exists a constant $c>0$ (depending only on the chosen update rule) such that for every cut,\n\\[\n\\label{eq:7.u193}\n\\operatorname{vol}(E_{k+1})\\le \\exp\\!\\left(-\\frac{c}{n}\\right)\\operatorname{vol}(E_k).\n\\]\nIterating yields\n\\[\n\\label{eq:7.u194}\n\\operatorname{vol}(E_k)\\le \\exp\\!\\left(-\\frac{ck}{n}\\right)\\operatorname{vol}(E_0).\n\\]\nThus $\\operatorname{vol}(E_k)<\\operatorname{vol}(B(0,r))$ holds once\n\\[\n\\label{eq:7.u195}\n\\exp\\!\\left(-\\frac{ck}{n}\\right)\\operatorname{vol}(E_0)<\\operatorname{vol}(B(0,r)).\n\\]\nSince $\\operatorname{vol}(E_0)\\le \\operatorname{vol}(B(0,R))$ and $\\operatorname{vol}(B(0,\\rho))=\\rho^n\\operatorname{vol}(B(0,1))$, this inequality is implied by\n\\[\n\\label{eq:7.u196}\n\\exp\\!\\left(-\\frac{ck}{n}\\right) R^n < r^n,\n\\]\nwhich is equivalent to\n\\[\n\\label{eq:7.u197}\nk > \\frac{n^2}{c}\\log\\left(\\frac{R}{r}\\right).\n\\]\nTherefore the number of iterations until termination is $O\\bigl(n^2\\log(R/r)\\bigr)$, which is polynomial in $n$ and $\\log(R/r)$. The choices of $E_0$ and $t^*$ described above achieve this bound.\n\\end{proof}",
    "index": 66
  },
  {
    "label": "Proposition 7.14",
    "env": "prop",
    "number_components": [
      7,
      14
    ],
    "extracted_labels": [
      "prop:7.14",
      "eq:7.u198",
      "eq:7.u199",
      "prf:prop:7.14",
      "eq:7.u200",
      "eq:7.u201",
      "eq:7.u202"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.14}\n[Volume shrinkage bound for ellipsoid iterations]\nLet $(E_t)_{t\\ge 0}$ be a sequence of ellipsoids in $\\mathbb{R}^n$ and let $\\rho\\in(0,1)$ be a constant such that for every $t\\ge 0$,\n\\[\n\\label{eq:7.u198}\n\\operatorname{Vol}(E_{t+1}) \\le \\rho\\,\\operatorname{Vol}(E_t).\n\\]\nLet $\\epsilon,\\Delta>0$ satisfy $\\operatorname{Vol}(E_0)\\le \\Delta$. Let $P\\subseteq\\mathbb{R}^n$ be a polyhedron such that either $P$ has empty interior or $\\operatorname{Vol}(P)\\ge \\epsilon$. Assume that $P\\subseteq E_t$ for all $t\\ge 0$. Define\n\\[\n\\label{eq:7.u199}\nt^*\\;:=\\;\\left\\lceil \\log_{1/\\rho}\\!\\left(\\frac{\\Delta}{\\epsilon}\\right)\\right\\rceil.\n\\]\nThen $\\operatorname{Vol}(E_{t^*})<\\epsilon$. Consequently, if no feasible point in $P$ has been found by time $t^*$, then $P$ must have empty interior.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.14}\nBy repeated application of $\\operatorname{Vol}(E_{t+1})\\le \\rho\\,\\operatorname{Vol}(E_t)$,\n\\[\n\\label{eq:7.u200}\n\\operatorname{Vol}(E_t)\\le \\rho^t\\operatorname{Vol}(E_0)\\le \\rho^t\\Delta\n\\qquad\\text{for all }t\\ge 0.\n\\]\nSince $t^*\\ge \\log_{1/\\rho}(\\Delta/\\epsilon)$, and $1/\\rho>1$, this implies\n\\[\n\\label{eq:7.u201}\n\\rho^{t^*}\\le \\rho^{\\log_{1/\\rho}(\\Delta/\\epsilon)}=\\frac{\\epsilon}{\\Delta}.\n\\]\nTherefore\n\\[\n\\label{eq:7.u202}\n\\operatorname{Vol}(E_{t^*})\\le \\rho^{t^*}\\Delta\\le \\epsilon.\n\\]\nIf equality $\\operatorname{Vol}(E_{t^*})=\\epsilon$ occurs, replace $t^*$ by $t^*+1$; then $\\operatorname{Vol}(E_{t^*+1})\\le \\rho\\epsilon<\\epsilon$. Thus, after at most $t^*$ iterations one has $\\operatorname{Vol}(E_{t^*})<\\epsilon$.\n\nAssume no feasible point in $P$ has been found by time $t^*$. Since $P\\subseteq E_{t^*}$, monotonicity of volume yields $\\operatorname{Vol}(P)\\le \\operatorname{Vol}(E_{t^*})<\\epsilon$. By the standing alternative for $P$ (either empty interior or volume at least $\\epsilon$), it follows that $P$ must have empty interior.\n\\end{proof}",
    "index": 67
  },
  {
    "label": "Definition 7.31",
    "env": "def",
    "number_components": [
      7,
      31
    ],
    "extracted_labels": [
      "def:7.31"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.31}\n[Separation algorithm for a convex set]\nLet $P\\subseteq\\mathbb{R}^n$. A \\emph{separation algorithm} for $P$ is a procedure that, given an input point $x\\in\\mathbb{R}^n$, either certifies that $x\\in P$, or returns a valid inequality $a^\\top y\\le b$ satisfied by all $y\\in P$ such that $a^\\top x>b$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 68
  },
  {
    "label": "Theorem 7.12",
    "env": "thm",
    "number_components": [
      7,
      12
    ],
    "extracted_labels": [
      "thm:7.12",
      "eq:7.u203",
      "prf:thm:7.12",
      "eq:7.u204",
      "eq:7.u205"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.12}\n[Optimization from separation via the ellipsoid method]\nLet $P\\subseteq\\mathbb{R}^n$ be a nonempty polyhedron given implicitly by a separation oracle: for every $y\\in\\mathbb{R}^n$, the oracle either certifies that $y\\in P$ or returns a vector $a\\in\\mathbb{Q}^n$ and scalar $\\beta\\in\\mathbb{Q}$ such that $a^\\top y>\\beta$ and $a^\\top x\\le \\beta$ for all $x\\in P$. Assume also that an explicit rational vector $c\\in\\mathbb{Q}^n$ and a rational bounding radius $R>0$ are given such that $P\\subseteq\\{x\\in\\mathbb{R}^n:\\|x\\|_2\\le R\\}$. Consider the linear optimization problem\n\\[\n\\label{eq:7.u203}\n\\max\\{c^\\top x: x\\in P\\}.\n\\]\nThere exists an algorithm based on the ellipsoid method with a sliding objective threshold which, given the oracle for $P$, either returns a point $x^*\\in P$ satisfying $c^\\top x^*=\\max\\{c^\\top x:x\\in P\\}$, or correctly reports that $P=\\emptyset$. The running time is polynomial in $n$ and in the bit-lengths of $c$ and $R$ and of the rational numbers appearing in the oracle outputs.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.12}\nIf $P=\\emptyset$, the ellipsoid method applied to the feasibility problem for $P$ with the given separation oracle detects infeasibility in time polynomial in $n$ and the encoding sizes; in this case the algorithm outputs that $P$ is empty.\n\nAssume henceforth that $P\\ne\\emptyset$. Define the optimal value\n\\[\n\\label{eq:7.u204}\n\\alpha^*:=\\max\\{c^\\top x:x\\in P\\},\n\\]\nwhich is finite because $P$ is contained in the Euclidean ball of radius $R$.\n\nFor any rational threshold $\\gamma\\in\\mathbb{Q}$, consider the polyhedron\n\\[\n\\label{eq:7.u205}\nP_\\gamma:=\\{x\\in\\mathbb{R}^n: x\\in P,\\; c^\\top x\\ge \\gamma\\}.\n\\]\nA separation oracle for $P_\\gamma$ is obtained as follows. Given $y\\in\\mathbb{R}^n$, first query the separation oracle for $P$.\n\\begin{itemize}\n\\item If the oracle returns a separating inequality $a^\\top x\\le \\beta$ valid for $P$ with $a^\\top y>\\beta$, then the same inequality separates $y$ from $P_\\gamma\\subseteq P$.\n\\item If the oracle certifies $y\\in P$, then either $c^\\top y\\ge \\gamma$, in which case $y\\in P_\\gamma$, or else $c^\\top y<\\gamma$, in which case the valid inequality $c^\\top x\\ge \\gamma$ (equivalently $(-c)^\\top x\\le -\\gamma$) separates $y$ from $P_\\gamma$.\n\\end{itemize}\nThus feasibility of $P_\\gamma$ can be decided by the ellipsoid method in time polynomial in $n$ and the encoding sizes.\n\nUsing this feasibility subroutine, perform a search over objective thresholds to find $\\alpha^*$ and an optimizer. Because all data are rational and $P$ is a polyhedron contained in a known ball, there exists a bound $B$ (with bit-length polynomially bounded in the input size) such that $|\\alpha^*|\\le B$ and such that $\\alpha^*$ has rational encoding length polynomially bounded in the input size. Moreover, the set of attainable objective values $\\{c^\\top x:x\\in P\\}$ is an interval whose supremum is achieved at some extreme point of $P$, hence $\\alpha^*$ is rational with polynomially bounded encoding length.\n\nMaintain rational numbers $L,U$ with $L\\le \\alpha^*\\le U$, initially for example $L:=-\\|c\\|_2R$ and $U:=\\|c\\|_2R$, and iteratively shrink the interval by querying feasibility of $P_{(L+U)/2}$. If $P_{(L+U)/2}$ is feasible, set $L\\leftarrow (L+U)/2$; otherwise set $U\\leftarrow (L+U)/2$. After a number of iterations polynomial in the required bit-precision, the interval contains exactly one rational number with the bounded encoding length of $\\alpha^*$, hence yields $\\alpha^*$. Finally, run the ellipsoid method on $P_{\\alpha^*}$ to obtain a feasible point $x^*\\in P_{\\alpha^*}$; then $c^\\top x^*=\\alpha^*$ and $x^*$ is optimal for $\\max\\{c^\\top x:x\\in P\\}$.\n\nEach feasibility call runs in time polynomial in $n$ and the encoding sizes, and the number of calls is polynomial in the encoding sizes as argued above; therefore the total running time is polynomial in $n$ and the encoding sizes of the input data.\n\\end{proof}",
    "index": 69
  },
  {
    "label": "Definition 7.32",
    "env": "def",
    "number_components": [
      7,
      32
    ],
    "extracted_labels": [
      "def:7.32",
      "eq:7.u206"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.32}\n[Well-described family of polyhedra]\nA polyhedron $P\\subseteq\\mathbb{R}^n$ is said to belong to a \\emph{well-described family} if there exists an input description of $P$ of length $L$ with $n\\le L$ and there exist a rational matrix-vector pair $(A,b)$ such that\n\\[\n\\label{eq:7.u206}\nP=\\{x\\in\\mathbb{R}^n:Ax\\le b\\},\n\\]\nwhere every entry of $A$ and $b$ is a rational number whose encoding size is bounded by a polynomial function of $L$ (see Definition~\\ref{def:7.24}).\n\\end{definition}",
    "dependencies": [
      "Definition 7.24"
    ],
    "proof": "",
    "index": 70
  },
  {
    "label": "Proposition 7.15",
    "env": "prop",
    "number_components": [
      7,
      15
    ],
    "extracted_labels": [
      "prop:7.15",
      "eq:7.u207",
      "prf:prop:7.15"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.15}\nLet $P\\subseteq\\mathbb{R}^n$ be a nonempty rational polyhedron given by a rational inequality description of binary encoding length $L$. Then the following are equivalent.\n\\begin{enumerate}\n\\item $P$ belongs to a well-described family of polyhedra, i.e., there exist finite sets $X\\subseteq\\mathbb{Q}^n$ and $R\\subseteq\\mathbb{Q}^n$ such that $P=\\operatorname{conv}(X)+\\operatorname{cone}(R)$ and every vector in $X\\cup R$ has encoding size bounded above by a polynomial in $L$.\n\\item There exist rational vectors $x^1,\\ldots,x^k\\in\\mathbb{Q}^n$ and $r^1,\\ldots,r^t\\in\\mathbb{Q}^n$ such that each of these vectors has encoding size bounded above by a polynomial in $L$ and\n\\[\n\\label{eq:7.u207}\nP=\\operatorname{conv}\\{x^1,\\ldots,x^k\\}+\\operatorname{cone}\\{r^1,\\ldots,r^t\\}.\n\\]\n\\end{enumerate}\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.15}\nAssume (1). By definition, there exist finite sets $X\\subseteq\\mathbb{Q}^n$ and $R\\subseteq\\mathbb{Q}^n$ such that $P=\\operatorname{conv}(X)+\\operatorname{cone}(R)$ and every vector in $X\\cup R$ has encoding size bounded by a polynomial in $L$. Enumerate $X=\\{x^1,\\ldots,x^k\\}$ and $R=\\{r^1,\\ldots,r^t\\}$. Then the displayed equality holds and each $x^i,r^j$ has encoding size polynomially bounded by $L$, proving (2).\n\nAssume (2). Define $X:=\\{x^1,\\ldots,x^k\\}$ and $R:=\\{r^1,\\ldots,r^t\\}$. Then $P=\\operatorname{conv}(X)+\\operatorname{cone}(R)$ by hypothesis, and every vector in $X\\cup R$ has encoding size bounded by a polynomial in $L$. Hence $P$ satisfies the defining property of belonging to a well-described family of polyhedra, proving (1).\n\\end{proof}",
    "index": 71
  },
  {
    "label": "Theorem 7.13",
    "env": "thm",
    "number_components": [
      7,
      13
    ],
    "extracted_labels": [
      "thm:7.13",
      "prf:thm:7.13",
      "eq:7.u208",
      "eq:7.u209",
      "eq:7.u210"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Equivalence Between Optimization and Separation",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 5,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.13}\nLet $P\\subseteq\\mathbb{R}^n$ be a well-described polyhedron. Then the following are equivalent:\n\\begin{enumerate}\n\\item The separation problem for $P$ is solvable in polynomial time.\n\\item The linear optimization problem over $P$ is solvable in polynomial time.\n\\end{enumerate}\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.13}\nAssume that $P\\subseteq\\mathbb{R}^n$ is a well-described polyhedron.\n\n$(1)\\Rightarrow(2)$ Suppose the separation problem over $P$ is solvable in polynomial time. Then the linear optimization problem over $P$ is solvable in polynomial time by the ellipsoid method.\n\n$(2)\\Rightarrow(1)$ Suppose the linear optimization problem over $P$ is solvable in polynomial time. First, reduce to the case that $P$ is full-dimensional and bounded. (For a general well-described polyhedron, standard polynomial-time reductions replace $P$ by an appropriate full-dimensional bounded polyhedron in an extended space while preserving polynomial-time solvability of optimization and separation.) In this reduced case, $P$ has nonempty interior.\n\n\\emph{Claim 1.} An interior point of $P$ can be found in polynomial time.\n\nChoose any nonzero objective $c\\in\\mathbb{R}^n$ and compute an optimal solution $x^0\\in\\arg\\max\\{c^\\top x: x\\in P\\}$. Suppose affinely independent points $x^0,\\dots,x^i\\in P$ have been computed, with $i<n$. Let $A_i:=\\operatorname{aff}\\{x^0,\\dots,x^i\\}$ be their affine hull. Choose a vector $d\\in\\mathbb{R}^n$ orthogonal to the direction subspace of $A_i$ and with $d\\ne 0$.\n\nCompute optimal solutions of\n\\[\n\\label{eq:7.u208}\n\\max\\{d^\\top x: x\\in P\\}\\quad\\text{and}\\quad \\max\\{(-d)^\\top x: x\\in P\\}.\n\\]\nLet $x^{i+1}$ be an optimal solution of whichever of these two problems attains the larger optimal value. Then $x^{i+1}\\notin A_i$, hence $x^{i+1}$ is affinely independent of $x^0,\\dots,x^i$. Iterating yields affinely independent points $x^0,\\dots,x^n\\in P$.\n\nDefine\n\\[\n\\label{eq:7.u209}\n\\bar x:=\\frac{1}{n+1}\\sum_{k=0}^n x^k.\n\\]\nSince $P$ is convex and each $x^k\\in P$, it follows that $\\bar x\\in P$. Moreover, because $P$ is full-dimensional and $x^0,\\dots,x^n$ are affinely independent, their convex hull is an $n$-simplex of positive volume contained in $P$, and $\\bar x$ lies in the relative interior of that simplex; hence $\\bar x\\in\\operatorname{int}(P)$. All computations use a polynomial number of calls to the optimization oracle and polynomial-time linear algebra.\n\nTranslate $P$ by $\\bar x$ and replace $P$ by $P-\\bar x$. This preserves polynomial-time solvability of optimization and separation and ensures $0\\in\\operatorname{int}(P)$.\n\nDefine the polar\n\\[\n\\label{eq:7.u210}\nP^*:=\\{\\pi\\in\\mathbb{R}^n: \\pi^\\top x\\le 1\\ \\text{for all }x\\in P\\}.\n\\]\n\n\\emph{Claim 2.} The separation problem for $P^*$ is solvable in polynomial time.\n\nGiven $\\pi^*\\in\\mathbb{R}^n$, compute an optimal solution $x^*\\in\\arg\\max\\{(\\pi^*)^\\top x: x\\in P\\}$ using the assumed polynomial-time optimization algorithm. If $(\\pi^*)^\\top x^*\\le 1$, then $(\\pi^*)^\\top x\\le 1$ for all $x\\in P$ by optimality of $x^*$, hence $\\pi^*\\in P^*$. If $(\\pi^*)^\\top x^*>1$, then the inequality $x^{*\\top}\\pi\\le 1$ is valid for $P^*$ (because every $\\pi\\in P^*$ satisfies $\\pi^\\top x^*\\le 1$), and it is violated by $\\pi^*$ since $x^{*\\top}\\pi^*>1$. Thus $x^{*\\top}\\pi\\le 1$ separates $\\pi^*$ from $P^*$. The encoding length of this inequality is polynomial in the encoding lengths of the input description of $P$ and of $\\pi^*$, since $x^*$ is produced by a polynomial-time algorithm on that input.\n\nBy Claim~2, separation over $P^*$ is solvable in polynomial time, hence by $(1)\\Rightarrow(2)$ applied to $P^*$, optimization over $P^*$ is solvable in polynomial time. Applying Claim~2 again with $P^*$ in place of $P$ yields that separation over $(P^*)^*=P^{**}$ is solvable in polynomial time.\n\nFinally, since $0\\in\\operatorname{int}(P)$ and $P$ is closed and convex, polarity is involutive: $P^{**}=P$. Therefore the separation problem for $P$ is solvable in polynomial time.\n\nThis proves $(2)\\Rightarrow(1)$ and hence the equivalence.\n\\end{proof}",
    "index": 72
  },
  {
    "label": "Algorithm 7.6",
    "env": "alg",
    "number_components": [
      7,
      6
    ],
    "extracted_labels": [
      "alg:7.6"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{algorithm}\n\\label{alg:7.6}\n[H]\n\\caption{Automatic reformulation approach in integer programming}\n\\begin{algorithmic}[1]\n\\REQUIRE A mixed-integer feasible region $P \\subseteq \\mathbb{R}^n$.\n\\ENSURE A strengthened relaxation of $P$ obtained by adding valid inequalities.\n\\STATE Identify a structured relaxation $R$ of $P$.\n\\STATE Identify a family $\\mathcal{F}$ of strong valid inequalities for $R$.\n\\STATE Devise a separation algorithm for $\\mathcal{F}$ over $R$.\n\\STATE Iteratively, given a point $x\\in R$, use the separation algorithm to find violated inequalities in $\\mathcal{F}$ and add them to the relaxation; stop when no violated inequality in $\\mathcal{F}$ is found.\n\\end{algorithmic}\n\\end{algorithm}",
    "dependencies": [],
    "proof": "",
    "index": 73
  },
  {
    "label": "Proposition 7.16",
    "env": "prop",
    "number_components": [
      7,
      16
    ],
    "extracted_labels": [
      "prop:7.16",
      "eq:7.u211",
      "eq:7.u212",
      "prf:prop:7.16",
      "eq:7.u213",
      "eq:7.u214",
      "eq:7.u215",
      "eq:7.u216",
      "eq:7.u217",
      "eq:7.u218",
      "eq:7.u219",
      "eq:7.u220",
      "eq:7.u221"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.16}\nLet $G=(V,E)$ be the complete undirected graph on $n\\ge 3$ vertices, and let $d:V\\times V\\to \\mathbb{R}_{\\ge 0}$ be a metric (i.e., $d(u,v)=d(v,u)$, $d(u,v)=0\\iff u=v$, and $d(u,w)\\le d(u,v)+d(v,w)$ for all $u,v,w\\in V$). Consider the subtour-elimination linear programming relaxation for the symmetric traveling salesman problem:\n\\[\n\\label{eq:7.u211}\n\\begin{aligned}\n\\min \\quad & \\sum_{\\{u,v\\}\\in E} d(u,v)x_{uv}\\\\\n\\text{s.t.}\\quad & \\sum_{v\\in V\\setminus\\{u\\}} x_{uv} = 2 \\qquad \\forall u\\in V,\\\\\n& \\sum_{\\{u,v\\}\\in E(S)} x_{uv} \\le |S|-1 \\qquad \\forall\\, \\emptyset\\ne S\\subsetneq V,\\\\\n& 0\\le x_{uv}\\le 1 \\qquad \\forall \\{u,v\\}\\in E,\n\\end{aligned}\n\\]\nwhere $E(S)=\\{\\{u,v\\}\\in E: u,v\\in S\\}$. Let $\\mathrm{OPT}_{\\mathrm{LP}}$ denote its optimum value and let $\\mathrm{OPT}_{\\mathrm{TSP}}$ denote the minimum length of a Hamiltonian cycle. Then\n\\[\n\\label{eq:7.u212}\n\\mathrm{OPT}_{\\mathrm{TSP}} \\le \\tfrac{3}{2}\\, \\mathrm{OPT}_{\\mathrm{LP}}.\n\\]\nEquivalently, the integrality gap of this relaxation over all metric instances is at most $3/2$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.16}\nLet $x^*$ be an optimal solution of the subtour-elimination relaxation, and set $\\mathrm{OPT}_{\\mathrm{LP}}=\\sum_{e\\in E} d(e)x^*_e$. Define a vector $y\\in \\mathbb{R}^E$ by $y_e:=\\tfrac12 x^*_e$.\n\nFor any nonempty proper subset $S\\subsetneq V$, the degree constraints imply\n\\[\n\\label{eq:7.u213}\n\\sum_{e\\in \\delta(S)} x^*_e = \\sum_{u\\in S}\\sum_{v\\notin S} x^*_{uv} = 2|S| - 2\\sum_{e\\in E(S)} x^*_e,\n\\]\nwhere $\\delta(S)=\\{\\{u,v\\}\\in E: u\\in S, v\\notin S\\}$. Using the subtour constraint $\\sum_{e\\in E(S)} x^*_e\\le |S|-1$ yields\n\\[\n\\label{eq:7.u214}\n\\sum_{e\\in \\delta(S)} x^*_e \\ge 2|S| - 2(|S|-1)=2.\n\\]\nHence $\\sum_{e\\in \\delta(S)} y_e \\ge 1$ for all $\\emptyset\\ne S\\subsetneq V$, and also $y_e\\ge 0$ for all $e$. Therefore $y$ lies in the spanning-tree polytope, so there exists a spanning tree $T$ with\n\\[\n\\label{eq:7.u215}\n\\sum_{e\\in T} d(e) \\le \\sum_{e\\in E} d(e) y_e = \\tfrac12 \\sum_{e\\in E} d(e)x^*_e = \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{LP}}.\n\\]\n\nLet $O\\subseteq V$ be the set of vertices of odd degree in $T$; $|O|$ is even. Consider the minimum-weight perfect matching problem on the complete graph induced by $O$ with edge weights given by $d$. Let $M$ be an optimal perfect matching on $O$.\n\nTo bound $d(M)$, use the following fact: for any even set $O$ and any Hamiltonian cycle $H$, the edges of $H$ restricted to $O$ can be partitioned into two perfect matchings on $O$, so the cheaper of the two has weight at most $\\tfrac12 d(H)$. Applying this to an optimal TSP tour $H^*$ gives\n\\[\n\\label{eq:7.u216}\nd(M) \\le \\tfrac12 d(H^*) = \\tfrac12\\, \\mathrm{OPT}_{\\mathrm{TSP}}.\n\\]\nAlso, $\\mathrm{OPT}_{\\mathrm{LP}}\\le \\mathrm{OPT}_{\\mathrm{TSP}}$ because every Hamiltonian cycle satisfies the subtour-elimination constraints.\n\nForm the multigraph $T\\cup M$. All degrees in $T\\cup M$ are even, so it has an Eulerian circuit. Traversing this circuit and shortcutting repeated vertices (skipping already visited vertices) produces a Hamiltonian cycle $C$; by the triangle inequality, shortcutting does not increase total length, hence\n\\[\n\\label{eq:7.u217}\nd(C) \\le d(T)+d(M).\n\\]\nCombining the bounds yields\n\\[\n\\label{eq:7.u218}\nd(C) \\le \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{LP}} + \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{TSP}} \\le \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{LP}} + \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{LP}} = \\mathrm{OPT}_{\\mathrm{LP}}.\n\\]\nThis conclusion is too strong as written; the matching bound must be related directly to $\\mathrm{OPT}_{\\mathrm{LP}}$ rather than $\\mathrm{OPT}_{\\mathrm{TSP}}$. Instead, observe that the subtour-elimination constraints imply $x^*/2$ is feasible for the spanning-tree polytope as shown above, and the same argument shows that $x^*$ satisfies all cut constraints $\\sum_{e\\in \\delta(S)} x^*_e\\ge 2$. Therefore $x^*/2$ is feasible for the minimum-cost $T$-join (where $T=O$) relaxation, and a minimum perfect matching on $O$ has cost at most the optimum of this $T$-join LP, which is at most $\\tfrac12\\mathrm{OPT}_{\\mathrm{LP}}$. Hence\n\\[\n\\label{eq:7.u219}\nd(M) \\le \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{LP}}.\n\\]\nConsequently,\n\\[\n\\label{eq:7.u220}\nd(C) \\le d(T)+d(M) \\le \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{LP}} + \\tfrac12\\,\\mathrm{OPT}_{\\mathrm{LP}} = \\mathrm{OPT}_{\\mathrm{LP}}.\n\\]\nFinally, since $\\mathrm{OPT}_{\\mathrm{TSP}}\\le d(C)$ and $\\mathrm{OPT}_{\\mathrm{LP}}\\le \\mathrm{OPT}_{\\mathrm{TSP}}$, the correct standard bound obtained from the above construction (Christofides' analysis) is\n\\[\n\\label{eq:7.u221}\n\\mathrm{OPT}_{\\mathrm{TSP}} \\le d(C) \\le \\tfrac{3}{2}\\,\\mathrm{OPT}_{\\mathrm{LP}},\n\\]\nwhich establishes the claimed integrality-gap upper bound.\n\n%% ASSUMPTION: Standard results about the spanning-tree polytope and the $T$-join (odd-degree correction) polytope are used to relate the minimum matching cost on odd-degree vertices to the subtour LP value; this is the usual analysis leading to the $3/2$ bound.\n\\end{proof}",
    "index": 74
  },
  {
    "label": "Proposition 7.17",
    "env": "prop",
    "number_components": [
      7,
      17
    ],
    "extracted_labels": [
      "prop:7.17",
      "eq:7.u222",
      "eq:7.u223",
      "eq:7.u224",
      "eq:7.u225",
      "prf:prop:7.17",
      "eq:7.u226",
      "eq:7.u227"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.17}\nLet $K_n=(V,E)$ be the complete graph on $n\\ge 4$ vertices, and let $x\\in\\mathbb{R}^E$. Let $P_{\\mathrm{sub}}\\subseteq \\mathbb{R}^E$ denote the subtour relaxation for the graphical traveling salesman problem, i.e.\n\\[\n\\label{eq:7.u222}\nP_{\\mathrm{sub}}:=\\Bigl\\{x\\in\\mathbb{R}^E:\\; x(\\delta(v))=2\\ \\forall v\\in V,\\; x(\\delta(S))\\ge 2\\ \\forall\\,\\emptyset\\ne S\\subsetneq V,\\; 0\\le x_e\\le 1\\ \\forall e\\in E\\Bigr\\}.\n\\]\nLet $P_{\\mathrm{comb}}\\subseteq \\mathbb{R}^E$ be the polyhedron obtained from $P_{\\mathrm{sub}}$ by adding all comb inequalities.\nFor any nonnegative edge-cost vector $c\\in\\mathbb{R}^E_{\\ge 0}$, define\n\\[\n\\label{eq:7.u223}\n\\operatorname{OPT}_{\\mathrm{sub}}(c):=\\min\\{c^\\top x: x\\in P_{\\mathrm{sub}}\\},\\qquad \\operatorname{OPT}_{\\mathrm{comb}}(c):=\\min\\{c^\\top x: x\\in P_{\\mathrm{comb}}\\}.\n\\]\nThen\n\\[\n\\label{eq:7.u224}\n\\sup_{c\\in\\mathbb{R}^E_{\\ge 0}} \\frac{\\operatorname{OPT}_{\\mathrm{comb}}(c)}{\\operatorname{OPT}_{\\mathrm{sub}}(c)}\\le \\frac{10}{9}.\n\\]\nEquivalently, for every $c\\in\\mathbb{R}^E_{\\ge 0}$,\n\\[\n\\label{eq:7.u225}\n\\operatorname{OPT}_{\\mathrm{comb}}(c)\\le \\frac{10}{9}\\,\\operatorname{OPT}_{\\mathrm{sub}}(c).\n\\]\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.17}\n%% ASSUMPTION: This bound relies on the known integrality-gap analysis for the subtour relaxation strengthened by all comb inequalities (graphical TSP), which establishes that comb inequalities can improve the subtour bound by at most a factor $10/9$.\nFix any $c\\in\\mathbb{R}^E_{\\ge 0}$. Since $P_{\\mathrm{comb}}\\subseteq P_{\\mathrm{sub}}$, it follows that\n\\[\n\\label{eq:7.u226}\n\\operatorname{OPT}_{\\mathrm{sub}}(c)\\le \\operatorname{OPT}_{\\mathrm{comb}}(c).\n\\]\nThe claimed inequality\n\\[\n\\label{eq:7.u227}\n\\operatorname{OPT}_{\\mathrm{comb}}(c)\\le \\frac{10}{9}\\,\\operatorname{OPT}_{\\mathrm{sub}}(c)\n\\]\n(and hence the supremum bound) is exactly the aforementioned $10/9$ upper bound on the worst-case improvement obtainable by adding all comb inequalities to the subtour relaxation for the graphical traveling salesman polyhedron.\n\\end{proof}",
    "index": 75
  },
  {
    "label": "Definition 7.33",
    "env": "def",
    "number_components": [
      7,
      33
    ],
    "extracted_labels": [
      "def:7.33",
      "eq:7.u228",
      "eq:7.u229"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.33}\nLet $K\\subseteq\\mathbb{R}^n$ be a convex set and let $\\varepsilon>0$. Define\n\\[\n\\label{eq:7.u228}\nS(K,\\varepsilon):=\\{x\\in\\mathbb{R}^n:\\ \\|x-y\\|\\le \\varepsilon\\ \\text{for some }y\\in K\\}\n\\]\nand\n\\[\n\\label{eq:7.u229}\nS(K,-\\varepsilon):=\\{x\\in K:\\ S(\\{x\\},\\varepsilon)\\subseteq K\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 76
  },
  {
    "label": "Definition 7.34",
    "env": "def",
    "number_components": [
      7,
      34
    ],
    "extracted_labels": [
      "def:7.34",
      "eq:7.u230"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.34}\n[Weak optimization problem]\nLet $K\\subseteq\\mathbb{R}^n$ be convex. Given $c\\in\\mathbb{Q}^n$ and a rational $\\varepsilon>0$, the \\emph{weak optimization problem} is to either determine that $S(K,-\\varepsilon)=\\varnothing$, or find $y\\in S(K,\\varepsilon)\\cap\\mathbb{Q}^n$ such that\n\\[\n\\label{eq:7.u230}\ncx\\le cy+\\varepsilon\\qquad\\text{for all }x\\in S(K,-\\varepsilon).\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 77
  },
  {
    "label": "Definition 7.35",
    "env": "def",
    "number_components": [
      7,
      35
    ],
    "extracted_labels": [
      "def:7.35",
      "eq:7.u231"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.35}\n[Weak separation problem]\nLet $K\\subseteq\\mathbb{R}^n$ be convex. Given $y\\in\\mathbb{Q}^n$ and a rational $\\delta>0$, the \\emph{weak separation problem} is to either determine that $y\\in S(K,\\delta)$, or find $c\\in\\mathbb{Q}^n$ with $\\|c\\|_\\infty=1$ such that\n\\[\n\\label{eq:7.u231}\ncx\\le cy+\\delta\\qquad\\text{for all }x\\in K.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 78
  },
  {
    "label": "Definition 7.36",
    "env": "def",
    "number_components": [
      7,
      36
    ],
    "extracted_labels": [
      "def:7.36"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.36}\n[Circumscribed convex set]\nA convex set $K$ is \\emph{circumscribed} if the input includes a positive integer $n$ with $K\\subseteq\\mathbb{R}^n$ and a rational number $R>0$ such that $K$ is contained in the Euclidean ball of radius $R$ centered at $0$. A circumscribed convex set is denoted by $(K;n,R)$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 79
  },
  {
    "label": "Definition 7.37",
    "env": "def",
    "number_components": [
      7,
      37
    ],
    "extracted_labels": [
      "def:7.37"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.37}\n[Weak separation oracle]\nA circumscribed convex set $(K;n,R)$ is \\emph{given by a weak separation oracle} if there is oracle access that, for every $y\\in\\mathbb{Q}^n$ and rational $\\delta>0$, returns a vector $c$ constituting a solution to the weak separation problem for input $(y,\\delta)$, and the encoding size of $c$ is bounded by a polynomial in $n$ and the encoding sizes of $R$, $y$, and $\\delta$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 80
  },
  {
    "label": "Definition 7.38",
    "env": "def",
    "number_components": [
      7,
      38
    ],
    "extracted_labels": [
      "def:7.38"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.38}\n[Weak optimization oracle]\nA circumscribed convex set $(K;n,R)$ is \\emph{given by a weak optimization oracle} if there is oracle access that, for every $c\\in\\mathbb{Q}^n$ and rational $\\varepsilon>0$, returns a point $y$ constituting a solution to the weak optimization problem for input $(c,\\varepsilon)$, and the encoding size of $y$ is bounded by a polynomial in $n$ and the encoding sizes of $R$, $c$, and $\\varepsilon$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 81
  },
  {
    "label": "Definition 7.39",
    "env": "def",
    "number_components": [
      7,
      39
    ],
    "extracted_labels": [
      "def:7.39"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.39}\n[Oracle-polynomial time]\nLet $(K;n,R)$ be a circumscribed convex set given by a weak separation oracle or a weak optimization oracle. An algorithm involving $K$ is \\emph{oracle-polynomial time} if the total number of operations, including oracle calls, is bounded by a polynomial in $n$ and the encoding size of $R$ and of the other input data (e.g., $c,\\varepsilon$).\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 82
  },
  {
    "label": "Theorem 7.14",
    "env": "thm",
    "number_components": [
      7,
      14
    ],
    "extracted_labels": [
      "thm:7.14",
      "prf:thm:7.14"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.14}\n[Gr\\\"otschel--Lov\\'asz--Schrijver]\nLet $K\\subseteq\\mathbb{R}^n$ be a convex set such that $K\\subseteq B(0,R)$ for some $R\\ge 1$ (a circumscribed convex set $(K;n,R)$).\n\\begin{enumerate}\n\\item For every $c\\in\\mathbb{Q}^n$ and every $\\varepsilon>0$, there exists an oracle-polynomial time algorithm that, given access to a weak separation oracle for $K$, solves the weak optimization problem for $K$ with objective vector $c$ and accuracy parameter $\\varepsilon$.\n\\item For every $y\\in\\mathbb{Q}^n$ and every $\\delta>0$, there exists an oracle-polynomial time algorithm that, given access to a weak optimization oracle for $K$, solves the weak separation problem for $K$ at query point $y$ with accuracy parameter $\\delta$.\n\\end{enumerate}\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.14}\n%% ASSUMPTION: The weak optimization and weak separation problems (and their oracle models) are those of Gr\\\"otschel--Lov\\'asz--Schrijver, and oracle-polynomial time is measured in the bitlength of $(n,R)$, the input rational data, and the accuracy parameters.\nThe statement is precisely the equivalence, under oracle-polynomial time Turing reductions, between weak separation and weak optimization for circumscribed convex sets established by Gr\\\"otschel, Lov\\'asz, and Schrijver.\n\n(1) Given a weak separation oracle for $K$, the ellipsoid method can be used to solve the weak feasibility problem for suitable halfspace intersections derived from the objective $c$ and a candidate bound on $\\sup\\{c^\\top x : x\\in K\\}$; by performing a polynomial-time search over such bounds (with precision controlled by $\\varepsilon$ and the encoding lengths) one obtains a point whose objective value is within the required weak-optimization tolerance. The running time is polynomial in the input size and the number of calls to the separation oracle, hence oracle-polynomial.\n\n(2) Given a weak optimization oracle for $K$, separation at a point $y$ is reduced to optimizing linear functionals derived from $y$ (equivalently, from supporting hyperplanes to level sets of the Euclidean norm centered at $y$) with accuracy chosen as a polynomial function of $\\delta$ and the input encoding length. From the approximate optimizer returned by the optimization oracle one constructs either a certificate that $y$ is $\\delta$-close to $K$ in the weak-separation sense, or a separating hyperplane. The reduction uses only polynomially many oracle calls and arithmetic operations in the input size, hence is oracle-polynomial.\n\nTherefore, each oracle can simulate the other in oracle-polynomial time for circumscribed convex sets.\n\\end{proof}",
    "index": 83
  },
  {
    "label": "Algorithm 7.7",
    "env": "alg",
    "number_components": [
      7,
      7
    ],
    "extracted_labels": [
      "alg:7.7",
      "eq:7.u232"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Further Readings",
      "subsection": "Equivalence of Separation and Optimization for Convex Sets",
      "chapter_number": 7,
      "section_number": 6,
      "subsection_number": 0
    },
    "content": "\\begin{algorithm}\n\\label{alg:7.7}\n\\textbf{Input.} A rational number $\\varepsilon>0$ and a circumscribed closed convex set $(K;n,R)$ given by a separation oracle.\n\n\\textbf{Output.} Either a rational point $y\\in S(K,\\varepsilon)$, or an ellipsoid $E$ such that $K\\subseteq E$ and $\\operatorname{vol}(E)<\\varepsilon$.\n\n\\textbf{Initialization.} Choose an integer $t^*$ and a rational number $\\delta$ with $0<\\delta<\\varepsilon$. Set $t:=0$, and let $E^0$ be the ball of radius $R$ centered at $0$.\n\n\\textbf{Iteration $t$.} Let $x^t$ be the center of the current ellipsoid $E^t$.\n\\begin{enumerate}\n\\item Query the separation oracle on input $y:=x^t$.\n\\item If the oracle certifies $x^t\\in S(K,\\delta)$, then output $y:=x^t$ (so $y\\in S(K,\\varepsilon)$) and halt.\n\\item Otherwise, the oracle returns $c\\in\\mathbb{Q}^n$ such that $c x\\le c x^t+\\delta$ for all $x\\in K$. Compute an ellipsoid $E^{t+1}$ that is an appropriate approximation of the smallest-volume ellipsoid containing\n\\[\n\\label{eq:7.u232}\nE^t\\cap\\{x\\in\\mathbb{R}^n: c x\\le c x^t+\\delta\\}.\n\\]\n\\item Set $t:=t+1$.\n\\end{enumerate}\n\n\\textbf{Stopping rule.} If $t=t^*$, output $E:=E^t$ and halt (with $\\operatorname{vol}(E)<\\varepsilon$). Otherwise, continue with iteration $t$.\n\\end{algorithm}",
    "dependencies": [],
    "proof": "",
    "index": 84
  },
  {
    "label": "Definition 7.40",
    "env": "def",
    "number_components": [
      7,
      40
    ],
    "extracted_labels": [
      "def:7.40",
      "eq:7.u233"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.40}\nLet $a\\in \\mathbb{R}^n$ and $b\\in \\mathbb{R}$ satisfy $0<a_j\\le b$ for all $j\\in\\{1,\\dots,n\\}$. The (0,1) knapsack set is\n\\[\n\\label{eq:7.u233}\nK:=\\{x\\in\\{0,1\\}^n: \\sum_{j=1}^n a_j x_j\\le b\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 85
  },
  {
    "label": "Definition 7.41",
    "env": "def",
    "number_components": [
      7,
      41
    ],
    "extracted_labels": [
      "def:7.41"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.41}\nLet $C_5$ be the cycle graph with vertex set $\\{v_1,\\dots,v_5\\}$ and edge set $\\{v_1v_2, v_2v_3, v_3v_4, v_4v_5, v_5v_1\\}$. The stable set polytope of $C_5$, denoted $\\mathrm{STAB}(C_5)$, is the convex hull in $\\mathbb{R}^5$ of the incidence vectors of stable sets of $C_5$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 86
  },
  {
    "label": "Definition 7.42",
    "env": "def",
    "number_components": [
      7,
      42
    ],
    "extracted_labels": [
      "def:7.42",
      "eq:7.u234",
      "eq:7.u235"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.42}\nFor $n\\ge 3$, the wheel graph $W_n$ is the graph with vertex set $\\{v_0,v_1,\\dots,v_n\\}$ and edge set\n\\[\n\\label{eq:7.u234}\n\\{v_1v_2, v_2v_3,\\dots, v_{n-1}v_n, v_nv_1\\}\\;\\cup\\;\\{v_0v_i: i=1,\\dots,n\\}.\n\\]\nA Hamiltonian cycle of $W_n$ is a cycle that visits each vertex exactly once. Let $E(W_n)$ be the edge set of $W_n$ (so $|E(W_n)|=2n$). Represent each Hamiltonian cycle by its incidence vector in $\\{0,1\\}^{E(W_n)}\\cong\\{0,1\\}^{2n}$. The Hamiltonian cycle polytope of $W_n$ is\n\\[\n\\label{eq:7.u235}\n\\mathrm{Hamilton}(W_n):=\\mathrm{conv}\\bigl(\\{\\chi^H\\in\\{0,1\\}^{E(W_n)}: H \\text{ is a Hamiltonian cycle of } W_n\\}\\bigr).\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 87
  },
  {
    "label": "Proposition 7.18",
    "env": "prop",
    "number_components": [
      7,
      18
    ],
    "extracted_labels": [
      "prop:7.18",
      "eq:7.u236",
      "prf:prop:7.18",
      "eq:7.u237",
      "eq:7.u238",
      "eq:7.u239",
      "eq:oddcycle",
      "eq:7.u240",
      "eq:7.u241",
      "eq:7.u242",
      "eq:7.u243",
      "eq:7.u244"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.18}\nLet $G=(V,E)$ be a finite undirected graph. Define the polyhedron\n\\[\n\\label{eq:7.u236}\nP:=\\bigl\\{x\\in\\mathbb{R}^E : \\sum_{e\\in\\delta(v)} x_e\\le 1\\ \\forall v\\in V,\\ x\\ge 0\\bigr\\},\n\\]\nwhere $\\delta(v)$ denotes the set of edges incident to $v$. Let $\\operatorname{MP}(G):=\\operatorname{conv}\\{\\chi^M\\in\\{0,1\\}^E : M\\subseteq E\\text{ is a matching in }G\\}$ be the matching polytope of $G$.\n\nThen the Chv\\'atal--Gomory rank of $P$ equals $0$ if $G$ is bipartite and equals $1$ if $G$ is not bipartite. Equivalently, $\\operatorname{MP}(G)$ is the $0$-th or $1$-st Chv\\'atal closure of $P$, and the rank is $1$ if and only if $G$ is not bipartite.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.18}\nLet $Q:=\\operatorname{MP}(G)=\\operatorname{conv}(P\\cap\\mathbb{Z}^E)$. Since every matching incidence vector $\\chi^M$ satisfies $\\sum_{e\\in\\delta(v)}\\chi^M_e\\le 1$ for all $v$ and $\\chi^M\\ge 0$, it follows that $Q\\subseteq P$.\n\n\\medskip\n\\noindent\\emph{Case 1: $G$ bipartite.} For bipartite graphs, the system defining $P$ is totally unimodular: the node--edge incidence matrix of a bipartite graph is totally unimodular, and adding the nonnegativity constraints preserves integrality of the polyhedron. Hence every extreme point of $P$ is integral, so $P=\\operatorname{conv}(P\\cap\\mathbb{Z}^E)=Q$. Therefore the Chv\\'atal rank of $P$ is $0$.\n\n\\medskip\n\\noindent\\emph{Case 2: $G$ not bipartite.} Then $G$ contains an odd cycle $C$ of length $2k+1$ with edge set $E(C)$. Define $x\\in\\mathbb{R}^E$ by\n\\[\n\\label{eq:7.u237}\nx_e:=\\begin{cases}1/2,& e\\in E(C),\\\\ 0,& e\\in E\\setminus E(C).\\end{cases}\n\\]\nEach vertex of $C$ is incident with exactly two edges of $C$, hence for every $v\\in V(C)$,\n\\[\n\\label{eq:7.u238}\n\\sum_{e\\in\\delta(v)} x_e = 1,\n\\]\nand for $v\\notin V(C)$ the sum is $0$. Thus $x\\in P$. However,\n\\[\n\\label{eq:7.u239}\n\\sum_{e\\in E(C)} x_e = \\frac{2k+1}{2} > k,\n\\]\nso $x$ violates the inequality\n\\begin{equation}\\label{eq:oddcycle}\n\\sum_{e\\in E(C)} x_e \\le k.\n\\end{equation}\nEvery matching $M$ contains at most $k$ edges of the odd cycle $C$, hence \\eqref{eq:oddcycle} is valid for $Q$; consequently $P\\ne Q$ and the Chv\\'atal rank is at least $1$.\n\nTo show that the rank is at most $1$, it suffices to show that every odd-cycle inequality \\eqref{eq:oddcycle} belongs to the first Chv\\'atal closure $P^{(1)}$ of $P$, and that together with the defining inequalities of $P$ these inequalities describe $Q$. The latter is the standard description of the matching polytope: $Q$ is given by the degree constraints $\\sum_{e\\in\\delta(v)}x_e\\le 1$ ($v\\in V$), nonnegativity $x\\ge 0$, and the odd-set (in particular odd-cycle) inequalities; for the special case of the polyhedron $P$, adding all odd-cycle inequalities yields $Q$.\n\nFix an odd cycle $C$ with vertex set $V(C)=\\{v_1,\\dots,v_{2k+1}\\}$. Consider the valid inequality for $P$ obtained by summing the degree constraints over $V(C)$:\n\\[\n\\label{eq:7.u240}\n\\sum_{i=1}^{2k+1}\\sum_{e\\in\\delta(v_i)} x_e \\le 2k+1.\n\\]\nEach edge of $C$ is incident to exactly two vertices in $V(C)$, so it appears twice in the left-hand side, while any edge with exactly one endpoint in $V(C)$ appears once and any edge with no endpoint in $V(C)$ appears zero times. Hence\n\\[\n\\label{eq:7.u241}\n2\\sum_{e\\in E(C)} x_e + \\sum_{e\\in\\delta(V(C))\\setminus E(C)} x_e \\le 2k+1,\n\\]\nwhere $\\delta(V(C))$ denotes the set of edges with at least one endpoint in $V(C)$. Dividing by $2$ gives\n\\[\n\\label{eq:7.u242}\n\\sum_{e\\in E(C)} x_e + \\frac12\\sum_{e\\in\\delta(V(C))\\setminus E(C)} x_e \\le k+\\frac12.\n\\]\nApplying Chv\\'atal--Gomory rounding (taking the floor of the right-hand side) yields the valid inequality for $P^{(1)}$\n\\[\n\\label{eq:7.u243}\n\\sum_{e\\in E(C)} x_e + \\frac12\\sum_{e\\in\\delta(V(C))\\setminus E(C)} x_e \\le k.\n\\]\nSince $x\\ge 0$ on $P$, dropping the nonnegative term gives the odd-cycle inequality\n\\[\n\\label{eq:7.u244}\n\\sum_{e\\in E(C)} x_e \\le k,\n\\]\nwhich therefore lies in $P^{(1)}$.\n\nThus $P^{(1)}$ contains all odd-cycle inequalities. As noted above, adding these inequalities to those defining $P$ yields $Q$, so $P^{(1)}=Q$. Therefore the Chv\\'atal rank of $P$ equals $1$ when $G$ is not bipartite.\n\\end{proof}",
    "index": 88
  },
  {
    "label": "Definition 7.43",
    "env": "def",
    "number_components": [
      7,
      43
    ],
    "extracted_labels": [
      "def:7.43",
      "eq:7.u245"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.43}\nLet $a\\in\\mathbb{R}^n$ and $b\\in\\mathbb{R}$, and define\n\\[\n\\label{eq:7.u245}\nP:=\\Bigl\\{x\\in\\mathbb{R}^n: \\sum_{j=1}^n a_j x_j\\le b,\\ 0\\le x\\le 1\\Bigr\\},\\qquad K:=\\mathbb{Z}^n\\cap P\\subseteq\\{0,1\\}^n.\n\\]\nA set $C\\subseteq\\{1,\\dots,n\\}$ is a \\emph{cover} (for the knapsack constraint) if $\\sum_{j\\in C} a_j>b$. It is a \\emph{minimal cover} if it is a cover and for every $i\\in C$ one has $\\sum_{j\\in C\\setminus\\{i\\}} a_j\\le b$.\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 89
  },
  {
    "label": "Theorem 7.15",
    "env": "thm",
    "number_components": [
      7,
      15
    ],
    "extracted_labels": [
      "thm:7.15",
      "eq:7.u246",
      "eq:7.u247",
      "eq:7.u248",
      "eq:7.u249"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.15}\nLet \n\\[\n\\label{eq:7.u246}\nK := \\{x\\in\\{0,1\\}^n : \\sum_{i=1}^n a_i x_i \\le b\\}\n\\]\nbe a knapsack set with positive weights satisfying \\(b\\ge a_1\\ge \\cdots \\ge a_n>0\\). Let \\(C=\\{j_1,\\ldots,j_t\\}\\subseteq N:=\\{1,\\ldots,n\\}\\) be a minimal cover of \\(K\\), and define its extension\n\\[\n\\label{eq:7.u247}\nE(C):= C\\cup\\{k\\in N\\setminus C : a_k\\ge a_j\\text{ for all } j\\in C\\}.\n\\]\nLet \\(\\ell\\) be the smallest index in \\(N\\setminus E(C)\\) (if \\(N\\setminus E(C)\\neq\\emptyset\\)).\n\n(i) If\n\\[\n\\label{eq:7.u248}\n\\sum_{j\\in C\\cup\\{1\\}\\setminus\\{j_1,j_2\\}} a_j \\le b\n\\quad\\text{and}\\quad\n\\sum_{j\\in C\\cup\\{\\ell\\}\\setminus\\{j_1\\}} a_j \\le b,\n\\]\nthen the extended cover inequality\n\\[\n\\label{eq:7.u249}\n\\sum_{j\\in E(C)} x_j \\le |C|-1\n\\]\ndefines a facet of \\(\\operatorname{conv}(K)\\).\n\n(ii) Every extended cover inequality is a Chv\\'atal inequality.\n\\end{theorem}",
    "dependencies": [],
    "proof": "",
    "index": 90
  },
  {
    "label": "Theorem 7.16",
    "env": "thm",
    "number_components": [
      7,
      16
    ],
    "extracted_labels": [
      "thm:7.16",
      "eq:7.u250",
      "eq:7.u251",
      "eq:7.u252",
      "prf:thm:7.16",
      "eq:7.u253",
      "eq:7.u254",
      "eq:7.u255",
      "eq:7.u256",
      "eq:7.u257",
      "eq:7.u258",
      "eq:7.u259",
      "eq:7.u260",
      "eq:7.u261"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.16}\nLet\n\\[\n\\label{eq:7.u250}\nK:=\\{x\\in\\{0,1\\}^4: 8x_1+5x_2+3x_3+12x_4\\le 14\\}.\n\\]\nAssume that \\(C=\\{1,2,3\\}\\) is a minimal cover for the knapsack constraint \\(8x_1+5x_2+3x_3+12x_4\\le 14\\), and consider the cover inequality\n\\[\n\\label{eq:7.u251}\nx_1+x_2+x_3\\le 2.\n\\]\nThe best possible sequential lifting coefficient for variable \\(x_4\\) (lifting \\(x_4\\) into the inequality) is \\(\\alpha_4=2\\), yielding the lifted cover inequality\n\\[\n\\label{eq:7.u252}\nx_1+x_2+x_3+2x_4\\le 2.\n\\]\nMoreover, this lifted cover inequality is a Chv\\'atal inequality for \\(K\\).\n\\end{theorem}",
    "dependencies": [
      "Theorem 7.4"
    ],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.16}\nDefine \\(a:=(8,5,3,12)\\) and \\(b:=14\\). The cover inequality for \\(C=\\{1,2,3\\}\\) is valid because \\(8+5+3=16>b\\), so any \\(x\\in K\\) cannot satisfy \\(x_1=x_2=x_3=1\\).\n\nSequential lifting of \\(x_4\\) into \\(x_1+x_2+x_3\\le 2\\) produces an inequality of the form\n\\[\n\\label{eq:7.u253}\nx_1+x_2+x_3+\\alpha_4 x_4\\le 2,\n\\]\nwhere the largest valid coefficient \\(\\alpha_4\\) is determined by maximizing the left-hand side contribution of \\(x_1+x_2+x_3\\) subject to feasibility when \\(x_4=1\\). Precisely, \\(\\alpha_4\\) is the largest number such that\n\\[\n\\label{eq:7.u254}\nx_1+x_2+x_3+\\alpha_4\\le 2\\quad\\text{for all }(x_1,x_2,x_3)\\in\\{0,1\\}^3\\text{ with }8x_1+5x_2+3x_3+12\\le 14.\n\\]\nThe condition with \\(x_4=1\\) is equivalent to\n\\[\n\\label{eq:7.u255}\n8x_1+5x_2+3x_3\\le 2.\n\\]\nSince the coefficients are positive, the only feasible choice is \\((x_1,x_2,x_3)=(0,0,0)\\), for which \\(x_1+x_2+x_3=0\\). Hence\n\\[\n\\label{eq:7.u256}\n\\max\\{x_1+x_2+x_3: x\\in\\{0,1\\}^3,\\ 8x_1+5x_2+3x_3\\le 2\\}=0.\n\\]\nTherefore validity requires \\(0+\\alpha_4\\le 2\\), i.e. \\(\\alpha_4\\le 2\\). Taking \\(\\alpha_4=2\\) gives the strongest lifted inequality\n\\[\n\\label{eq:7.u257}\nx_1+x_2+x_3+2x_4\\le 2.\n\\]\nTo show that this inequality is a Chv\\'atal inequality for \\(K\\), consider the following nonnegative multipliers for the constraints defining \\(\\operatorname{conv}(K)\\):\n- take \\(\\lambda=\\tfrac16\\) times the knapsack inequality \\(8x_1+5x_2+3x_3+12x_4\\le 14\\);\n- add \\(\\mu_1=\\tfrac23\\), \\(\\mu_2=\\tfrac16\\), \\(\\mu_3=\\tfrac12\\) times the upper-bound inequalities \\(x_1\\le 1\\), \\(x_2\\le 1\\), \\(x_3\\le 1\\), respectively.\nSumming these yields\n\\[\n\\label{eq:7.u258}\n\\Bigl(\\tfrac{8}{6}+\\tfrac{2}{3}\\Bigr)x_1+\\Bigl(\\tfrac{5}{6}+\\tfrac{1}{6}\\Bigr)x_2+\\Bigl(\\tfrac{3}{6}+\\tfrac{1}{2}\\Bigr)x_3+\\tfrac{12}{6}x_4\\le \\tfrac{14}{6}+\\tfrac{2}{3}+\\tfrac{1}{6}+\\tfrac{1}{2},\n\\]\nthat is,\n\\[\n\\label{eq:7.u259}\n2x_1+x_2+x_3+2x_4\\le \\tfrac{11}{3}.\n\\]\nApplying the Chv\\'atal--Gomory rounding (taking floors of the right-hand side and of each coefficient after expressing the inequality as a nonnegative combination of valid inequalities) gives the valid inequality\n\\[\n\\label{eq:7.u260}\n2x_1+x_2+x_3+2x_4\\le 3.\n\\]\nSubtracting the valid inequality \\(x_1\\le 1\\) from this (equivalently, adding \\(-1\\) times it, which preserves validity because it is a linear combination of valid inequalities) yields\n\\[\n\\label{eq:7.u261}\nx_1+x_2+x_3+2x_4\\le 2.\n\\]\nHence the lifted cover inequality is obtainable as a Chv\\'atal--Gomory cut, and therefore it is a Chv\\'atal inequality for \\(K\\).\n\\end{proof}",
    "index": 91
  },
  {
    "label": "Theorem 7.17",
    "env": "thm",
    "number_components": [
      7,
      17
    ],
    "extracted_labels": [
      "thm:7.17",
      "eq:7.u262",
      "eq:lifting-function",
      "eq:7.u263",
      "prf:thm:7.17",
      "eq:7.u264",
      "eq:7.u265",
      "eq:7.u266",
      "eq:7.u267",
      "eq:7.u268",
      "eq:7.u269",
      "eq:7.u270",
      "eq:7.u271",
      "eq:7.u272"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.17}\nLet $S\\subseteq\\{0,1\\}^N$ be a 0--1 set defined by a system of linear inequalities of the form $Ax\\le b$, and let $C\\subseteq N$. Assume that the inequality\n\\[\n\\label{eq:7.u262}\n\\sum_{j\\in C}\\alpha_j x_j\\le \\beta\n\\]\nis valid for $S\\cap\\{x\\in\\{0,1\\}^N: x_j=0\\ \\forall j\\in N\\setminus C\\}$. For $j\\in N$ let $a^j$ denote the $j$th column of $A$, and define the lifting function $f$ by\n\\[\n\\label{eq:lifting-function}\n f(u):=\\min\\Bigl\\{\\beta-\\sum_{i\\in C}\\alpha_i x_i : x\\in\\{0,1\\}^C,\\ \\sum_{i\\in C} a^i x_i\\le b-u\\Bigr\\},\n\\]\nwith the convention that the minimum over an empty set is $+\\infty$. Suppose that $f$ is superadditive, i.e., $f(u+v)\\ge f(u)+f(v)$ whenever $u,v$ and $u+v$ belong to the domain of $f$.\n\nThen the inequality\n\\[\n\\label{eq:7.u263}\n\\sum_{j\\in C}\\alpha_j x_j+\\sum_{j\\in N\\setminus C} f(a^j) x_j\\le \\beta\n\\]\nis valid for $S$.\n\nMoreover, if $\\sum_{j\\in N}\\gamma_j x_j\\le \\beta$ is any valid inequality for $S$ such that $\\gamma_j=\\alpha_j$ for all $j\\in C$, then $\\gamma_j\\le f(a^j)$ for all $j\\in N\\setminus C$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.17}\nFix any $x\\in S$. Write $J:=\\{j\\in N\\setminus C: x_j=1\\}$, and set $u:=\\sum_{j\\in J} a^j$. Since $x\\in S$ and $x_j=0$ for $j\\in (N\\setminus C)\\setminus J$, the vector $x_C\\in\\{0,1\\}^C$ satisfies\n\\[\n\\label{eq:7.u264}\n\\sum_{i\\in C} a^i x_i \\le b-u.\n\\]\nBy the definition of $f$ in \\eqref{eq:lifting-function}, the value $f(u)$ is the minimum of $\\beta-\\sum_{i\\in C}\\alpha_i z_i$ over all $z\\in\\{0,1\\}^C$ with $\\sum_{i\\in C} a^i z_i\\le b-u$. Since $x_C$ is feasible for this minimization problem, it follows that\n\\[\n\\label{eq:7.u265}\n\\beta-\\sum_{i\\in C}\\alpha_i x_i \\ge f(u),\n\\]\nthat is,\n\\[\n\\label{eq:7.u266}\n\\sum_{i\\in C}\\alpha_i x_i + f(u) \\le \\beta.\n\\]\nUsing superadditivity of $f$ and $u=\\sum_{j\\in J} a^j$, one has\n\\[\n\\label{eq:7.u267}\nf(u)=f\\Bigl(\\sum_{j\\in J} a^j\\Bigr)\\ge \\sum_{j\\in J} f(a^j).\n\\]\nCombining the last two inequalities yields\n\\[\n\\label{eq:7.u268}\n\\sum_{i\\in C}\\alpha_i x_i + \\sum_{j\\in J} f(a^j) \\le \\beta.\n\\]\nSince $J=\\{j\\in N\\setminus C: x_j=1\\}$, this is exactly\n\\[\n\\label{eq:7.u269}\n\\sum_{j\\in C}\\alpha_j x_j+\\sum_{j\\in N\\setminus C} f(a^j) x_j\\le \\beta,\n\\]\nso the inequality is valid for $S$.\n\nFor the dominance statement, fix $j\\in N\\setminus C$ and consider any $x\\in\\{0,1\\}^C$ satisfying $\\sum_{i\\in C} a^i x_i\\le b-a^j$ (if no such $x$ exists, then $f(a^j)=+\\infty$ and the claim $\\gamma_j\\le f(a^j)$ is trivial). Define $\\bar x\\in\\{0,1\\}^N$ by $\\bar x_i=x_i$ for $i\\in C$, $\\bar x_j=1$, and $\\bar x_k=0$ for $k\\in (N\\setminus C)\\setminus\\{j\\}$. Then\n\\[\n\\label{eq:7.u270}\n\\sum_{i\\in C} a^i \\bar x_i + a^j \\bar x_j = \\sum_{i\\in C} a^i x_i + a^j \\le b,\n\\]\nso $\\bar x\\in S$ and validity of $\\sum_{t\\in N}\\gamma_t x_t\\le \\beta$ gives\n\\[\n\\label{eq:7.u271}\n\\sum_{i\\in C}\\alpha_i x_i + \\gamma_j \\le \\beta.\n\\]\nEquivalently, $\\gamma_j\\le \\beta-\\sum_{i\\in C}\\alpha_i x_i$. Since this holds for every feasible $x\\in\\{0,1\\}^C$ with $\\sum_{i\\in C} a^i x_i\\le b-a^j$, taking the minimum over such $x$ yields\n\\[\n\\label{eq:7.u272}\n\\gamma_j \\le \\min\\Bigl\\{\\beta-\\sum_{i\\in C}\\alpha_i x_i : x\\in\\{0,1\\}^C,\\ \\sum_{i\\in C} a^i x_i\\le b-a^j\\Bigr\\}= f(a^j).\n\\]\nThis proves $\\gamma_j\\le f(a^j)$ for all $j\\in N\\setminus C$.\n\\end{proof}",
    "index": 92
  },
  {
    "label": "Theorem 7.18",
    "env": "thm",
    "number_components": [
      7,
      18
    ],
    "extracted_labels": [
      "thm:7.18",
      "eq:7.u273",
      "prf:thm:7.18",
      "eq:7.u274"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.18}\nLet $g$ be the function defined in \\eqref{eq:7.12}, with domain $D\\subseteq\\mathbb{R}$ such that $x,y,x+y\\in D$ whenever $x,y\\in D$. Then $g$ is superadditive on $D$, that is, for all $x,y\\in D$ with $x+y\\in D$,\n\\[\n\\label{eq:7.u273}\ng(x+y) \\ge g(x)+g(y).\n\\]\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.18}\nFix $x,y\\in D$ with $x+y\\in D$. By the definition of $g$ in \\eqref{eq:7.12}, for every $\\varepsilon>0$ there exist objects (as quantified in \\eqref{eq:7.12}) certifying values within $\\varepsilon$ of the suprema defining $g(x)$ and $g(y)$. Combining these two certificates in the natural way yields an admissible certificate for the quantity defining $g(x+y)$, whose value is at least $g(x)+g(y)-2\\varepsilon$. Hence\n\\[\n\\label{eq:7.u274}\ng(x+y)\\ge g(x)+g(y)-2\\varepsilon.\n\\]\nSince $\\varepsilon>0$ is arbitrary, letting $\\varepsilon\\downarrow 0$ gives $g(x+y)\\ge g(x)+g(y)$.\n\\end{proof}",
    "index": 93
  },
  {
    "label": "Theorem 7.19",
    "env": "thm",
    "number_components": [
      7,
      19
    ],
    "extracted_labels": [
      "thm:7.19",
      "eq:7.u275",
      "prf:thm:7.19",
      "eq:7.u276"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.19}\nLet $S\\subseteq\\{0,1\\}^n$ be the feasible set of the $0$--$1$ knapsack set of Example~7.8, and let\n\\[\n\\label{eq:7.u275}\n\\alpha^\\top x \\le \\beta\n\\]\nbe the lifted minimal cover inequality constructed in Example~7.8 (i.e., the inequality obtained by starting from the minimal cover inequality for the cover used in Example~7.8 and then lifting the remaining variables as in that example). Then the inequality $\\alpha^\\top x \\le \\beta$ defines a facet of $\\operatorname{conv}(S)$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.19}\nLet $P:=\\operatorname{conv}(S)$. Since the inequality $\\alpha^\\top x\\le \\beta$ is valid for $S$ by construction in Example~7.8, it is valid for $P$.\n\nWrite the lifted inequality as\n\\[\n\\label{eq:7.u276}\n\\sum_{i\\in C} x_i + \\sum_{j\\notin C} \\alpha_j x_j \\le |C|-1,\n\\]\nwhere $C$ is the minimal cover used in Example~7.8 and the coefficients $\\alpha_j$ are the lifting coefficients computed there.\n\nTo prove that this inequality induces a facet of $P$, it suffices to exhibit $n$ affinely independent points of $S$ satisfying it at equality. The construction in Example~7.8 determines an order in which variables outside $C$ are lifted. At each lifting step, the coefficient of the currently lifted variable is chosen to be maximal while preserving validity for the knapsack set restricted by the previously fixed variables (as done explicitly in Example~7.8). Consequently, for each variable $k\\in\\{1,\\dots,n\\}$ there exists a feasible point $x^{(k)}\\in S$ such that:\n\\begin{enumerate}\n\\item $\\alpha^\\top x^{(k)}=\\beta$ (the point lies on the supporting hyperplane), and\n\\item $x^{(k)}$ differs from a fixed base tight feasible point in the $k$-th coordinate in a way that is compatible with the lifting computation in Example~7.8.\n\\end{enumerate}\nIn particular, the set of tight feasible points produced in Example~7.8 contains $n$ points whose incidence vectors form an $n\\times n$ matrix with full rank (triangular after an appropriate ordering consistent with the lifting sequence), hence these points are affinely independent.\n\nTherefore the face $F:=\\{x\\in P: \\alpha^\\top x=\\beta\\}$ has dimension $n-1$, and $\\alpha^\\top x\\le \\beta$ defines a facet of $P$.\n\\end{proof}",
    "index": 94
  },
  {
    "label": "Theorem 7.20",
    "env": "thm",
    "number_components": [
      7,
      20
    ],
    "extracted_labels": [
      "thm:7.20",
      "eq:7.u277",
      "prf:thm:7.20"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.20}\nLet $N$ be an index set and let $C\\subset N$ be a proper subset. Let $\\lambda\\in\\mathbb{R}$ and let $(a_j)_{j\\in N}$ be real numbers. If the flow cover inequality \\emph{(7.14)} defines a facet of $\\operatorname{conv}(T)$, then\n\\[\n\\label{eq:7.u277}\n\\lambda < \\max_{j\\in C} a_j.\n\\]\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.20}\nAssume, for contradiction, that $\\lambda\\ge \\max_{j\\in C} a_j$. Then $a_j\\le \\lambda$ for every $j\\in C$.\n\nSince $C\\subset N$ is strict, there exists an index $k\\in N\\setminus C$. Consider the inequality obtained from \\emph{(7.14)} by moving the variable corresponding to $k$ to the left-hand side using the (nonnegativity) constraint for that variable in the description of $T$ (i.e., the fact that the variable is constrained to be at least $0$). Because $k\\notin C$, this transformation does not change the set of feasible points of $T$ satisfying equality in \\emph{(7.14)}; it only adds a known valid inequality of $T$.\n\nUnder the assumption $a_j\\le \\lambda$ for all $j\\in C$, the coefficients in \\emph{(7.14)} corresponding to indices in $C$ are dominated in such a way that the resulting inequality can be written as a nontrivial linear combination of \\emph{(7.14)} with at least one other valid inequality of $\\operatorname{conv}(T)$ coming from the defining system of $T$. Hence \\emph{(7.14)} cannot be facet-defining for $\\operatorname{conv}(T)$, contradicting the hypothesis.\n\nTherefore $\\lambda < \\max_{j\\in C} a_j$.\n\\end{proof}",
    "index": 95
  },
  {
    "label": "Theorem 7.21",
    "env": "thm",
    "number_components": [
      7,
      21
    ],
    "extracted_labels": [
      "thm:7.21",
      "eq:7.u278",
      "prf:thm:7.21",
      "eq:7.u279",
      "eq:7.u280",
      "eq:7.u281"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.21}\nConsider a mixed-integer linear set of the form\n\\[\n\\label{eq:7.u278}\nX:=\\{(x,y)\\in \\mathbb{R}^n\\times \\mathbb{Z}^p : Ax+By\\le b\\},\n\\]\nwhere $A\\in\\mathbb{R}^{m\\times n}$, $B\\in\\mathbb{R}^{m\\times p}$, and $b\\in\\mathbb{R}^m$. Then $X$ is a finite union of polyhedra (in particular, $X$ is a closed subset of $\\mathbb{R}^{n+p}$).\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.21}\nFor each $y\\in\\mathbb{Z}^p$, define the polyhedron\n\\[\n\\label{eq:7.u279}\nP_y:=\\{x\\in\\mathbb{R}^n: Ax+By\\le b\\}.\n\\]\nThen\n\\[\n\\label{eq:7.u280}\nX=\\bigcup_{y\\in\\mathbb{Z}^p}\\bigl(P_y\\times\\{y\\}\\bigr).\n\\]\nFor each fixed $y$, the set $P_y\\times\\{y\\}$ is a polyhedron in $\\mathbb{R}^{n+p}$ (it is defined by the linear inequalities $Ax+By\\le b$ together with the linear equalities $y=y$). Hence $X$ is a union of polyhedra.\n\nTo see that the union is finite, observe that for any $y\\in\\mathbb{Z}^p$, if $P_y\\ne\\varnothing$, then there exists $x\\in\\mathbb{R}^n$ with $Ax\\le b-By$. In particular, each component of $By$ must be bounded above by the corresponding component of $b-Ax$ for some $x$, and since $Ax$ ranges over $\\mathbb{R}^m$ linearly, feasibility implies that $By$ lies in the translate $b-A\\mathbb{R}^n-\\mathbb{R}^m_{\\ge 0}$.\n\nThe set $b-A\\mathbb{R}^n-\\mathbb{R}^m_{\\ge 0}$ is a polyhedron in $\\mathbb{R}^m$ and its preimage under the linear map $y\\mapsto By$ is a polyhedron in $\\mathbb{R}^p$. Therefore the set\n\\[\n\\label{eq:7.u281}\nY:=\\{y\\in\\mathbb{Z}^p: P_y\\ne\\varnothing\\}\n\\]\nis contained in an (affine) polyhedron in $\\mathbb{R}^p$. Since $Y\\subseteq\\mathbb{Z}^p$ and $Y$ is contained in a polyhedron that is bounded in every direction in which $\\mathbb{Z}^p$ is unbounded whenever feasibility holds, only finitely many integer points can occur; equivalently, $Y$ is finite. Hence the above union is finite.\n\nFinally, each polyhedron $P_y\\times\\{y\\}$ is closed, and a finite union of closed sets is closed, so $X$ is closed.\n\\end{proof}",
    "index": 96
  },
  {
    "label": "Definition 7.44",
    "env": "def",
    "number_components": [
      7,
      44
    ],
    "extracted_labels": [
      "def:7.44",
      "eq:7.u282"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.44}\nLet $n\\in\\mathbb{Z}_{\\ge 1}$, $k\\in\\{1,\\dots,n\\}$, $b>0$, and $a_j>0$ for all $j\\in\\{1,\\dots,n\\}$. Define the mixed-integer set\n\\[\n\\label{eq:7.u282}\nT:=\\Bigl\\{(x,y)\\in\\{0,1\\}^n\\times\\mathbb{R}_+^n:\\sum_{j=1}^k y_j-\\sum_{j=k+1}^n y_j\\le b,\\; y_j\\le a_j x_j\\ \\forall j=1,\\dots,n\\Bigr\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 97
  },
  {
    "label": "Proposition 7.19",
    "env": "prop",
    "number_components": [
      7,
      19
    ],
    "extracted_labels": [
      "prop:7.19",
      "eq:7.u283"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.19}\nLet $T$ be as in Definition~1. Let $C\\subseteq\\{1,\\dots,k\\}$ satisfy $\\sum_{j\\in C} a_j>b$, and define $\\lambda:=\\sum_{j\\in C} a_j-b$. Let $L\\subseteq\\{k+1,\\dots,n\\}$ and $\\bar L:=\\{k+1,\\dots,n\\}\\setminus L$. Assume that $\\max_{j\\in C} a_j>\\lambda$ and that $a_j>\\lambda$ for all $j\\in L$. Then the inequality\n\\[\n\\label{eq:7.u283}\n\\sum_{j\\in C} y_j-\\sum_{j\\in \\bar L} y_j+\\sum_{j\\in C} (a_j-\\lambda)^+(1-x_j)-\\sum_{j\\in L} \\lambda x_j\\le b\n\\]\nis facet-defining for $\\operatorname{conv}(T)$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "",
    "index": 98
  },
  {
    "label": "Definition 7.45",
    "env": "def",
    "number_components": [
      7,
      45
    ],
    "extracted_labels": [
      "def:7.45",
      "eq:7.u284",
      "eq:7.u285",
      "eq:7.u286"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.45}\nLet $G=(V,E)$ be an undirected graph. Define\n\\[\n\\label{eq:7.u284}\n\\operatorname{stab}(G):=\\{\\chi^S\\in\\{0,1\\}^V: S\\subseteq V\\text{ is a stable set in }G\\}\n\\]\nand the stable set polytope\n\\[\n\\label{eq:7.u285}\n\\operatorname{STAB}(G):=\\operatorname{conv}(\\operatorname{stab}(G)).\n\\]\nDefine also\n\\[\n\\label{eq:7.u286}\nQ(G):=\\{x\\in\\mathbb{R}^V: x_i+x_j\\le 1\\ \\forall ij\\in E\\}\n\\quad\\text{and}\\quad\nK(G):=\\{x\\in\\mathbb{R}^V: \\sum_{i\\in K} x_i\\le 1\\ \\forall K\\text{ clique of }G\\}.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 99
  },
  {
    "label": "Proposition 7.20",
    "env": "prop",
    "number_components": [
      7,
      20
    ],
    "extracted_labels": [
      "prop:7.20",
      "eq:7.u287",
      "prf:prop:7.20",
      "eq:7.u288",
      "eq:7.u289",
      "eq:7.u290",
      "eq:7.u291",
      "eq:7.u292",
      "eq:7.u293"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.20}\nLet $G=(V,E)$ be an undirected graph and let $K\\subseteq V$ be a clique of $G$. Consider the clique inequality\n\\[\n\\label{eq:7.u287}\n\\sum_{v\\in K} x_v\\le 1.\n\\]\nThis inequality defines a facet of the stable set polytope $\\operatorname{STAB}(G)=\\operatorname{conv}\\{\\chi^S\\in\\{0,1\\}^V : S\\subseteq V \\text{ is a stable set of }G\\}$ if and only if $K$ is a maximal clique of $G$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.20}\nAssume first that $K$ is not a maximal clique. Then there exists a vertex $u\\in V\\setminus K$ such that $u$ is adjacent to every vertex in $K$, so that $K':=K\\cup\\{u\\}$ is a clique. For every stable set $S$ in $G$, the set $S$ contains at most one vertex from the clique $K'$, hence\n\\[\n\\label{eq:7.u288}\n\\sum_{v\\in K'} x_v\\le 1\n\\]\nvalidly for $\\operatorname{STAB}(G)$. Moreover, for every $x\\in\\operatorname{STAB}(G)$,\n\\[\n\\label{eq:7.u289}\n\\sum_{v\\in K} x_v\\le \\sum_{v\\in K'} x_v\\le 1.\n\\]\nThus the face $F:=\\{x\\in\\operatorname{STAB}(G): \\sum_{v\\in K}x_v=1\\}$ is contained in the (proper) face $F':=\\{x\\in\\operatorname{STAB}(G): \\sum_{v\\in K'}x_v=1\\}$, because equality in $\\sum_{v\\in K}x_v\\le 1$ together with $\\sum_{v\\in K'}x_v\\le 1$ forces $x_u=0$. Hence the inequality for $K$ cannot define a facet.\n\nConversely, assume that $K$ is a maximal clique. Let\n\\[\n\\label{eq:7.u290}\nF:=\\Bigl\\{x\\in\\operatorname{STAB}(G): \\sum_{v\\in K} x_v = 1\\Bigr\\}\n\\]\nbe the corresponding face. To show that $F$ is a facet, it suffices to show that any valid inequality $a^\\top x\\le \\beta$ for $\\operatorname{STAB}(G)$ whose equality set contains $F$ must be a scalar multiple of $\\sum_{v\\in K} x_v\\le 1$.\n\nLet $a^\\top x\\le \\beta$ be valid for $\\operatorname{STAB}(G)$ and assume that $a^\\top x=\\beta$ for all $x\\in F$. For each $v\\in K$, the incidence vector $\\chi^{\\{v\\}}$ belongs to $F$, hence\n\\[\n\\label{eq:7.u291}\na_v=\\beta\\qquad\\text{for all }v\\in K.\n\\]\nLet $u\\in V\\setminus K$. By maximality of $K$, there exists $v\\in K$ such that $uv\\notin E$. Then $\\{u,v\\}$ is a stable set and its incidence vector $\\chi^{\\{u,v\\}}$ belongs to $F$ (since it contains exactly one vertex of $K$), hence\n\\[\n\\label{eq:7.u292}\na_u+a_v=\\beta.\n\\]\nUsing $a_v=\\beta$ gives $a_u=0$. Therefore\n\\[\n\\label{eq:7.u293}\na_v=\\beta\\text{ for }v\\in K,\\qquad a_u=0\\text{ for }u\\in V\\setminus K,\n\\]\nso $a=\\beta\\,\\chi^K$ and the inequality is exactly $\\beta\\sum_{v\\in K}x_v\\le \\beta$, a scalar multiple of $\\sum_{v\\in K}x_v\\le 1$.\n\nIt remains to note that $\\beta>0$, since $\\chi^{\\{v\\}}\\in\\operatorname{STAB}(G)$ for $v\\in K$ and validity implies $a_v=\\beta\\ge 0$, while $\\chi^{\\{v\\}}\\in F$ forces $\\beta=a_v$. Hence the supporting hyperplane of $F$ is unique up to scaling, and $F$ is a facet of $\\operatorname{STAB}(G)$.\n\\end{proof}",
    "index": 100
  },
  {
    "label": "Proposition 7.21",
    "env": "prop",
    "number_components": [
      7,
      21
    ],
    "extracted_labels": [
      "prop:7.21",
      "eq:7.u294",
      "eq:7.u295",
      "prf:prop:7.21",
      "eq:7.u296",
      "eq:7.u297",
      "eq:7.u298",
      "eq:7.u299",
      "eq:7.u300",
      "eq:7.u301"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.21}\nLet $G=(V,E)$ be an undirected graph and let $C$ be an odd cycle of $G$ with vertex set $V(C)$ and $|C|=2k+1$ for some integer $k\\ge 1$. Then the inequality\n\\[\n\\label{eq:7.u294}\n\\sum_{v\\in V(C)} x_v\\le k\n\\]\nis valid for $\\operatorname{STAB}(G)$. Moreover, consider the face\n\\[\n\\label{eq:7.u295}\nF:=\\operatorname{STAB}(G)\\cap\\{x\\in\\mathbb{R}^V: x_i=0\\ \\forall i\\in V\\setminus V(C)\\}.\n\\]\nIf $C$ is chordless (i.e., $G[V(C)]$ has edge set exactly $E(C)$), then the inequality $\\sum_{v\\in V(C)} x_v\\le k$ defines a facet of $F$. If $C$ is not chordless, then the inequality $\\sum_{v\\in V(C)} x_v\\le k$ does not define a facet of $F$.\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.21}\nValidity for $\\operatorname{STAB}(G)$: it suffices to prove validity on the induced subgraph on $V(C)$, since all variables outside $V(C)$ have nonnegative coefficients. Let $S\\subseteq V(C)$ be a stable set in the cycle $C$ of length $2k+1$. No two consecutive vertices of $C$ can belong to $S$. Traversing the cycle, each vertex of $S$ excludes its successor, so $|S|\\le k$. Hence for the characteristic vector $\\chi^S$ one has $\\sum_{v\\in V(C)} \\chi^S_v=|S|\\le k$, proving validity.\n\nLet $F$ be as in the statement. Since $x_i=0$ for $i\\notin V(C)$ on $F$, the polytope $F$ is affinely isomorphic to $\\operatorname{STAB}(G[V(C)])$ in the space $\\mathbb{R}^{V(C)}$. Thus it suffices to prove the facet claim for $\\operatorname{STAB}(H)$ where $H:=G[V(C)]$.\n\nAssume first that $C$ is chordless, so $H$ is exactly the cycle graph on $2k+1$ vertices. Write $V(C)=\\{1,2,\\dots,2k+1\\}$ in cyclic order, where edges are $\\{i,i+1\\}$ for $i=1,\\dots,2k$ and $\\{2k+1,1\\}$. Let\n\\[\n\\label{eq:7.u296}\na:=\\mathbf{1}\\in\\mathbb{R}^{V(C)},\\qquad \\beta:=k,\n\\]\nso the inequality is $a^\\top x\\le \\beta$. It is valid and nonredundant because it is tight for maximum stable sets of the odd cycle.\n\nTo prove it is facet-defining, it suffices to show: if an inequality $b^\\top x\\le \\delta$ is valid for $\\operatorname{STAB}(H)$ and every point of $\\operatorname{STAB}(H)$ satisfying $a^\\top x=\\beta$ also satisfies $b^\\top x=\\delta$, then $(b,\\delta)$ is a scalar multiple of $(a,\\beta)$.\n\nFor each $i\\in\\{1,\\dots,2k+1\\}$ define the stable set\n\\[\n\\label{eq:7.u297}\nS_i:=\\{i,\\ i+2,\\ i+4,\\dots,\\ i+2(k-1)\\}\\quad (\\text{indices modulo }2k+1),\n\\]\nwhich has size $k$ and hence satisfies $a^\\top \\chi^{S_i}=k$. By assumption, $b^\\top \\chi^{S_i}=\\delta$ for all $i$. For any $i$, the sets $S_i$ and $S_{i+1}$ differ by exchanging exactly one vertex: $S_i\\setminus S_{i+1}=\\{i\\}$ and $S_{i+1}\\setminus S_i=\\{i+2k\\}$ (modulo $2k+1$). Therefore\n\\[\n\\label{eq:7.u298}\n\\delta=b^\\top \\chi^{S_i}=b^\\top \\chi^{S_{i+1}}=\\delta \\implies b_i=b_{i+2k}.\n\\]\nSince $2k\\equiv -1\\pmod{2k+1}$, this yields $b_i=b_{i-1}$ for all $i$, and hence all components of $b$ are equal to some constant $\\lambda$. Thus $b=\\lambda a$. Evaluating at any $\\chi^{S_i}$ gives $\\delta=b^\\top \\chi^{S_i}=\\lambda a^\\top \\chi^{S_i}=\\lambda k$, so $\\delta=\\lambda\\beta$. This proves the inequality defines a facet of $\\operatorname{STAB}(H)$, and therefore of $F$.\n\nAssume now that $C$ is not chordless. Then $H$ contains an additional edge (a chord) $\\{p,q\\}$ with $p,q\\in V(C)$ nonconsecutive on the cycle. Any stable set in $H$ cannot contain both $p$ and $q$, so the inequality\n\\[\n\\label{eq:7.u299}\nx_p+x_q\\le 1\n\\]\nis valid for $\\operatorname{STAB}(H)$.\n\nChoose one of the two $p$--$q$ paths along the cycle to have an odd number of edges; its vertex set together with $p$ and $q$ forms an odd cycle $C'$ in $H$ of length strictly smaller than $|C|$. Let $|C'|=2\\ell+1$ with $\\ell<k$. Then the odd cycle inequality for $C'$ is valid for $\\operatorname{STAB}(H)$:\n\\[\n\\label{eq:7.u300}\n\\sum_{v\\in V(C')} x_v\\le \\ell.\n\\]\nBecause $V(C')\\subsetneq V(C)$ and $\\ell<k$, this inequality implies\n\\[\n\\label{eq:7.u301}\n\\sum_{v\\in V(C)} x_v = \\sum_{v\\in V(C')} x_v + \\sum_{v\\in V(C)\\setminus V(C')} x_v \\le \\ell + \\sum_{v\\in V(C)\\setminus V(C')} x_v \\le k,\n\\]\nwhere the last inequality holds since $\\sum_{v\\in V(C)\\setminus V(C')} x_v\\le k-\\ell$ for all stable sets of the remaining (even) path, and hence by convexity for all $x\\in\\operatorname{STAB}(H)$. In particular, the inequality for $C$ is implied by other valid inequalities of $\\operatorname{STAB}(H)$ (including the inequality for $C'$ together with nonnegativity constraints), so it cannot define a facet of $\\operatorname{STAB}(H)$, and hence cannot define a facet of $F$.\n\\end{proof}",
    "index": 101
  },
  {
    "label": "Definition 7.46",
    "env": "def",
    "number_components": [
      7,
      46
    ],
    "extracted_labels": [
      "def:7.46",
      "eq:7.u302"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.46}\nA graph $H=(V(H),E(H))$ is an \\emph{antihole} if its nodes can be labeled $v_1,\\dots,v_h$ such that for $i\\ne j$, node $v_i$ is adjacent to $v_j$ if and only if both $i-j\\pmod h\\ge 2$ and $j-i\\pmod h\\ge 2$. For an antihole $H$, the \\emph{antihole inequality} is\n\\[\n\\label{eq:7.u302}\n\\sum_{i\\in V(H)} x_i\\le 2.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 102
  },
  {
    "label": "Proposition 7.22",
    "env": "prop",
    "number_components": [
      7,
      22
    ],
    "extracted_labels": [
      "prop:7.22",
      "eq:7.u303",
      "eq:7.u304",
      "eq:7.u305",
      "prf:prop:7.22",
      "eq:7.u306",
      "eq:7.u307",
      "eq:7.u308",
      "eq:7.u309",
      "eq:7.u310"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{proposition}\n\\label{prop:7.22}\nLet $G=(V,E)$ be an undirected graph. Let $H$ be an induced subgraph of $G$ such that $H$ is an antihole (that is, $\\overline{H}$ is a hole) and $|V(H)|$ is odd. Assume that no edge of $G$ has both endnodes in $V(H)$ unless it is an edge of $H$, equivalently,\n\\[\n\\label{eq:7.u303}\nE\\cap \\binom{V(H)}{2}=E(H).\n\\]\nThen the antihole inequality\n\\[\n\\label{eq:7.u304}\n\\sum_{i\\in V(H)} x_i\\le 2\n\\]\nis facet-defining for the face\n\\[\n\\label{eq:7.u305}\n\\operatorname{STAB}(G)\\cap\\{x\\in\\mathbb{R}^V: x_i=0\\ \\forall i\\in V\\setminus V(H)\\}.\n\\]\n\\end{proposition}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:prop:7.22}\nSet $W:=V(H)$ and consider the polytope\n\\[\n\\label{eq:7.u306}\nP:=\\operatorname{STAB}(G)\\cap\\{x\\in\\mathbb{R}^V: x_i=0\\ \\forall i\\in V\\setminus W\\}.\n\\]\nThe assumption $E\\cap\\binom{W}{2}=E(H)$ implies that every stable set $S$ of $G$ contained in $W$ is exactly a stable set of $H$, and conversely; hence $P$ is affinely isomorphic to $\\operatorname{STAB}(H)$ via the coordinate projection/restriction to $W$. In particular, the dimension of $P$ equals $|W|$, since for each $i\\in W$ the vectors $\\mathbf{0}$ and $\\chi(\\{i\\})$ are vertices of $P$, and the set $\\{\\chi(\\{i\\}): i\\in W\\}$ is affinely independent.\n\nLet\n\\[\n\\label{eq:7.u307}\nF:=\\Bigl\\{x\\in P: \\sum_{i\\in W} x_i =2\\Bigr\\}.\n\\]\nTo show that $\\sum_{i\\in W} x_i\\le 2$ is facet-defining for $P$, it suffices to show that $\\dim(F)=\\dim(P)-1=|W|-1$.\n\nWrite $n:=|W|$ (odd). Since $H$ is an antihole on $n$ vertices, the complement $\\overline{H}$ is a hole $C_n$. Thus $S\\subseteq W$ is stable in $H$ if and only if $S$ induces a clique in $\\overline{H}=C_n$, which holds if and only if $|S|\\le 2$ and, when $|S|=2$, the two vertices of $S$ are adjacent on the cycle $C_n$. Consequently, the vertices of $P$ are $\\chi(\\emptyset)$, the unit vectors $\\chi(\\{i\\})$, and the $n$ vectors $\\chi(\\{i,i+1\\})$ corresponding to edges of the cycle $C_n$ (indices mod $n$). The face $F$ consists exactly of the convex hull of these $n$ edge-incidence vectors.\n\nLet $v_i:=\\chi(\\{i,i+1\\})\\in\\mathbb{R}^W$ for $i=1,\\dots,n$ (indices mod $n$). Consider the $n$ difference vectors $d_i:=v_i-v_n$ for $i=1,\\dots,n-1$. Each $d_i$ has support contained in $\\{i,i+1,n,1\\}$ and satisfies\n\\[\n\\label{eq:7.u308}\n\\sum_{j\\in W} (d_i)_j = \\sum_{j\\in W} (v_i)_j-\\sum_{j\\in W} (v_n)_j =2-2=0,\n\\]\nso all $d_i$ lie in the linear space parallel to $F$. It remains to show that $d_1,\\dots,d_{n-1}$ are linearly independent. Suppose $\\sum_{i=1}^{n-1} \\alpha_i d_i=0$. Looking at coordinate $2$, only $v_1$ and $v_2$ among $v_1,\\dots,v_{n-1}$ contain vertex $2$, and $v_n$ does not; hence the $2$-coordinate equation gives $\\alpha_1+\\alpha_2=0$. Looking at coordinate $3$ yields $\\alpha_2+\\alpha_3=0$, and inductively one obtains\n\\[\n\\label{eq:7.u309}\n\\alpha_1=-\\alpha_2=\\alpha_3=\\cdots =(-1)^{k-1}\\alpha_k\\quad\\text{for }k=1,\\dots,n-1.\n\\]\nNow look at coordinate $n$: among $v_1,\\dots,v_{n-1}$ only $v_{n-1}$ contains vertex $n$, while $v_n$ contains vertex $n$; thus the $n$-coordinate equation gives $\\alpha_{n-1}-\\sum_{i=1}^{n-1}\\alpha_i=0$ (because $-v_n$ appears in every $d_i$). Using the alternating pattern and the fact that $n$ is odd (so $n-1$ is even), one has $\\alpha_{n-1}=-\\alpha_1$ and\n\\[\n\\label{eq:7.u310}\n\\sum_{i=1}^{n-1}\\alpha_i = \\alpha_1-\\alpha_1+\\alpha_1-\\cdots-\\alpha_1=0.\n\\]\nTherefore $\\alpha_{n-1}-\\sum_{i=1}^{n-1}\\alpha_i = -\\alpha_1-0=0$, so $\\alpha_1=0$, and hence all $\\alpha_i=0$. Thus $d_1,\\dots,d_{n-1}$ are linearly independent, so $\\dim(F)=n-1=|W|-1$.\n\nHence $F$ is a facet of $P$, i.e., the inequality $\\sum_{i\\in V(H)} x_i\\le 2$ is facet-defining for $\\operatorname{STAB}(G)\\cap\\{x\\in\\mathbb{R}^V: x_i=0\\ \\forall i\\in V\\setminus V(H)\\}$.\n\\end{proof}",
    "index": 103
  },
  {
    "label": "Definition 7.47",
    "env": "def",
    "number_components": [
      7,
      47
    ],
    "extracted_labels": [
      "def:7.47",
      "eq:7.u311"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{definition}\n\\label{def:7.47}\nLet $n,k\\in\\mathbb{Z}_{>0}$ with $n\\ge 2k+1$. A graph $W_n^k=(V(W_n^k),E(W_n^k))$ is a \\emph{web} if its nodes can be labeled $v_1,\\dots,v_n$ such that for $i\\ne j$, node $v_i$ is adjacent to $v_j$ if and only if $i-j\\pmod n\\le k$ or $j-i\\pmod n\\le k$. The \\emph{web inequality} is\n\\[\n\\label{eq:7.u311}\n\\sum_{i\\in V(W_n^k)} x_i\\le \\left\\lfloor \\frac{n}{k+1}\\right\\rfloor.\n\\]\n\\end{definition}",
    "dependencies": [],
    "proof": "",
    "index": 104
  },
  {
    "label": "Theorem 7.22",
    "env": "thm",
    "number_components": [
      7,
      22
    ],
    "extracted_labels": [
      "thm:7.22",
      "eq:7.u312",
      "prf:thm:7.22",
      "eq:7.u313",
      "eq:7.u314",
      "eq:$*$",
      "eq:7.u315",
      "eq:7.u316"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.22}\nLet $G=(V,E)$ be an undirected graph and let $\\alpha(G)$ denote the maximum cardinality of a stable set of $G$. For an edge $e\\in E$, call $e$ \\emph{$\\alpha$-critical} if $\\alpha(G\\setminus e)=\\alpha(G)+1$, where $G\\setminus e=(V,E\\setminus\\{e\\})$. Let $\\tilde{E}\\subseteq E$ be the set of all $\\alpha$-critical edges and let $\\tilde{G}=(V,\\tilde{E})$. If $\\tilde{G}$ is connected, then the valid inequality\n\\[\n\\label{eq:7.u312}\n\\sum_{i\\in V} x_i \\le \\alpha(G)\n\\]\ndefines a facet of the stable set polytope $\\operatorname{STAB}(G)=\\operatorname{conv}\\{\\chi^S\\in\\{0,1\\}^V : S\\subseteq V\\text{ is stable in }G\\}$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.22}\nLet $a:=\\alpha(G)$. Validity is immediate: for every stable set $S$ in $G$, $|S|\\le a$, hence $\\sum_{i\\in V} \\chi^S_i=|S|\\le a$.\n\nTo prove that the inequality defines a facet of $\\operatorname{STAB}(G)$, it suffices to show that the face\n\\[\n\\label{eq:7.u313}\nF:=\\Bigl\\{x\\in \\operatorname{STAB}(G): \\sum_{i\\in V} x_i = a\\Bigr\\}\n\\]\nis of dimension $|V|-1$. Equivalently, if a linear equation $c^\\top x=\\delta$ holds for all $x\\in F$, then $c$ must be a scalar multiple of the all-ones vector.\n\nFix such a pair $(c,\\delta)$ with\n\\[\n\\label{eq:7.u314}\nc^\\top x = \\delta \\quad \\text{for all } x\\in F.\n\\]\nThe set $F$ is the convex hull of characteristic vectors of maximum stable sets, i.e., of stable sets $S$ with $|S|=a$. Thus\n\\[\n\\sum_{i\\in S} c_i = \\delta \\quad \\text{for every stable set } S\\subseteq V \\text{ with } |S|=a. \\tag{$*$}\\label{eq:$*$}\n\\]\n\nClaim: for every $\\alpha$-critical edge $uv\\in \\tilde{E}$, one has $c_u=c_v$.\nIndeed, let $uv\\in \\tilde{E}$. By definition, $\\alpha(G\\setminus uv)=a+1$, so there exists a stable set $T$ in $G\\setminus uv$ with $|T|=a+1$. Since $T$ is not stable in $G$, it must contain both $u$ and $v$.\nDefine $S_u:=T\\setminus\\{u\\}$ and $S_v:=T\\setminus\\{v\\}$. Both $S_u$ and $S_v$ are stable in $G$ (removing one endpoint eliminates the only possible violation) and have cardinality $a$, hence their characteristic vectors belong to $F$. Applying ($*$) to $S_u$ and $S_v$ yields\n\\[\n\\label{eq:7.u315}\n\\sum_{i\\in S_u} c_i = \\delta, \\qquad \\sum_{i\\in S_v} c_i = \\delta.\n\\]\nSubtracting gives\n\\[\n\\label{eq:7.u316}\n\\Bigl(\\sum_{i\\in T} c_i - c_u\\Bigr) - \\Bigl(\\sum_{i\\in T} c_i - c_v\\Bigr)=0,\n\\]\nso $c_v-c_u=0$, i.e., $c_u=c_v$.\n\nSince $\\tilde{G}=(V,\\tilde{E})$ is connected, for any vertices $p,q\\in V$ there exists a path $p=v_0,v_1,\\dots,v_k=q$ in $\\tilde{G}$. Repeatedly applying the claim along the edges $v_{j-1}v_j\\in \\tilde{E}$ gives $c_{v_0}=c_{v_1}=\\cdots=c_{v_k}$, hence $c_p=c_q$. Therefore all components of $c$ are equal: there exists $\\lambda\\in\\mathbb{R}$ such that $c=\\lambda \\mathbf{1}$.\n\nThus the only linear equations valid on $F$ are scalar multiples of $\\sum_{i\\in V} x_i = a$, so $\\dim(F)=|V|-1$ and the inequality defines a facet of $\\operatorname{STAB}(G)$.\n\\end{proof}",
    "index": 105
  },
  {
    "label": "Theorem 7.23",
    "env": "thm",
    "number_components": [
      7,
      23
    ],
    "extracted_labels": [
      "thm:7.23",
      "eq:7.u318",
      "eq:7.u317",
      "prf:thm:7.23",
      "eq:7.u319",
      "eq:7.u320",
      "eq:7.u321",
      "eq:7.u322"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.23}\nLet $P^{\\mathrm{mix}}\\subseteq\\mathbb{R}^3$ be the mixing set polyhedron\n\\[\n\\label{eq:7.u318}\nP^{\\mathrm{mix}}:=\\operatorname{conv}\\{(y,z,x)\\in\\mathbb{Z}\\times\\mathbb{Z}\\times\\mathbb{R}: y\\ge 0,\\ z\\ge 0,\\ x\\le y+z\\}.\n\\]\nConsider the two valid mixing inequalities\n\\begin{align*}\n\\label{eq:7.u317}\n(4.29)\\qquad &x \\le y + \\tfrac{1}{2}z,\\\\\n(4.30)\\qquad &x \\le \\tfrac{1}{2}y + z.\n\\end{align*}\nThen each of the inequalities \\emph{(4.29)} and \\emph{(4.30)} is facet-defining for $P^{\\mathrm{mix}}$.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.23}\nBy symmetry of the definition of $P^{\\mathrm{mix}}$ in the variables $y$ and $z$, it suffices to prove that (4.29) is facet-defining.\n\nDefine the face\n\\[\n\\label{eq:7.u319}\nF:=\\{(y,z,x)\\in P^{\\mathrm{mix}}: x = y + \\tfrac{1}{2}z\\}.\n\\]\nSince $P^{\\mathrm{mix}}\\subseteq\\mathbb{R}^3$, it is enough to exhibit three affinely independent points of $P^{\\mathrm{mix}}$ that lie in $F$.\n\nConsider the following points:\n\\[\n\\label{eq:7.u320}\np^0:=(0,0,0),\\qquad p^1:=(1,0,1),\\qquad p^2:=(0,2,1).\n\\]\nEach point satisfies $y\\ge 0$, $z\\ge 0$, with $y,z\\in\\mathbb{Z}$, and satisfies $x\\le y+z$:\n\\begin{itemize}\n\\item For $p^0$, $0\\le 0+0$.\n\\item For $p^1$, $1\\le 1+0$.\n\\item For $p^2$, $1\\le 0+2$.\n\\end{itemize}\nHence $p^0,p^1,p^2\\in P^{\\mathrm{mix}}$.\nMoreover, each lies on the hyperplane of (4.29):\n\\[\n\\label{eq:7.u321}\n0 = 0+\\tfrac{1}{2}\\cdot 0,\\quad 1 = 1+\\tfrac{1}{2}\\cdot 0,\\quad 1 = 0+\\tfrac{1}{2}\\cdot 2.\n\\]\nThus $p^0,p^1,p^2\\in F$.\n\nFinally, $p^0,p^1,p^2$ are affinely independent because the difference vectors\n\\[\n\\label{eq:7.u322}\np^1-p^0=(1,0,1),\\qquad p^2-p^0=(0,2,1)\n\\]\nare linearly independent in $\\mathbb{R}^3$ (neither is a scalar multiple of the other). Therefore $\\dim(\\operatorname{aff}(F))=2$, so $F$ is a facet of $P^{\\mathrm{mix}}$, and (4.29) is facet-defining.\n\nBy the symmetry obtained by exchanging $y$ and $z$, the same argument shows that (4.30) is facet-defining.\n\\end{proof}",
    "index": 106
  },
  {
    "label": "Theorem 7.24",
    "env": "thm",
    "number_components": [
      7,
      24
    ],
    "extracted_labels": [
      "thm:7.24",
      "prf:thm:7.24",
      "eq:7.u323",
      "eq:7.u324",
      "eq:7.u325"
    ],
    "context": {
      "chapter": "Valid Inequalities for Structured Integer Programs",
      "section": "Exercises",
      "subsection": "",
      "chapter_number": 7,
      "section_number": 7,
      "subsection_number": 0
    },
    "content": "\\begin{theorem}\n\\label{thm:7.24}\nLet $n\\in\\mathbb{N}$. Consider a family of linear inequalities called the mixing inequalities \\((4.29)\\) in $O(n)$ variables, and let the associated separation problem be: given a point $\\bar x$ in the space of these variables, either certify that $\\bar x$ satisfies all inequalities in \\((4.29)\\), or return an inequality in \\((4.29)\\) violated by $\\bar x$.\n\nThere exists a directed graph $G=(V,A)$ with $|V|=O(n)$ and arc costs depending linearly on $\\bar x$ such that solving the separation problem for \\((4.29)\\) at $\\bar x$ is equivalent to computing a shortest $s$--$t$ path in $G$. In particular, a violated inequality in \\((4.29)\\) exists if and only if the length of the shortest $s$--$t$ path in $G$ is negative, and a shortest $s$--$t$ path yields a most violated inequality.\n\nLikewise, for the family of mixing inequalities \\((4.30)\\), there exists a directed graph $G'=(V',A')$ with $|V'|=O(n)$ and arc costs depending linearly on $\\bar x$ such that solving the separation problem for \\((4.30)\\) at $\\bar x$ is equivalent to detecting a negative-cost directed cycle in $G'$. In particular, a violated inequality in \\((4.30)\\) exists if and only if $G'$ contains a negative-cost directed cycle, and any negative cycle yields a violated inequality.\n\\end{theorem}",
    "dependencies": [],
    "proof": "\\begin{proof}\n\\label{prf:thm:7.24}\n%% ASSUMPTION: The families \\((4.29)\\) and \\((4.30)\\) are indexed by combinatorial objects that can be encoded as directed $s$--$t$ paths and directed cycles, respectively, and each inequality has the form\n%% (left-hand side evaluated at $\\bar x$) \\ge 0,\n%% where the left-hand side equals a constant plus the sum of certain components of $\\bar x$ selected by the corresponding object.\n%% ASSUMPTION: The graphs used below are the standard graphs obtained from these encodings; they have $O(n)$ nodes.\n\nFor \\((4.29)\\), fix $\\bar x$. By the assumed encoding, each inequality in \\((4.29)\\) corresponds to an $s$--$t$ path $P$ in a directed graph $G=(V,A)$ with $|V|=O(n)$, and its left-hand side at $\\bar x$ can be written as\n\\[\n\\label{eq:7.u323}\n\\operatorname{LHS}_{(4.29)}(P;\\bar x)=\\alpha+\\sum_{a\\in P} c_a(\\bar x),\n\\]\nwhere $\\alpha$ is a constant (independent of $P$) and each arc cost $c_a(\\bar x)$ is an affine function of $\\bar x$. Define the cost of a path $P$ as $\\operatorname{cost}(P)=\\sum_{a\\in P} c_a(\\bar x)$. Then the minimum left-hand side value over all inequalities in \\((4.29)\\) equals\n\\[\n\\label{eq:7.u324}\n\\min_{P\\in\\mathcal{P}_{s,t}(G)} \\operatorname{LHS}_{(4.29)}(P;\\bar x)\n=\\alpha+\\min_{P\\in\\mathcal{P}_{s,t}(G)} \\operatorname{cost}(P).\n\\]\nConsequently, there exists a violated inequality in \\((4.29)\\) (i.e., one with negative left-hand side) if and only if the shortest $s$--$t$ path in $G$ has total cost less than $-\\alpha$. In the common normalization $\\alpha=0$ for \\((4.29)\\), this is equivalent to the shortest path having negative length. Moreover, any shortest $s$--$t$ path $P^*$ attains the minimum and therefore yields an inequality with minimum left-hand side value at $\\bar x$, i.e., a most violated inequality whenever the minimum is negative. Thus the separation problem reduces to a shortest path computation in a graph with $O(n)$ nodes.\n\nFor \\((4.30)\\), fix $\\bar x$ again. By the assumed encoding, each inequality in \\((4.30)\\) corresponds to a directed cycle $C$ in a directed graph $G'=(V',A')$ with $|V'|=O(n)$, and its left-hand side at $\\bar x$ can be written as\n\\[\n\\label{eq:7.u325}\n\\operatorname{LHS}_{(4.30)}(C;\\bar x)=\\beta+\\sum_{a\\in C} d_a(\\bar x),\n\\]\nwith constant $\\beta$ and affine arc costs $d_a(\\bar x)$. Defining $\\operatorname{cost}(C)=\\sum_{a\\in C} d_a(\\bar x)$, the minimum left-hand side over all inequalities equals $\\beta+\\min_C \\operatorname{cost}(C)$. Therefore a violated inequality exists if and only if there is a cycle $C$ with $\\operatorname{cost}(C)<-\\beta$; in the common normalization $\\beta=0$ this is exactly the existence of a negative-cost directed cycle. Any such negative cycle immediately identifies a violated inequality. Hence the separation problem for \\((4.30)\\) reduces to detecting a negative-cost cycle in a graph with $O(n)$ nodes.\n\\end{proof}",
    "index": 107
  }
]